<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.2.1" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>xSPDE user's guide: v2.2</title>
<style type='text/css'>
/* LyX Provided Styles */
table { border: 1px solid black; display: inline-block; }
td { border: 1px solid black; padding: 0.5ex; }

/* Layout-provided Styles */
h1.title {
font-family: sans-serif;
font-weight: bold;
font-size: x-large;
margin-bottom: 1ex;
text-align: center;

}
div.author {
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.address {
margin-bottom: 1.5ex;
text-align: left;

}
div.standard {
text-indent: 2em;
margin-bottom: 2ex;
}
h1.chapter {
font-family: sans-serif;
font-weight: bold;
font-size: x-large;
margin-top: 4ex;
margin-bottom: 0.8ex;
text-align: left;

}
h2.section {
font-family: sans-serif;
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h3.subsection {
font-family: sans-serif;
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
div.plain_layout {
text-align: left;

}
h3.subsection_ {
font-family: sans-serif;
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
dl.description dt { font-weight: bold; }
div.bibliography {
margin-left: 2em;
text-indent: -2em;
}
span.bibitemlabel:before { content: "["; }
span.bibitemlabel:after { content: "] "; }
 div.toc {
   margin: 2em 0em;
   border-style: solid;
   border-width: 2px 0px;
   padding: 1em 0em;
 }
 h2.tochead { font-size: x-large; font-weight: bold; }
 div.lyxtoc-0 {
   margin: 2em 0em 0em 0em;
   font-size: xx-large;
   font-weight: bold;
 }
 div.lyxtoc-1 {
   margin: 1em 0em 0em 0em;
   font-size: x-large;
   font-weight: bold;
 }
 div.lyxtoc-2 {
   margin: 0em 0.1em 0em 1em;
   font-size: large;
   font-weight: normal;
 }
 div.lyxtoc-3 { margin: 0em 0.1em 0em 0.5em; font-size: medium; }
 div.lyxtoc-4 { margin: 0em 0.1em 0em 0.5em; }
 div.lyxtoc-5 { margin: 0em 0.1em 0em 0.5em; }
 div.lyxtoc-6 { margin: 0em 0.1em 0em 0.5em; }
 a.tocentry {
   text-decoration: none;
   color: black;
 }
 a.tocentry:visited { color: black; }
div.Doublebox {
border: double thick black;
padding: 0.5ex;
}
div.float {
border: 2px solid black;
text-align: center;
}
div.float-caption {
text-align: center;
border: 2px solid black;
padding: 1ex;
margin: 1ex;
}


</style>
</head>
<body>
<h1 class="title"><a id='magicparlabel-1' />xSPDE user's guide: v2.2</h1>
<div class="author"><a id='magicparlabel-2' />Peter D. Drummond, Rodney Polkinghorne, Simon Kiesewetter</div>
<div class="address"><a id='magicparlabel-3' /><b>Centre for Quantum and Optical Science, Swinburne University of Technology, Melbourne, Victoria, Australia.</b></div>

<div class='toc'><h2 class='tochead chapter'>Table of Contents</h2>

<div class='lyxtoc-1'><a href='#magicparlabel-5' class='tocentry'>1 Introduction</a>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-15' class='tocentry'>2 xSPDE simulations</a>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-479' class='tocentry'>3 xSPDE Projects </a>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-575' class='tocentry'>4 Stochastic PDEs</a>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-747' class='tocentry'>5 Logic and data</a>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-950' class='tocentry'>6 xSPDE metadata </a>
</div>
</div>

<h1 class="chapter"><a id='magicparlabel-5' /><span class="chapter_label">1</span> Introduction<a id="chap_Introduction" />
</h1>
<div class="standard"><a id='magicparlabel-6' />The xSPDE software toolbox is an e<b>x</b>tensible <b>S</b>tochastic <b>P</b>artial <b>D</b>ifferential <b>E</b>quation solver. It can solve any number of simultaneous equations in any number of space dimensions, with averaging and graphical output. This user's guide can be used as the basis for a 3-4 hour self-taught tutorial in solving practical stochastic problems. It includes exercises for the reader. A full-length manual is available online. Research use of this software is encouraged, and should be referenced to the corresponding paper[<a href='#LyXCite-Kiesewetter'><span class="bib-numericallabel">1</span></a>]. See:<em> </em><b>www.github.com/peterddrummond/xspde_matlab.</b></div>
<h2 class="section"><a id='magicparlabel-7' /><span class="section_label">1.1</span> Stochastic equations</h2>
<div class="standard"><a id='magicparlabel-8' />Stochastic equations are equations with random noise terms [<a href='#LyXCite-Gardiner'><span class="bib-numericallabel">2</span></a>, <a href='#LyXCite-Drummond'><span class="bib-numericallabel">3</span></a>]. They occur in in many fields of biology, chemistry, engineering, economics, physics, meteorology and other disciplines. An ordinary stochastic equation for a real or complex vector <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'><mi>a</mi>
  </mstyle>
 </mrow></math> is:</div>

<div class="standard"><a id='magicparlabel-9' /><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mrow>
       <mrow><mi> &part; </mi><mstyle mathvariant='bold'><mi>a</mi></mstyle>
       </mrow>
      </mrow>
      <mrow>
       <mrow><mi> &part; </mi><mi>t</mi>
       </mrow>
      </mrow>
     </mfrac><mo>=</mo>
     <mover>
      <mrow><mstyle mathvariant='bold'><mi>a</mi></mstyle>
      </mrow><mo stretchy="true">&dot;</mo>
     </mover><mo>=</mo>
     <mstyle mathvariant='bold'><mi>A</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mstyle mathvariant='bold'><mi>a</mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <munder>
      <mrow>
       <mstyle mathvariant='bold'><mi>B</mi>
       </mstyle>
      </mrow><mo stretchy="true">&macr;</mo>
     </munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mstyle mathvariant='bold'><mi>a</mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mstyle mathvariant='bold'><mi>w</mi></mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(1.1)
   </mtd>
  </mtr>
 </mtable></math>Here, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'><mi>A</mi>
  </mstyle>
 </mrow></math> is a vector, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <munder>
   <mrow>
    <mstyle mathvariant='bold'><mi>B</mi>
    </mstyle>
   </mrow><mo stretchy="true">&macr;</mo>
  </munder>
 </mrow></math> a matrix, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'><mi>w</mi>
  </mstyle>
 </mrow></math> is a real noise vector, delta-correlated in time: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

    <mrow>
     <msub>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msub>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>-</mo><mi>t</mi><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msub>
      <mrow><mi> &delta; </mi>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mi>j</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(1.2)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-10' />Stochastic partial differential equations including space dependence are also numerically soluble [<a href='#LyXCite-DrummondMortimer'><span class="bib-numericallabel">4</span></a>, <a href='#LyXCite-KP'><span class="bib-numericallabel">5</span></a>] with xSPDE. These are described in Chapter <a href="#chap_Stochastic_partial_differential">4</a>.</div>
<h2 class="section"><a id='magicparlabel-11' /><span class="section_label">1.2</span> xSPDE</h2>
<div class="standard"><a id='magicparlabel-12' />xSPDE is a Matlab based software toolbox. It has functions that can numerically solve both ordinary and partial differential stochastic equations, and graph results of correlations and averages. There are many equations of this type, and the xSPDE toolbox can treat a wide range. The extensible general structure permits drop-in replacements of the functions provided. Different simulations can be carried out sequentially, to simulate the various stages in an experiment or other process. It can even be used with no noise.</div>

<div class="standard"><a id='magicparlabel-13' />The code supports parallelism at both the vector instruction level and at the thread level, using Matlab matrix instructions and the parallel toolbox. It calculates averages of arbitrary functions of any number of complex or real fields, as well as Fourier transforms in time or space. It provides error estimates for both step-size and sampling error. </div>

<div class="standard"><a id='magicparlabel-14' /><em>xSPDE is distributed without any guarantee, under an open-source license. Contributions and bug reports always welcome.</em></div>
<h1 class="chapter"><a id='magicparlabel-15' /><span class="chapter_label">2</span> xSPDE simulations<a id="chap_Interactive_xSPDE" />
</h1>
<div class="standard"><a id='magicparlabel-16' />The general purpose xSPDE toolbox function co is:</div>

<ul class="itemize"><a id='magicparlabel-17' /><li class="itemize_item"><b>xspde(in)</b>, the combined simulation (xSIM) and graphics (xGRAPH) function.</li>
</ul>
<h2 class="section"><a id='magicparlabel-18' /><span class="section_label">2.1</span> Running xSPDE interactively</h2>
<div class="standard"><a id='magicparlabel-19' />To simulate a stochastic equation interactively, first make sure Matlab path is pointing to the xSPDE folder. If not, proceed as follows:</div>

<ul class="itemize"><a id='magicparlabel-20' /><li class="itemize_item">Click on the Matlab HOME tab (top left), then Set Path</li>
<li class="itemize_item">Click on Add with Subfolders</li>
<li class="itemize_item">Find the xSPDE folder in the drop-down menu, and select it</li>
<li class="itemize_item">Click on close to save the path.</li>
</ul>
<div class="standard"><a id='magicparlabel-24' />Next, type <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi>
  </mrow>
 </mrow></math> to clear old data, and enter the xSPDE inputs and functions into the command window. For the simplest of examples, do this by cutting and pasting from an electronic file of this manual. You can also use the Matlab built-in editor.</div>

<div class="standard"><a id='magicparlabel-25' />A typical script is as follows:</div>

<div class="standard"><a id='magicparlabel-26' /><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='monospace'>
      <mrow><mi>i</mi><mi>n</mi><mn>.</mn>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

    <mrow><mi>p</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mn>1</mn>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='monospace'>
      <mrow><mi>i</mi><mi>n</mi><mn>.</mn>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mn>2</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mi>&hellip;
    </mi>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mstyle mathvariant='monospace'>
     <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>d</mi><mi>a</mi>
     </mrow>
    </mstyle>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow>
     <mstyle mathvariant='monospace'>
      <mrow><mo>@</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>a</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>r</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mstyle><mspace width="6px" /><mspace width="6px" /><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>d</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mstyle mathvariant='monospace'>
     <mrow><mi>x</mi><mi>s</mi><mi>p</mi><mi>d</mi><mi>e</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>i</mi><mi>n</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mstyle>
   </mtd>
   <mtd><mrow/>
   </mtd>
   <mtd><mrow/>
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-27' />Note the following points to remember:</div>

<ul class="itemize"><a id='magicparlabel-28' /><li class="itemize_item">The notation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='monospace'>
    <mrow><mi>i</mi><mi>n</mi><mn>.</mn>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mi>p</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math> inputs a value to the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>i</mi><mi>n</mi><mn>.</mn>
   </mrow>
  </mstyle>
 </mrow></math> data structure </li>
<li class="itemize_item">There are many input possibilities, and they all have default values.</li>
<li class="itemize_item">You don't have to save the data if you just want an immediate plot </li>
<li class="itemize_item">The notation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='monospace'>
    <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>d</mi><mi>a</mi><mo>=</mo>
    </mrow>
   </mstyle>
   <mstyle mathvariant='monospace'>
    <mrow><mo>@</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>a</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>r</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mstyle><mspace width="6px" /><mspace width="6px" /><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mi>d</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>=</mo>
  </mrow>
 </mrow></math> defines an inline function, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi><mi>a</mi><mo>/</mo><mi>d</mi><mi>t</mi>
  </mrow>
 </mrow></math>. </li>
<li class="itemize_item">In xSPDE, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'><mi>a</mi>
  </mstyle>
 </mrow></math> is the stochastic variable, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'><mi>w</mi>
  </mstyle>
 </mrow></math> the random noise, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'><mi>r</mi>
  </mstyle>
 </mrow></math> the parameters. </li>
<li class="itemize_item">For example, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>r</mi><mn>.</mn><mi>t</mi>
   </mrow>
  </mstyle>
 </mrow></math> is the current time, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='monospace'>
    <mrow><mi>r</mi><mn>.</mn><mi>x</mi>
    </mrow>
   </mstyle><mo>,</mo>
  </mrow>
 </mrow></math> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='monospace'>
    <mrow><mi>r</mi><mn>.</mn><mi>y</mi>
    </mrow>
   </mstyle><mo>,</mo>
  </mrow>
 </mrow></math> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='monospace'>
    <mrow><mi>r</mi><mn>.</mn><mi>z</mi>
    </mrow>
   </mstyle><mo>,</mo>
  </mrow>
 </mrow></math> the grid of coordinates. </li>
</ul>
<h2 class="section"><a id='magicparlabel-34' /><span class="section_label">2.2</span> Inputs</h2>
<div class="standard"><a id='magicparlabel-35' />All xSPDE simulations use a structure <em>in</em> for input data. All functions use an internally generated structure <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>r</mi>
 </mrow></math>, combining <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi>
  </mrow>
 </mrow></math> with other generated parameters. Any name will do for either structure, as long as you are consistent. </div>

<div class="standard"><a id='magicparlabel-36' />All xSPDE inputs have default values, which can be changed by typing parameters into the <em>in</em> structure. If you only need the first value of a vector or array, just input the value that is required.</div>
<h3 class="subsection"><a id='magicparlabel-37' /><span class="subsection_label">2.2.1</span> Common xSPDE inputs</h3>
<div class="standard"><a id='magicparlabel-38' />The most common xSPDE parameters are: 
<br />


<br />

</div>



<div class="standard" style='text-align: center;'><a id='magicparlabel-39' /><table><tbody><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-114' />Label </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-117' />Type </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-120' />Default value </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-123' />Description</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-126' /><em>in.fields</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-129' />integer </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-132' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-135' />Stochastic field variables</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-138' /><em>in.noises</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-141' />integer </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-144' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-147' />Number of noises</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-150' /><em>in.dimension</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-153' />integer </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-156' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-159' />Space-time dimensions</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-162' /><em>in.name</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-165' />string </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-168' />' ' </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-171' />Simulation name</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-174' /><em>in.olabels</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-177' />string</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-180' /><em>'a'</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-183' />Observable labels</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-186' /><em>in.da</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-189' />function </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-192' /><em> 0</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-195' />The stochastic derivative</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-198' /><em>in.initial</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-201' />function </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-204' /> 0</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-207' />Function to initialize variables</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-210' /><em>in.ensembles</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-213' />integer vector</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-216' />[1,1,1]</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-219' />Hierarchy of stochastic trajectories</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-222' /><em>in.observe</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-225' />function</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-228' /><em>a</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-231' />Observable function </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-234' /><em>in.linear</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-237' />function</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-240' />0</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-243' />Linear interaction picture response</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-246' /><em>in.ranges</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-249' />real vector</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-252' />10 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-255' />Ranges in time and space</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-258' /><em>in.steps</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-261' />integer vector</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-264' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-267' />Time-steps per plot point</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-270' /><em>in.points</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-273' />integer vector</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-276' />51 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-279' />Output lattice points in [t,x,y,z]</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-282' /><em>in.images</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-285' />integer cell array</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-288' /><em>{0,..}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-291' />Movie images in time per observable</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-294' /><em>in.transforms</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-297' />vector cells </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-300' /><em> {[0 0 0 0],..}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-303' />Output Fourier transforms in [t,x,y,z]</div>
</td>
</tr></tbody>
</table>

<br />

</div>

<div class="standard"><a id='magicparlabel-304' /><b>A complete list of user inputs is given in Chapter (<a href="#chap_Table_of_xSPDE">6</a>).</b></div>
<h3 class="subsection"><a id='magicparlabel-305' /><span class="subsection_label">2.2.2</span> Use the dot</h3>
<div class="standard"><a id='magicparlabel-306' />Matlab formulae often require a 'dot' or a 'colon'. To multiply vectors element-wise, like <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>a</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>=</mo>
   <msub>
    <mrow><mi>b</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>c</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, the notation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo>=</mo><mi>b</mi><mn>.</mn><mo>*</mo><mi>c</mi>
  </mrow>
 </mrow></math> indicates all elements are multiplied. This is used in xspde to speed up calculations in parallel. </div>

<div class="standard"><a id='magicparlabel-307' />A formula for a stochastic field usually requires you to address the first index - which is the field component - and treat all the other elements in parallel. To do this, use the notation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1</mn><mo>,</mo><mo>:</mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </div>

<div class="standard"><a id='magicparlabel-308' />Whenever a formula combines operations over spatial lattices or ensembles, remember to <b>USE THE DOT</b>.</div>
<h2 class="section"><a id='magicparlabel-309' /><span class="section_label">2.3</span> The random walk</h2>
<div class="standard"><a id='magicparlabel-310' />The first example is the simplest possible stochastic equation: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>a</mi>
      </mrow><mo stretchy="true">&dot;</mo>
     </mover><mo>=</mo><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(2.1)
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_"><a id='magicparlabel-311' />Exercises</h3>
<div class="standard"><a id='magicparlabel-312' />Remember that, unless you type <em>clear</em> first, any changes to the input structure are additive; so you will get the sum of all the previous inputs as well as your new input.</div>

<ul class="itemize"><a id='magicparlabel-313' /><li class="itemize_item"><b>Run the complete xSPDE script given below in Matlab. </b></li>
</ul>
<div class="standard"><a id='magicparlabel-314' />It is simplest to cut and paste from an electronic file into the Matlab command window. Be careful; pasting can cause subtle changes that may require correction. </div>

<div class="standard"><a id='magicparlabel-315' />You should get the output in Fig (<a href="#fig_The_simplest_case__Wiener">2.1</a>).
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-316' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-320' /><span style='font-family:monospace;'>in.da=@(a,w,r) w; xspde(in);</span></div>
</div> </div>

<div class="standard"><a id='magicparlabel-321' />Here <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>d</mi><mi>a</mi>
  </mrow>
 </mrow></math> defines the derivative function, with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> the noise. </div>


<div class='float float-figure'><div class="plain_layout"><a id='magicparlabel-326' /><img style='width:75%;' src='0_Users_pddrummond_Dropbox_2016_Computers_xspde_matlab2_2_users_guide_Figures_Wiener_1.png' alt='image: 0_Users_pddrummond_Dropbox_2016_Computers_xspde_matlab2_2_users_guide_Figures_Wiener_1.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Figure 2.1:  <a id="fig_The_simplest_case__Wiener" />
The simplest case: a random walk.</span></div>
</div>


<ul class="itemize"><a id='magicparlabel-339' /><li class="itemize_item"><b>What do you see if you average over <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>10000</mn>
 </mrow></math> trajectories ?</b></li>
</ul>
<div class="standard" style='text-align: center;'><a id='magicparlabel-340' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-344' /><span style='font-family:monospace;'>in.ensembles = 10000;</span></div>

<div class="plain_layout"><a id='magicparlabel-345' /><span style='font-family:monospace;'>xspde(in);</span></div>
</div></div>

<ul class="itemize"><a id='magicparlabel-346' /><li class="itemize_item"><b>What do you see if you plot the mean square distance? Note that variances should increase linearly with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math>.</b></li>
</ul>
<div class="standard" style='text-align: center;'><a id='magicparlabel-347' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-351' /><span style='font-family:monospace;'>in.observe = @(a,r) a.^2;</span></div>

<div class="plain_layout"><a id='magicparlabel-352' /><span style='font-family:monospace;'>in.olabels = '&lt;a^2&gt;';</span></div>

<div class="plain_layout"><a id='magicparlabel-353' /><span style='font-family:monospace;'>xspde(in);</span></div>
</div></div>

<ul class="itemize"><a id='magicparlabel-354' /><li class="itemize_item"><b>What if you add a force that takes the particle back to the origin?</b> <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>a</mi>
      </mrow><mo stretchy="true">&dot;</mo>
     </mover><mo>=</mo><mo>-</mo><mi>a</mi><mo>+</mo><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(2.2)
   </mtd>
  </mtr>
 </mtable></math></li>
</ul>
<div class="standard" style='text-align: center;'><a id='magicparlabel-355' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-359' /><span style='font-family:monospace;'>in.da=@(a,w,r) -a+w</span></div>

<div class="plain_layout"><a id='magicparlabel-360' /><span style='font-family:monospace;'>xspde(in);</span></div>
</div></div>
<h3 class="subsection_"><a id='magicparlabel-361' />Mathematical exercise: </h3>

<ul class="itemize"><a id='magicparlabel-362' /><li class="itemize_item">If you like mathematics; as an offline exercise, try to solve the equivalent diffusion equation for the probability P to find the variance <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

  <msup>
   <mrow><mi>a</mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

 </mrow></math>! The equation is:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow>
     <mrow><mi> &part; </mi><mi>P</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
    <mrow>
     <mrow><mi> &part; </mi><mi>t</mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow>
    <mfrac>
     <mrow><mi> &part; </mi>
     </mrow>
     <mrow>
      <mrow><mi> &part; </mi><mi>a</mi>
      </mrow>
     </mrow>
    </mfrac><mo>+</mo>
    <mfrac>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </mfrac>
    <mfrac>
     <mrow>
      <msup>
       <mrow><mi> &part; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mrow>
      <mrow><mi> &part; </mi>
       <msup>
        <mrow><mi>a</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mi>P</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></li>
</ul>
<h2 class="section"><a id='magicparlabel-363' /><span class="section_label">2.4</span> Laser quantum noise</h2>
<div class="standard"><a id='magicparlabel-364' />Next we treat a model for the quantum noise of a single mode laser as it turns on, near threshold:</div>

<div class="standard"><a id='magicparlabel-365' /><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>a</mi>
      </mrow><mo stretchy="true">&dot;</mo>
     </mover><mo>=</mo><mi>g</mi><mi>a</mi><mo>+</mo><mi>b</mi><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.3)
   </mtd>
  </mtr>
 </mtable></math>where the noise is complex, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>+</mo><mi>i</mi>
    <msub>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, so that: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

     <mrow><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>t</mi><mo>'</mo>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>
<mo>=</mo><mn>2</mn><mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>-</mo><mi>t</mi><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(2.4)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-366' />Here the coefficient <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>b</mi>
 </mrow></math> describes the quantum noise of the laser, and is inversely proportional to the equilibrium photon number. </div>
<h3 class="subsection_"><a id='magicparlabel-367' />Exercises</h3>
<div class="standard"><a id='magicparlabel-368' />You should type <em>clear </em>first when starting new simulations.</div>

<ul class="itemize"><a id='magicparlabel-369' /><li class="itemize_item"><b>Solve for the case of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>g</mi><mo>=</mo><mn>0.1</mn>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>b</mi><mo>=</mo><mn>0.01</mn>
  </mrow>
 </mrow></math></b></li>
</ul>
<div class="standard"><a id='magicparlabel-370' />Most lasers have more than <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>100</mn>
 </mrow></math> photons, and hence less noise!
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-371' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-375' /><span style='font-family:monospace;'>clear</span></div>

<div class="plain_layout"><a id='magicparlabel-376' /><span style='font-family:monospace;'>in.noises=2;</span></div>

<div class="plain_layout"><a id='magicparlabel-377' /><span style='font-family:monospace;'>in.observe = @(a,r) abs(a)^2;</span></div>

<div class="plain_layout"><a id='magicparlabel-378' /><span style='font-family:monospace;'>in.olabels = '|a|^2';</span></div>

<div class="plain_layout"><a id='magicparlabel-379' /><span style='font-family:monospace;'>in.da=@(a,w,r) a+0.01*(w(1)+i*w(2));</span></div>

<div class="plain_layout"><a id='magicparlabel-380' /><span style='font-family:monospace;'>xspde(in);</span></div>
</div></div>

<div class="standard"><a id='magicparlabel-381' />Consider the case where the laser saturates to a steady state:</div>

<div class="standard"><a id='magicparlabel-382' /><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>a</mi>
      </mrow><mo stretchy="true">&dot;</mo>
     </mover><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>1</mn><mo>-</mo>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>a</mi><mo>+</mo><mi>b</mi><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.5)
   </mtd>
  </mtr>
 </mtable></math></div>

<ul class="itemize"><a id='magicparlabel-383' /><li class="itemize_item"><b>Solve for the saturated laser case</b></li>
</ul>
<div class="standard"><a id='magicparlabel-384' />You should get the output graph in Fig (<a href="#fig_The_laser">2.2</a>). 
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-385' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-389' /><span style='font-family:monospace;'>in.da=@(a,w,r) (1-abs(a)^2)*a+0.01*(w(1)+i*w(2));</span></div>

<div class="plain_layout"><a id='magicparlabel-390' /><span style='font-family:monospace;'>xspde(in);</span></div>
</div> </div>


<div class='float float-figure'><div class="plain_layout"><a id='magicparlabel-395' /><img style='width:75%;' src='1_Users_pddrummond_Dropbox_2016_Computers_xspde_matlab2_2_users_guide_Figures_Laser.png' alt='image: 1_Users_pddrummond_Dropbox_2016_Computers_xspde_matlab2_2_users_guide_Figures_Laser.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Figure 2.2:  <a id="fig_The_laser" />
Simulation of the stochastic equation describing a laser turning on.</span></div>
</div>

<h2 class="section"><a id='magicparlabel-408' /><span class="section_label">2.5</span> Spectra</h2>
<div class="standard"><a id='magicparlabel-409' />Frequency spectra have many uses, especially for understanding the steady-state fluctuations of any physical system. The xSPDE spectral definition is:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>a</mi>
    </mrow><mo stretchy="true">&tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &omega; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow>
     <msqrt>
      <mrow><mn>2</mn><mi> &pi; </mi>
      </mrow>
     </msqrt>
    </mrow>
   </mfrac>
   <mrow><mo> &int; </mo>
   </mrow>
   <mrow>
    <msup>
     <mrow><mi>e</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mi>i</mi><mi> &omega; </mi><mi>t</mi>
      </mrow>
     </mrow>
    </msup><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow><mo> &InvisibleTimes; </mo>
   <mrow><mo> &DifferentialD; </mo><mi>t</mi>
   </mrow><mspace width="6px" />
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-410' />To get an output from a temporally Fourier transformed field, just set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>s</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>, for the particular observable you need to calculate in transform space. This parameter is a cell array, and can have a different value for every observable and indeed, every dimension in space-time.</div>

<div class="standard"><a id='magicparlabel-411' />Take the random walk equation in a complex space, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow>
     <mrow><mi>d</mi><mi>a</mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi>d</mi><mi>t</mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo><mo>-</mo><mi>a</mi><mo>+</mo><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi>i</mi>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Use an initial condition of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>+</mo><mi>i</mi>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>/</mo>
   <msqrt><mn>2</mn>
   </msqrt>
  </mrow>
 </mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

   <msubsup>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>
<mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>, to start near the steady state. </div>

<div class="standard"><a id='magicparlabel-412' />For sufficiently long time-intervals, the solution in frequency space - where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &omega; </mi><mo>=</mo><mn>2</mn><mi> &pi; </mi><mi>f</mi>
  </mrow>
 </mrow></math> is the angular frequency - is given by: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>a</mi>
    </mrow><mo stretchy="true">&tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &omega; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mover>
       <mrow><mi> &zeta; </mi>
       </mrow><mo stretchy="true">&tilde;</mo>
      </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &omega; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>+</mo><mi>i</mi><mi> &omega; </mi>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math>The expectation value of the noise spectrum, in the large <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>T</mi>
 </mrow></math> limit, is therefore: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

      <mrow>
       <mover>
        <mrow><mi>a</mi>
        </mrow><mo stretchy="true">&tilde;</mo>
       </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &omega; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <mrow><mn>2</mn><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mn>1</mn><mo>+</mo>
         <msup>
          <mrow><mi> &omega; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac>
     <mrow><mo> &int; </mo>
     </mrow>
     <mrow><mo> &int; </mo>
     </mrow>
     <mrow>
      <msup>
       <mrow><mi>e</mi>
       </mrow>
       <mrow>
        <mrow><mo>-</mo><mi>i</mi><mi> &omega; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mi>t</mi><mo>-</mo><mi>t</mi><mo>'</mo>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mrow>
      </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

      <mrow><mi> &zeta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       <msup>
        <mrow><mi> &zeta; </mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>'</mo>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

     </mrow><mo> &InvisibleTimes; </mo>
     <mrow><mo> &DifferentialD; </mo><mi>t</mi>
     </mrow><mo> &InvisibleTimes; </mo>
     <mrow><mo> &DifferentialD; </mo><mi>t</mi>
     </mrow><mo>'</mo><mspace width="6px" /><mn>.</mn>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mfrac>
     <mrow><mi>T</mi>
     </mrow>
     <mrow>
      <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mn>1</mn><mo>+</mo>
        <msup>
         <mrow><mi> &omega; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </mfrac>
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_"><a id='magicparlabel-413' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-414' /><li class="itemize_item"><b>Plot the spectrum over a range of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>100</mn>
  </mrow>
 </mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>640</mn>
 </mrow></math> points and a random initial equation near the equilibrium value.</b></li>
</ul>
<div class="standard"><a id='magicparlabel-415' />The input parameters are given below. There are parallel operations here, for ensemble averaging, so <b>USE THE DOT</b>.
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-416' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-420' /><span style='font-family:monospace;'>clear</span></div>

<div class="plain_layout"><a id='magicparlabel-421' /><span style='font-family:monospace;'>in.points = 640;</span></div>

<div class="plain_layout"><a id='magicparlabel-422' /><span style='font-family:monospace;'>in.ranges = 100;</span></div>

<div class="plain_layout"><a id='magicparlabel-423' /><span style='font-family:monospace;'>in.noises = 2; </span></div>

<div class="plain_layout"><a id='magicparlabel-424' /><span style='font-family:monospace;'>in.ensembles = 10000; </span></div>

<div class="plain_layout"><a id='magicparlabel-425' /><span style='font-family:monospace;'>in.initial = @(v,r) (v(1,:)+1i*v(2,:))/sqrt(2); </span></div>

<div class="plain_layout"><a id='magicparlabel-426' /><span style='font-family:monospace;'>in.da = @(a,w,r) -a + w(1,:)+1i*w(2,:); </span></div>

<div class="plain_layout"><a id='magicparlabel-427' /><span style='font-family:monospace;'>in.observe =@(a,r) a.*conj(a);</span></div>

<div class="plain_layout"><a id='magicparlabel-428' /><span style='font-family:monospace;'>in.transforms =1;</span></div>

<div class="plain_layout"><a id='magicparlabel-429' /><span style='font-family:monospace;'>in.olabels = '|a(\omega)|^2'; </span></div>

<div class="plain_layout"><a id='magicparlabel-430' /><span style='font-family:monospace;'>xspde(in); </span></div>
</div> </div>

<div class="standard"><a id='magicparlabel-431' />Note that <span style='font-family:monospace;'>in.transforms =1</span> tells xSPDE to Fourier transform the field over the time coordinate before averaging, to give a spectrum. The first argument <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>v</mi>
 </mrow></math> of the <em>initial</em> function is a random field, used optionally to initialize the stochastic variable. You can transform any field in any dimension, with any number of resulting averages. See Chapter 6 for details. </div>

<div class="standard"><a id='magicparlabel-432' />To define as many observables as you like, use a Matlab cell array; 
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-433' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-437' /><span style='font-family:monospace;'>in.observe{1} = ..;</span></div>

<div class="plain_layout"><a id='magicparlabel-438' /><span style='font-family:monospace;'>in.observe{2} = ..;</span></div>
</div></div>

<ul class="itemize"><a id='magicparlabel-439' /><li class="itemize_item"><b>Simulate over a range of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>200</mn>
  </mrow>
 </mrow></math>. What changes do you see? Why?</b></li>
<li class="itemize_item"><b>Change the equation to the laser noise equations. Why is the spectrum much narrower?</b></li>
</ul>
<h2 class="section"><a id='magicparlabel-441' /><span class="section_label">2.6</span> Ito and Stratonovich</h2>
<div class="standard"><a id='magicparlabel-442' />The xSPDE toolbox is mainly designed to treat Stratonovich equations [<a href='#LyXCite-Gardiner'><span class="bib-numericallabel">2</span></a>], which are the broad-band limit of a finite band-width random noise equation. Another type of of stochastic equation is the Ito form, which is a limit where derivatives are evaluated at the start of each step. If you have an Ito equation, you can either use the Euler integration option, and set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mo>=</mo><mi>x</mi><mi>E</mi><mi>u</mi><mi>l</mi><mi>e</mi><mi>r</mi>
  </mrow>
 </mrow></math>, or else apply the Stratonovich correction to the drift, as outlined below. </div>

<div class="standard"><a id='magicparlabel-443' />To emphasize the difference, an Ito equation is often written as a difference equation:</div>

<div class="standard"><a id='magicparlabel-444' /><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>d</mi>
     <mstyle mathvariant='bold'><mi>a</mi>
     </mstyle><mo>=</mo>
     <msup>
      <mrow>
       <mstyle mathvariant='bold'><mi>A</mi>
       </mstyle>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mstyle mathvariant='bold'><mi>a</mi>
     </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>+</mo>
     <munder>
      <mrow>
       <mstyle mathvariant='bold'><mi>B</mi>
       </mstyle>
      </mrow><mo stretchy="true">&macr;</mo>
     </munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mstyle mathvariant='bold'><mi>a</mi>
     </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo> &sdot; </mo><mi>d</mi><mstyle mathvariant='bold'><mi>w</mi></mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(2.6)
   </mtd>
  </mtr>
 </mtable></math>Here <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

   <mrow><mi>d</mi>
    <msub>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mstyle mathvariant='bold'><mi>x</mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>d</mi>
    <msub>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mstyle mathvariant='bold'><mi>x</mi></mstyle><mo>'</mo>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>
<mo>=</mo>
   <msub>
    <mrow><mi> &delta; </mi>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mi>j</mi>
     </mrow>
    </mrow>
   </msub><mi>d</mi><mi>t</mi>
  </mrow>
 </mrow></math>. </div>

<div class="standard"><a id='magicparlabel-445' />When <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mstyle mathvariant='bold'>
  <mstyle mathvariant='sans-serif'><mi>B</mi>
  </mstyle></mstyle>
 </mrow></math> is constant, the two methods are identical. If <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mstyle mathvariant='bold'>
  <mstyle mathvariant='sans-serif'><mi>B</mi>
  </mstyle></mstyle>
 </mrow></math> is not constant, the Ito drift term <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow>
    <mstyle mathvariant='bold'><mi>A</mi>
    </mstyle>
   </mrow>
   <mrow><mi>I</mi>
   </mrow>
  </msup>
 </mrow></math> is different to the corresponding Stratonovich one. The relationship is: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msub>
     <mrow><mi>A</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mi>A</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msubsup><mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac>
     <munder>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>j</mi><mo>,</mo><mi>m</mi>
       </mrow>
      </mrow>
     </munder>
     <mfrac>
      <mrow>
       <mrow><mi> &part; </mi>
        <msub>
         <mrow><mi>B</mi>
         </mrow>
         <mrow>
          <mrow><mi>i</mi><mi>j</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mrow>
       <mrow><mi> &part; </mi>
        <msub>
         <mrow><mi>a</mi>
         </mrow>
         <mrow><mi>m</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </mfrac>
     <msub>
      <mrow><mi>B</mi>
      </mrow>
      <mrow>
       <mrow><mi>m</mi><mi>j</mi>
       </mrow>
      </mrow>
     </msub><mspace width="6px" /><mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(2.7)
   </mtd>
  </mtr>
 </mtable></math></div>
<h2 class="section"><a id='magicparlabel-446' /><span class="section_label">2.7</span> Financial calculus</h2>
<div class="standard"><a id='magicparlabel-447' />A well-known Ito stochastic equation is the Black-Scholes equation, used to price financial options. It describes the fluctuations in a stock value: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>d</mi><mi>a</mi><mo>=</mo><mi> &mu; </mi><mi>a</mi><mspace width="6px" /><mi>d</mi><mi>t</mi><mo>+</mo><mi>a</mi><mi> &sigma; </mi><mspace width="6px" /><mi>d</mi><mi>w</mi><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(2.8)
   </mtd>
  </mtr>
 </mtable></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

   <mrow><mi>d</mi>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>
<mo>=</mo><mi>d</mi><mi>t</mi>
  </mrow>
 </mrow></math>. Since the noise is multiplicative, the equation is different in Ito and Stratonovich forms of stochastic calculus. </div>

<div class="standard"><a id='magicparlabel-448' />The corresponding Stratonovich equation, as used in xSPDE for the standard default integration routine is: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>a</mi>
      </mrow><mo stretchy="true">&dot;</mo>
     </mover><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &mu; </mi><mo>-</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo>/</mo><mn>2</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>a</mi><mo>+</mo><mi>a</mi><mi> &sigma; </mi><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(2.9)
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_"><a id='magicparlabel-449' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-450' /><li class="itemize_item"><b>Solve for a startup with a volatile stock having <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &mu; </mi><mo>=</mo><mn>0.1</mn><mo>,</mo><mspace width="6px" /><mi> &sigma; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>.</b></li>
</ul>
<div class="standard"><a id='magicparlabel-451' />An interactive xSPDE script in Matlab is given below with an output graph in Fig (<a href="#fig_The_Black_Scholes">2.3</a>), Note the spiky behaviour, typical of multiplicative noise, and also of the risky stocks in the small capitalization portions of the stock market.
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-452' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-456' /><span style='font-family:monospace;'>clear</span></div>

<div class="plain_layout"><a id='magicparlabel-457' /><span style='font-family:monospace;'>in.initial=@(v,r) 1</span></div>

<div class="plain_layout"><a id='magicparlabel-458' /><span style='font-family:monospace;'>in.da=@(a,w,r) -0.4*a+a*w</span></div>

<div class="plain_layout"><a id='magicparlabel-459' /><span style='font-family:monospace;'>xspde(in)</span></div>
</div> </div>


<div class='float float-figure'><div class="plain_layout"><a id='magicparlabel-464' /><img style='width:75%;' src='2_Users_pddrummond_Dropbox_2016_Computers_xspde_matlab2_2_users_guide_Figures_Black-Scholes.png' alt='image: 2_Users_pddrummond_Dropbox_2016_Computers_xspde_matlab2_2_users_guide_Figures_Black-Scholes.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Figure 2.3:  <a id="fig_The_Black_Scholes" />
Simulation of the Black-Scholes equation describing stock prices.</span></div>
</div>


<div class="standard"><a id='magicparlabel-477' />Note that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>i</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>a</mi><mi>l</mi>
  </mrow>
 </mrow></math> describes the initialization function. The first argument of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>@</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>v</mi><mo>,</mo><mi>r</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>v</mi>
 </mrow></math>, an initial random variable with unit variance. The error-bars are estimates of step-size error. Errors can be reduced by using more time-steps.</div>

<ul class="itemize"><a id='magicparlabel-478' /><li class="itemize_item"><b>Solve for a more mature stock having <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &mu; </mi><mo>=</mo><mn>0.1</mn><mo>,</mo><mspace width="6px" /><mi> &sigma; </mi><mo>=</mo><mn>0.1</mn>
  </mrow>
 </mrow></math>.</b></li>
</ul>
<h1 class="chapter"><a id='magicparlabel-479' /><span class="chapter_label">3</span> xSPDE Projects <a id="chap_Projects_xSPDE" />
</h1>
<div class="standard"><a id='magicparlabel-480' />Projects are larger scale investigations, where files are used to record inputs and data. This requires a new input parameter:
<br />

</div>



<div class="standard" style='text-align: center;'><a id='magicparlabel-481' /><table><tbody><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-500' />Label </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-503' />Type </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-506' />Default value </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-509' />Description</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-512' /><em>in.file</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-515' />string </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-518' /><em>''</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-521' />Matlab or HDF5 data file</div>
</td>
</tr></tbody>
</table>
</div>
<h2 class="section"><a id='magicparlabel-522' /><span class="section_label">3.1</span> Ensembles and sampling errors</h2>
<div class="standard"><a id='magicparlabel-523' />Averages over stochastic ensembles are the specialty of xSPDE, which requires specification of the ensemble size. A sophisticated hierarchy of ensemble specifications in three levels is possible, to allow maximum resource utilization, so that:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>3</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mspace width="6px" /><mn>.</mn>
  </mrow>
 </mrow></math>The local ensemble, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, gives within-thread parallelism, allowing vector instruction use for single-core efficiency. The serial ensemble, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, gives a number of independent trajectories calculated serially. </div>

<div class="standard"><a id='magicparlabel-524' />The parallel ensemble, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>3</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, gives multi-core parallelism, and requires the Matlab parallel toolbox. This improves speed when there are multiple cores. One should optimally put <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>3</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> equal to the available number of CPU cores.</div>

<div class="standard"><a id='magicparlabel-525' />The <em>total </em>number of stochastic trajectories or samples is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &times; </mo><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &times; </mo><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>3</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mn>.</mn>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-526' />Either <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> or <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>3</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> are required if sampling error-bars are to be calculated, owing to the sub-ensemble averaging method used in xSPDE to calculate sampling errors accurately. </div>
<h2 class="section"><a id='magicparlabel-527' /><span class="section_label">3.2</span> xSIM and xGRAPH</h2>
<div class="standard"><a id='magicparlabel-528' />An XPDE session can either run simulations interactively, described in Chapter <a href="#chap_Interactive_xSPDE">2</a>, or else using a function file called a project file. This allows xSPDE to run in a batch mode, as needed for longer projects which involve large ensembles. In either case, the Matlab path must include the xSPDE folder. For generating graphs automatically, the script input or project function should end with the combined function <b>xspde(in)</b>. </div>

<div class="standard"><a id='magicparlabel-529' />With batch jobs it is often useful to divide xSPDE into its simulation function, xSIM, and its graphics function, xGRAPH, to allow graphs to be made at a later time from the simulation. In this case the function<b> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mi>s</mi><mi>i</mi><mi>m</mi>
  </mrow>
 </mrow></math></b> runs the simulation, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>p</mi><mi>h</mi>
  </mrow>
 </mrow></math> makes the graphs. The two-stage option is better for running batch jobs, which you can graph at a later time.</div>

<div class="standard"><a id='magicparlabel-530' />To create a data file, you must enter the filename when running the simulation, using the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi><mo>=</mo><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi>
  </mrow>
 </mrow></math> input. A typical xSPDE project function of this type is as follows:</div>

<div class="standard"><a id='magicparlabel-531' /><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='monospace'>
      <mrow><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi>
      </mrow>
     </mstyle><mspace width="6px" /><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>e</mi><mo>,</mo><mi>e</mi><mi>c</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mn>.</mn><mi>m</mi>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='monospace'>
      <mrow><mi>i</mi><mi>n</mi><mn>.</mn>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

    <mrow><mi>p</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mn>1</mn>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='monospace'>
      <mrow><mi>i</mi><mi>n</mi><mn>.</mn>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mn>2</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mi>&hellip;
    </mi>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mstyle mathvariant='monospace'>
     <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi>
     </mrow>
    </mstyle>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>m</mi><mi>y</mi><mspace width="6px" /><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mn>.</mn>
     <mstyle mathvariant='monospace'>
      <mrow><mi>m</mi><mi>a</mi><mi>t</mi>
      </mrow>
     </mstyle>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mstyle mathvariant='monospace'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>e</mi><mo>,</mo><mi>i</mi><mi>n</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mstyle>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mstyle mathvariant='monospace'>
     <mrow><mi>x</mi><mi>s</mi><mi>i</mi><mi>m</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>i</mi><mi>n</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mstyle>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mstyle mathvariant='monospace'>
     <mrow><mi>e</mi><mi>c</mi>
     </mrow>
    </mstyle>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mstyle mathvariant='monospace'>
     <mrow><mi>x</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>p</mi><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mstyle>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mstyle mathvariant='monospace'>
     <mrow><mi>e</mi><mi>n</mi><mi>d</mi>
     </mrow>
    </mstyle>
   </mtd>
   <mtd><mrow/>
   </mtd>
   <mtd><mrow/>
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-532' />After preparing a project file using the editor, click on the Run arrow above the editor window. </div>

<div class="standard"><a id='magicparlabel-533' />In summary, a simple batch job workflow is as follows:</div>

<ul class="itemize"><a id='magicparlabel-534' /><li class="itemize_item">Create the metadata <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi>
  </mrow>
 </mrow></math>, and include a file name</li>
<li class="itemize_item">Change the Matlab directory path to home using <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mi>d</mi><mspace width="6px" /><mo> &sim; </mo>
  </mrow>
 </mrow></math>.</li>
<li class="itemize_item">Run the simulation with<b> [e,in]=xsim(in)</b>.</li>
<li class="itemize_item">Note that xSIM changes the file-name if it already exists, and returns the new name for plotting.</li>
<li class="itemize_item">Run <b>xgraph(in.file)</b>, and the data will be accessed and graphed. </li>
<li class="itemize_item">You can use either Matlab (.mat) or standard HDF5 (.h5) file-types.</li>
</ul>
<h2 class="section"><a id='magicparlabel-540' /><span class="section_label">3.3</span> Kubo project</h2>
<div class="standard"><a id='magicparlabel-541' />To get started on more complex programs, we next simulate the Kubo oscillator, which is an oscillator with a random frequency: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>a</mi>
      </mrow><mo stretchy="true">&dot;</mo>
     </mover><mo>=</mo><mi>i</mi><mi>a</mi><mi>w</mi>
    </mrow>
   </mtd>
   <mtd>(3.1)
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_"><a id='magicparlabel-542' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-543' /><li class="itemize_item"><b>Simulate the Kubo oscillator using a file, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>K</mi><mi>u</mi><mi>b</mi><mi>o</mi><mn>.</mn><mi>m</mi>
  </mrow>
 </mrow></math>, with two ensembles to allow sampling error estimates. The error vector <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi>
  </mrow>
 </mrow></math> gives the time-step error plus the sampling error.</b></li>
</ul>
<div class="standard" style='text-align: center;'><a id='magicparlabel-544' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-548' /><span style='font-family:monospace;'>function [error] = Kubo() </span></div>

<div class="plain_layout"><a id='magicparlabel-549' /><span style='font-family:monospace;'>in.name = 'Kubo oscillator';</span></div>

<div class="plain_layout"><a id='magicparlabel-550' /><span style='font-family:monospace;'>in.ensembles = [400,16]; </span></div>

<div class="plain_layout"><a id='magicparlabel-551' /><span style='font-family:monospace;'>in.initial = @(v,r) 1+0*v;</span></div>

<div class="plain_layout"><a id='magicparlabel-552' /><span style='font-family:monospace;'>in.da = @(a,w,r) i*a.*w;</span></div>

<div class="plain_layout"><a id='magicparlabel-553' /><span style='font-family:monospace;'>in.olabels = '&lt;a_1&gt;';</span></div>

<div class="plain_layout"><a id='magicparlabel-554' /><span style='font-family:monospace;'>in.file = 'kubo.mat';</span></div>

<div class="plain_layout"><a id='magicparlabel-555' /><span style='font-family:monospace;'>[error,in]=xsim(in); </span></div>

<div class="plain_layout"><a id='magicparlabel-556' /><span style='font-family:monospace;'>xgraph(in.file);</span></div>

<div class="plain_layout"><a id='magicparlabel-557' /><span style='font-family:monospace;'>end</span></div>
</div></div>

<div class="standard"><a id='magicparlabel-558' />The initial value of 1 is modified by adding <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>0</mn><mo>*</mo><mi>v</mi>
  </mrow>
 </mrow></math>. This is necessary, so that it returns an array whose first dimension equals the ensemble size. </div>

<div class="standard"><a id='magicparlabel-559' />This function is designed to generate a data file, <span style='font-family:monospace;'>kubo.mat</span>. If you run this more than once without deleting the earlier file, you will get a warning and a new file-name, <span style='font-family:monospace;'>kubo1.mat</span>, which is stored in the in structure. Under these circumstance, xgraph will graph the data in the most recent file saved, with the new file-name. This occurs because xSPDE will <b>not</b> overwrite old files, to protect your previous data. </div>

<div class="standard"><a id='magicparlabel-560' />You can also include modified graphics parameters as a second input when running <span style='font-family:monospace;'>xgraph, </span>just in case the first graphs you generate need changes.</div>
<h2 class="section"><a id='magicparlabel-561' /><span class="section_label">3.4</span> Challenge problem #1</h2>
<div class="standard"><a id='magicparlabel-562' />This is a much harder example, involving a full nonlinear quantum phase-space simulation. The method can also be used to investigate quantum non-equilibrium phase transitions, tunneling in open systems, quantum entanglement, Einstein-Podolsky-Rosen paradoxes, Bell violations, and many other problems treated in the literature[<a href='#LyXCite-Gardiner'><span class="bib-numericallabel">2</span></a>, <a href='#LyXCite-Drummond'><span class="bib-numericallabel">3</span></a>].</div>

<div class="standard"><a id='magicparlabel-563' />The following new ideas are introduced: </div>

<ol class="enumerate"><a id='magicparlabel-564' /><li class="enumerate_item"><b><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>r</mi><mi>a</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi>
   </mrow>
  </mstyle>
 </mrow></math> is the space-time integration range.</b> </li>
<li class="enumerate_item"><b><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi>
   </mrow>
  </mstyle>
 </mrow></math> gives integration steps per plot-point, for accuracy.</b> </li>
</ol>
<div class="standard"><a id='magicparlabel-566' />A simple case is the nonlinear driven quantum oscillator - for example, an optomechanical, atomic or nonlinear optical medium in a driven cavity. </div>

<div class="standard"><a id='magicparlabel-567' />The phase-space Fokker-Planck equation is equivalent to an SDE with the following form <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mfrac>
     <mrow>
      <mrow><mi>d</mi><mi> &alpha; </mi>
      </mrow>
     </mrow>
     <mrow>
      <mrow><mi>d</mi><mi>t</mi>
      </mrow>
     </mrow>
    </mfrac>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mo>-</mo>
     <mover>
      <mrow><mi> &gamma; </mi>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover><mi> &alpha; </mi><mo>-</mo><mi>i</mi><mi> &kappa; </mi>
     <msup>
      <mrow><mi> &alpha; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup><mi> &beta; </mi><mo>+</mo>
     <mstyle mathvariant='script'><mi>E</mi>
     </mstyle><mo>+</mo><mi>i</mi>
     <msqrt>
      <mrow><mi>i</mi><mi> &kappa; </mi>
      </mrow>
     </msqrt><mi> &alpha; </mi>
     <msub>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo>
    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mfrac>
     <mrow>
      <mrow><mi>d</mi><mi> &beta; </mi>
      </mrow>
     </mrow>
     <mrow>
      <mrow><mi>d</mi><mi>t</mi>
      </mrow>
     </mrow>
    </mfrac>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mo>-</mo>
     <msup>
      <mrow>
       <mover>
        <mrow><mi> &gamma; </mi>
        </mrow><mo stretchy="true">&tilde;</mo>
       </mover>
      </mrow>
      <mrow><mo> &lowast; </mo>
      </mrow>
     </msup><mi> &beta; </mi><mo>+</mo><mi>i</mi><mi> &kappa; </mi>
     <msup>
      <mrow><mi> &beta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup><mi> &alpha; </mi><mo>+</mo>
     <msup>
      <mrow>
       <mstyle mathvariant='script'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow><mo> &lowast; </mo>
      </mrow>
     </msup><mo>+</mo>
     <msqrt>
      <mrow><mi>i</mi><mi> &kappa; </mi>
      </mrow>
     </msqrt><mi> &beta; </mi>
     <msub>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(3.2)
   </mtd>
  </mtr>
 </mtable></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &xi; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> are independent Gaussian noise terms with zero means and the following nonzero correlations <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

     <mrow>
      <msub>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <msub>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>t</mi>
       </mrow>
       <mrow><mi> &prime; </mi>
       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>
<mo>=</mo>
     <msub>
      <mrow><mi> &delta; </mi>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mi>j</mi>
       </mrow>
      </mrow>
     </msub><mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>-</mo>
      <msup>
       <mrow><mi>t</mi>
       </mrow>
       <mrow><mi> &prime; </mi>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(3.3)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-568' />Note that these equations require that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &kappa; </mi><mo> &ll; </mo><mi> &gamma; </mi>
  </mrow>
 </mrow></math>, which is typical experimentally, otherwise one must use additional stochastic gauge stabilization to improve sampling error. </div>

<div class="standard"><a id='magicparlabel-569' />Defining the dimensionless parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &epsiv; </mi>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &lambda; </mi>
 </mrow></math> as <a id="parameters" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &epsiv; </mi><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mn>2</mn>
        <mstyle mathvariant='script'><mi>E</mi>
        </mstyle>
       </mrow>
      </mrow>
      <mrow><mi> &kappa; </mi>
      </mrow>
     </mfrac><mspace width="6px" /><mo>,</mo><mspace width="10px" /><mi> &lambda; </mi><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mn>2</mn>
        <mover>
         <mrow><mi> &gamma; </mi>
         </mrow><mo stretchy="true">&tilde;</mo>
        </mover>
       </mrow>
      </mrow>
      <mrow><mi> &kappa; </mi>
      </mrow>
     </mfrac><mspace width="6px" /><mspace width="6px" /><mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(3.4)
   </mtd>
  </mtr>
 </mtable></math>Provided <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &gamma; </mi><mo>+</mo><mo> &Delta; </mo><mi> &omega; </mi><mo>&lt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo>(</mo>
 </mrow></math>Re<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &lambda; </mi>
   <msup>
    <mrow><mo>)</mo>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mo>&gt;</mo><mn>3</mn><mo>|</mo><mi> &lambda; </mi>
   <msup>
    <mrow><mo>|</mo>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> there is a bistable region. This means that for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>|</mo><mi> &epsiv; </mi>
   <msup>
    <mrow><mo>|</mo>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> in a certain range, there are two physically possible values of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>n</mi>
   </mrow>
   <mrow><mn>0</mn>
   </mrow>
  </msub>
 </mrow></math>. For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi> &gamma; </mi>
    </mrow><mo stretchy="true">&tilde;</mo>
   </mover><mo>=</mo><mn>2.5</mn><mo>-</mo><mn>10</mn><mi>i</mi>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &kappa; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>, the bistable region is around <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='script'><mi>E</mi>
   </mstyle><mo>=</mo><mn>8</mn>
  </mrow>
 </mrow></math>. The observed quantity is the particle number, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

   <mrow>
    <msup>
     <mrow>
      <mover>
       <mrow><mi>a</mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
     </mrow>
     <mrow><mo> &dagger; </mo>
     </mrow>
    </msup>
    <mover>
     <mrow><mi>a</mi>
     </mrow><mo stretchy="true">&circ;</mo>
    </mover>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

   <mrow><mi> &alpha; </mi><mi> &beta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

  </mrow>
 </mrow></math>, with stable values of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo> &ap; </mo><mn>1</mn>
  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo> &ap; </mo><mn>6</mn>
  </mrow>
 </mrow></math>. </div>
<h3 class="subsection_"><a id='magicparlabel-570' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-571' /><li class="itemize_item"><b>Simulate the nonlinear oscillator by creating a file, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>N</mi><mi>o</mi><mi>n</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi><mn>.</mn><mi>m</mi>
  </mrow>
 </mrow></math> </b></li>
<li class="itemize_item"><b>Can you observe quantum tunneling of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo>=</mo><mi> &alpha; </mi><mi> &beta; </mi>
  </mrow>
 </mrow></math> in the bistable regime?</b></li>
<li class="itemize_item"><b>Do you see transient Schroedinger `cat states' with a negative n value?</b></li>
</ul>
<div class="standard"><a id='magicparlabel-574' />Since tunneling is random, for real experimental comparisons, one would have to measure correlation functions and spectra. However, a tunneling event in a simulation indicates that it is likely in experiment too. These calculations require long time scales, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>r</mi><mi>a</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi>
   </mrow>
  </mstyle>
 </mrow></math>, to observe tunneling, and a large number of time steps per plotted point, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi>
   </mrow>
  </mstyle>
 </mrow></math>, to maintain accuracy in the quantum simulations.</div>
<h1 class="chapter"><a id='magicparlabel-575' /><span class="chapter_label">4</span> Stochastic PDEs<a id="chap_Stochastic_partial_differential" />
</h1>
<div class="standard"><a id='magicparlabel-576' />A stochastic partial differential equation or <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>S</mi><mi>P</mi><mi>D</mi><mi>E</mi>
  </mrow>
 </mrow></math> for a complex vector field is defined in both time <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math> and space dimensions<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mstyle mathvariant='bold'><mi>x</mi></mstyle>
 </mrow></math>. The total dimension <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>d</mi>
 </mrow></math> in xSPDE is unlimited, and includes time and space. Large <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>d</mi>
 </mrow></math> is memory-intensive and slow! The general equation solved can be written in differential form as</div>

<div class="standard"><a id='magicparlabel-577' /><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mrow>
       <mrow><mi> &part; </mi>
        <mstyle mathvariant='bold'><mi>a</mi>
        </mstyle>
       </mrow>
      </mrow>
      <mrow>
       <mrow><mi> &part; </mi><mi>t</mi>
       </mrow>
      </mrow>
     </mfrac><mo>=</mo>
     <mstyle mathvariant='bold'><mi>A</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mstyle mathvariant='bold'><mi>a</mi>
     </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>+</mo>
     <munder>
      <mrow>
       <mstyle mathvariant='bold'><mi>B</mi>
       </mstyle>
      </mrow><mo stretchy="true">&macr;</mo>
     </munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mstyle mathvariant='bold'><mi>a</mi>
     </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo> &sdot; </mo><mstyle mathvariant='bold'><mi>w</mi></mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <munder>
      <mrow>
       <mstyle mathvariant='bold'><mi>L</mi>
       </mstyle>
      </mrow><mo stretchy="true">&macr;</mo>
     </munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>
<mstyle mathvariant='bold'><mi> &nabla; </mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo> &sdot; </mo>
     <mstyle mathvariant='bold'><mi>a</mi>
     </mstyle><mspace width="6px" /><mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(4.1)
   </mtd>
  </mtr>
 </mtable></math>Here <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'><mi>a</mi>
  </mstyle>
 </mrow></math> is a real or complex vector or vector field. The initial conditions are arbitrary functions. <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='bold'><mi>A</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mstyle mathvariant='bold'><mi>a</mi>
   </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <munder>
    <mrow>
     <mstyle mathvariant='bold'><mi>B</mi>
     </mstyle>
    </mrow><mo stretchy="true">&macr;</mo>
   </munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mstyle mathvariant='bold'><mi>a</mi>
   </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math> are vector and matrix functions of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'><mi>a</mi>
  </mstyle>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <munder>
    <mrow>
     <mstyle mathvariant='bold'><mi>L</mi>
     </mstyle>
    </mrow><mo stretchy="true">&macr;</mo>
   </munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>
<mstyle mathvariant='bold'><mi> &nabla; </mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math> is a matrix of linear terms and derivatives, diagonal in the vector indices, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='bold'><mi>w</mi>
   </mstyle><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow>
    <msup>
     <mrow><mstyle mathvariant='bold'><mi>w</mi></mstyle>
     </mrow>
     <mrow><mi>x</mi>
     </mrow>
    </msup><mo>,</mo>
    <msup>
     <mrow><mstyle mathvariant='bold'><mi>w</mi></mstyle>
     </mrow>
     <mrow><mi>k</mi>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math> are real delta-correlated noise fields such that: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

    <mrow>
     <msubsup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mi>x</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo><mstyle mathvariant='bold'><mi>x</mi></mstyle>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msubsup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
      <mrow><mi>x</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo><mstyle mathvariant='bold'><mi>x</mi></mstyle><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mstyle mathvariant='bold'><mi>x</mi></mstyle><mo>-</mo><mstyle mathvariant='bold'><mi>x</mi></mstyle><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>-</mo><mi>t</mi><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msub>
      <mrow><mi> &delta; </mi>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mi>j</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

    <mrow>
     <msubsup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo><mstyle mathvariant='bold'><mi>k</mi></mstyle>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msubsup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo><mstyle mathvariant='bold'><mi>k</mi></mstyle><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mstyle mathvariant='bold'><mi>k</mi>
     </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mstyle mathvariant='bold'><mi>k</mi></mstyle><mo>-</mo><mstyle mathvariant='bold'><mi>k</mi></mstyle><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>-</mo><mi>t</mi><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msub>
      <mrow><mi> &delta; </mi>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mi>j</mi>
       </mrow>
      </mrow>
     </msub><mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(4.2)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-578' />Transverse boundary conditions are assumed periodic. The term <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <munder>
    <mrow>
     <mstyle mathvariant='bold'><mi>L</mi>
     </mstyle>
    </mrow><mo stretchy="true">&macr;</mo>
   </munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>
<mstyle mathvariant='bold'><mi> &nabla; </mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math> may be omitted if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>, as there are no space dimensions. Here <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mstyle mathvariant='bold'><mi>k</mi>
   </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is an arbitrary momentum filter, for correlated noise. The linear function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>L</mi>
 </mrow></math> is input as a separate function in xSPDE, to allow for greatest efficiency and use of an interaction picture. Note that it depends on momentum space coordinates, and this involves Fourier transforms.</div>
<h2 class="section"><a id='magicparlabel-579' /><span class="section_label">4.1</span> Stochastic Ginzburg-Landau equation</h2>
<div class="standard"><a id='magicparlabel-580' />Including space-time dimensions with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi><mo>=</mo><mn>3</mn>
  </mrow>
 </mrow></math>, an example of a SPDE is the stochastic Ginzburg-Landau equation. This describes symmetry breaking: the system develops a spontaneous phase which can vary spatially as well. The model is widely used to describe lasers, magnetism, superconductivity, superfluidity and even particle physics: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>a</mi>
      </mrow><mo stretchy="true">&dot;</mo>
     </mover><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>1</mn><mo>-</mo>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>a</mi><mo>+</mo><mi>b</mi><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi>c</mi>
     <msup>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup><mi>a</mi>
    </mrow>
   </mtd>
   <mtd>(4.3)
   </mtd>
  </mtr>
 </mtable></math>where <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

     <mrow><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>x</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>x</mi><mo>'</mo>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>
<mo>=</mo><mn>2</mn><mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>-</mo><mi>t</mi><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>x</mi><mo>-</mo><mi>x</mi><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(4.4)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-581' />The following new ideas are introduced for this problem: </div>

<ol class="enumerate"><a id='magicparlabel-582' /><li class="enumerate_item"><b><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>d</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi>
   </mrow>
  </mstyle>
 </mrow></math> is the space-time dimension.</b> </li>
<li class="enumerate_item"><b>The</b> 'dot' <b>notation used for parallel operations over lattices</b>.</li>
<li class="enumerate_item"><b><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi>
   </mrow>
  </mstyle>
 </mrow></math> is the linear operator - a laplacian in these cases.</b></li>
<li class="enumerate_item"><b><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>i</mi><mi>m</mi><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi>
   </mrow>
  </mstyle>
 </mrow></math> produces movie-style images at discrete time slices.</b></li>
<li class="enumerate_item"><b><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='monospace'>
   <mrow><mi>r</mi><mn>.</mn><mi>D</mi><mi>x</mi>
   </mrow>
  </mstyle>
 </mrow></math> indicates a derivative operation, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &part; </mi><mo>/</mo><mi> &part; </mi><mi>x</mi>
  </mrow>
 </mrow></math>.</b> </li>
<li class="enumerate_item"><b><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>-</mo><mn>5</mn><mo>&lt;</mo><mi>x</mi><mo>&lt;</mo><mn>5</mn>
  </mrow>
 </mrow></math> is the default xSPDE coordinate range in space.</b> </li>
</ol>
<h3 class="subsection_"><a id='magicparlabel-588' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-589' /><li class="itemize_item"><b>Solve the stochastic G-L equation for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>b</mi><mo>=</mo><mn>0.001</mn>
  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mo>=</mo><mn>0.01</mn><mi>i</mi>
  </mrow>
 </mrow></math>.</b></li>
<li class="itemize_item"><b>Change to a real diffusion so that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mo>=</mo><mn>0.1</mn>
  </mrow>
 </mrow></math>.</b></li>
</ul>
<div class="standard"><a id='magicparlabel-591' />In the first case, you should get the output graphed in Fig (<a href="#fig_Symmetry_breaking">4.1</a>) .
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-592' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-596' /><span style='font-family:monospace;'>in.noises=2;</span></div>

<div class="plain_layout"><a id='magicparlabel-597' /><span style='font-family:monospace;'>in.dimension=3;</span></div>

<div class="plain_layout"><a id='magicparlabel-598' /><span style='font-family:monospace;'>in.steps=10;</span></div>

<div class="plain_layout"><a id='magicparlabel-599' /><span style='font-family:monospace;'>in.linear = @(r) i*0.01*(r.Dx.^2+r.Dy.^2);</span></div>

<div class="plain_layout"><a id='magicparlabel-600' /><span style='font-family:monospace;'>in.observe = @(a,~) abs(a).^2;</span></div>

<div class="plain_layout"><a id='magicparlabel-601' /><span style='font-family:monospace;'>in.images =6;</span></div>

<div class="plain_layout"><a id='magicparlabel-602' /><span style='font-family:monospace;'>in.olabels = '|a|^2';</span></div>

<div class="plain_layout"><a id='magicparlabel-603' /><span style='font-family:monospace;'>in.da=@(a,w,~) (1-abs(a(1,:)).^2).*a+0.001*(w(1,:)+i*w(2,:));</span></div>

<div class="plain_layout"><a id='magicparlabel-604' /><span style='font-family:monospace;'>xspde(in)</span></div>
</div></div>

<div class="standard"><a id='magicparlabel-605' />Here the notation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>z</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1</mn><mo>,</mo><mo>:</mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is like the dot: the colon means that the operation is repeated over all values of the second index, which is the spatial lattice index.</div>


<div class='float float-figure'><div class="plain_layout"><a id='magicparlabel-610' /><img style='width:75%;' src='3_Users_pddrummond_Dropbox_2016_Computers_xspde_matlab2_2_users_guide_Figures_GinzLand.png' alt='image: 3_Users_pddrummond_Dropbox_2016_Computers_xspde_matlab2_2_users_guide_Figures_GinzLand.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Figure 4.1:  <a id="fig_Symmetry_breaking" />
Simulation of the stochastic equation describing symmetry breaking in two dimensions. Spatial fluctuations are caused by the different phase-domains that interfere. The graph obtained here is projected onto the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>y</mi><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math> plane. </span></div>
</div>

<h2 class="section"><a id='magicparlabel-623' /><span class="section_label">4.2</span> Soliton</h2>
<div class="standard"><a id='magicparlabel-624' />The famous nonlinear Schrdinger equation (NLSE) is: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow>
     <mrow><mi>d</mi><mi>a</mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi>d</mi><mi>t</mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo>
   <mfrac>
    <mrow><mi>i</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow>
    <msup>
     <mrow><mi> &nabla; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mi>a</mi><mo>-</mo><mi>a</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>+</mo><mi>i</mi><mi>a</mi>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-625' />Together with the initial condition that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0</mn><mo>,</mo><mi>x</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>s</mi><mi>e</mi><mi>c</mi><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>x</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, this has a soliton, an exact solution that doesn't change in time: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo><mi>x</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>x</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math>The Fourier transform at <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>k</mi><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math> is simply: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>a</mi>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo><mn>0</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msqrt>
        <mrow><mn>2</mn><mi> &pi; </mi>
        </mrow>
       </msqrt>
      </mrow>
     </mfrac>
     <mrow><mo> &int; </mo>
     </mrow>
     <mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>x</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow><mo> &InvisibleTimes; </mo>
     <mrow><mo> &DifferentialD; </mo><mi>x</mi>
     </mrow><mo>=</mo>
     <msqrt>
      <mfrac>
       <mrow><mi> &pi; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </mfrac>
     </msqrt>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_"><a id='magicparlabel-626' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-627' /><li class="itemize_item"><b>Solve the NLSE for a soliton</b></li>
</ul>
<div class="standard" style='text-align: center;'><a id='magicparlabel-628' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-632' />f<span style='font-family:monospace;'>unction [e] = Soliton() </span></div>

<div class="plain_layout"><a id='magicparlabel-633' /><span style='font-family:monospace;'>in.name = 'NLS soliton';</span></div>

<div class="plain_layout"><a id='magicparlabel-634' /><span style='font-family:monospace;'>in.dimension = 2; </span></div>

<div class="plain_layout"><a id='magicparlabel-635' /><span style='font-family:monospace;'>in.initial = @(v,r) sech(r.x); </span></div>

<div class="plain_layout"><a id='magicparlabel-636' /><span style='font-family:monospace;'>in.da = @(a,~,r) i*a.*(conj(a).*a);</span></div>

<div class="plain_layout"><a id='magicparlabel-637' /><span style='font-family:monospace;'>in.linear = @(r) 0.5*i*(r.Dx.^2-1.0);</span></div>

<div class="plain_layout"><a id='magicparlabel-638' /><span style='font-family:monospace;'>in.olabels = {'a_1(x)'}; </span></div>

<div class="plain_layout"><a id='magicparlabel-639' /><span style='font-family:monospace;'>in.compare{1}= @(t,~) 1; </span></div>

<div class="plain_layout"><a id='magicparlabel-640' /><span style='font-family:monospace;'>e = xspde(in); </span></div>

<div class="plain_layout"><a id='magicparlabel-641' /><span style='font-family:monospace;'>end</span></div>
</div> </div>

<ul class="itemize"><a id='magicparlabel-642' /><li class="itemize_item"><b>Add an additive complex noise of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>0.01</mn><mo>(</mo>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>+</mo><mi>i</mi>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>) to the differential equation, then replot with an average over <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1000</mn>
 </mrow></math> samples.</b></li>
</ul>
<div class="standard"><a id='magicparlabel-643' /><br />
</div>
<h2 class="section"><a id='magicparlabel-644' /><span class="section_label">4.3</span> Gaussian diffraction </h2>
<div class="standard"><a id='magicparlabel-645' />Free diffraction of a Gaussian wave-function in three dimensions, is given by <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow>
     <mrow><mi>d</mi><mi>a</mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi>d</mi><mi>t</mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo>
   <mfrac>
    <mrow><mi>i</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </mfrac>
   <msup>
    <mrow><mi> &nabla; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mi>a</mi>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-646' />The xSPDE spectral definition in space-time is:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>a</mi>
    </mrow><mo stretchy="true">&tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &omega; </mi><mo>,</mo><mstyle mathvariant='bold'><mi>k</mi></mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

       <mrow><mn>2</mn><mi> &pi; </mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

      </mrow>
      <mrow>
       <mrow><mi>D</mi><mo>/</mo><mn>2</mn>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mfrac>
   <mrow><mo> &int; </mo>
   </mrow>
   <mrow>
    <msup>
     <mrow><mi>e</mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mstyle mathvariant='bold'><mi>k</mi></mstyle><mo> &sdot; </mo><mstyle mathvariant='bold'><mi>x</mi></mstyle><mo>-</mo><mi> &omega; </mi><mi>t</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </msup><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>t</mi><mo>,</mo><mstyle mathvariant='bold'><mi>x</mi></mstyle>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow><mo> &InvisibleTimes; </mo>
   <mrow><mo> &DifferentialD; </mo><mi>t</mi>
   </mrow><mi>d</mi><mstyle mathvariant='bold'><mi>x</mi></mstyle><mspace width="6px" />
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-647' />Together with the initial condition that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0</mn><mo>,</mo><mi>x</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo>-</mo>
    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

      <mstyle mathvariant='bold'><mi>x</mi>
      </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>/</mo><mn>2</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, this has an exact solution for the diffracted intensity in either ordinary space or momentum space is therefore: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

      <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>,</mo>
        <mstyle mathvariant='bold'><mi>x</mi>
        </mstyle>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msup>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mn>1</mn><mo>+</mo>
          <msup>
           <mrow><mi>t</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
        <mrow>
         <mrow><mn>3</mn><mo>/</mo><mn>2</mn>
         </mrow>
        </mrow>
       </msup>
      </mrow>
     </mfrac><mi>e</mi><mi>x</mi><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

        <mstyle mathvariant='bold'><mi>x</mi>
        </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo>/</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mn>1</mn><mo>+</mo>
       <msup>
        <mrow><mi>t</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

      <mrow>
       <mover>
        <mrow><mi>a</mi>
        </mrow><mo stretchy="true">&tilde;</mo>
       </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>,</mo>
        <mstyle mathvariant='bold'><mi>k</mi>
        </mstyle>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

        <mstyle mathvariant='bold'><mi>k</mi>
        </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-648' />To get an output from a spatially Fourier transformed field, just set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>s</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math>, for the particular observable you need to calculate in transform space.</div>
<h3 class="subsection_"><a id='magicparlabel-649' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-650' /><li class="itemize_item"><b>Solve the diffraction equation without noise</b></li>
<li class="itemize_item">Note that the example below stores data in a standardized HDF5 file.</li>
</ul>
<div class="standard" style='text-align: center;'><a id='magicparlabel-652' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-656' /><span style='font-family:monospace;'>function [e] = Gaussian() </span></div>

<div class="plain_layout"><a id='magicparlabel-657' /><span style='font-family:monospace;'>in.dimension = 4; </span></div>

<div class="plain_layout"><a id='magicparlabel-658' /><span style='font-family:monospace;'>in.initial = @(v,r) exp(-0.5*(r.x.^2+r.y.^2+r.z.^2));</span></div>

<div class="plain_layout"><a id='magicparlabel-659' /><span style='font-family:monospace;'>in.linear = @(r) 1i*0.05*(r.Dx.^2+r.Dy.^2+r.Dz.^2); </span></div>

<div class="plain_layout"><a id='magicparlabel-660' /><span style='font-family:monospace;'>in.observe = @(a,r) a.*conj(a); </span></div>

<div class="plain_layout"><a id='magicparlabel-661' /><span style='font-family:monospace;'>in.olabels = '|a(x)|^2'; </span></div>

<div class="plain_layout"><a id='magicparlabel-662' /><span style='font-family:monospace;'>in.file = 'Gaussian.h5';</span></div>

<div class="plain_layout"><a id='magicparlabel-663' /><span style='font-family:monospace;'>in.images = 4;</span></div>

<div class="plain_layout"><a id='magicparlabel-664' /><span style='font-family:monospace;'>[e,in] = xsim(in); </span></div>

<div class="plain_layout"><a id='magicparlabel-665' /><span style='font-family:monospace;'>e = xgraph(in.file); </span></div>

<div class="plain_layout"><a id='magicparlabel-666' /><span style='font-family:monospace;'>end </span> </div>
</div></div>

<ul class="itemize"><a id='magicparlabel-667' /><li class="itemize_item"><b>Add an additive complex noise of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>0.01</mn><mo>(</mo>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>+</mo><mi>i</mi>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>) to the Gaussian differential equation, then replot with an average over <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>10</mn>
 </mrow></math> samples.</b></li>
</ul>
<div class="standard"><a id='magicparlabel-668' />Note that for this, you'll need to define <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>d</mi><mi>a</mi><mo>=</mo><mo>@</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>a</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>r</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>0.01</mn><mo>*</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mn>1</mn><mo>,</mo><mo>:</mo>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi>i</mi><mo>*</mo><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mn>2</mn><mo>,</mo><mo>:</mo>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-669' /><br />
</div>
<h2 class="section"><a id='magicparlabel-670' /><span class="section_label">4.4</span> Planar noise</h2>
<div class="standard"><a id='magicparlabel-671' />The next example is growth of thermal noise of a two-component complex field in a plane, given by the equation <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow>
     <mrow><mi>d</mi><mstyle mathvariant='bold'><mi>a</mi></mstyle>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi>d</mi><mi>t</mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo>
   <mfrac>
    <mrow><mi>i</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </mfrac>
   <msup>
    <mrow><mi> &nabla; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mstyle mathvariant='bold'><mi>a</mi></mstyle><mo>+</mo><mstyle mathvariant='bold'><mi>w</mi></mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>t</mi><mo>,</mo><mi>x</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mstyle mathvariant='bold'><mi> &zeta; </mi></mstyle>
 </mrow></math> is a delta-correlated complex noise vector field: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>t</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>x</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow>
    <msubsup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow>
      <mrow><mi>r</mi><mi>e</mi>
      </mrow>
     </mrow>
    </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>t</mi><mo>,</mo>
     <mstyle mathvariant='bold'><mi>x</mi>
     </mstyle>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi>i</mi>
    <msubsup>
     <mrow><mi> &zeta; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mi>m</mi>
      </mrow>
     </mrow>
    </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>t</mi><mo>,</mo>
     <mstyle mathvariant='bold'><mi>x</mi>
     </mstyle>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>/</mo>
   <msqrt><mn>2</mn>
   </msqrt><mo>,</mo>
  </mrow>
 </mrow></math>with the initial condition that the initial noise is delta-correlated in position space <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0</mn><mo>,</mo>
    <mstyle mathvariant='bold'><mi>x</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msup>
    <mrow><mstyle mathvariant='bold'><mi> &zeta; </mi></mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>i</mi><mi>n</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mstyle mathvariant='bold'><mi>x</mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>where: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mstyle mathvariant='bold'><mi> &zeta; </mi></mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>i</mi><mi>n</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mstyle mathvariant='bold'><mi>x</mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow>
    <msup>
     <mrow><mstyle mathvariant='bold'><mi> &zeta; </mi></mstyle>
     </mrow>
     <mrow>
      <mrow><mi>r</mi><mi>e</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>i</mi><mi>n</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mstyle mathvariant='bold'><mi>x</mi>
    </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi>i</mi>
    <msup>
     <mrow><mstyle mathvariant='bold'><mi> &zeta; </mi></mstyle>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mi>m</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>i</mi><mi>n</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mstyle mathvariant='bold'><mi>x</mi>
    </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>/</mo>
   <msqrt><mn>2</mn>
   </msqrt>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-672' />This has an exact solution for the noise intensity in either ordinary space or momentum space: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

      <mrow>
       <msub>
        <mrow><mi>a</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>,</mo>
        <mstyle mathvariant='bold'><mi>x</mi>
        </mstyle>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>1</mn><mo>+</mo><mi>t</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>/</mo><mo> &Delta; </mo><mi>V</mi>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

      <mrow>
       <msub>
        <mrow>
         <mover>
          <mrow><mi>a</mi>
          </mrow><mo stretchy="true">&tilde;</mo>
         </mover>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>,</mo>
        <mstyle mathvariant='bold'><mi>k</mi>
        </mstyle>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>1</mn><mo>+</mo><mi>t</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>/</mo><mo> &Delta; </mo>
     <msub>
      <mrow><mi>V</mi>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msub>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

    <mrow>
     <msub>
      <mrow>
       <mover>
        <mrow><mi>a</mi>
        </mrow><mo stretchy="true">&tilde;</mo>
       </mover>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo>
      <mstyle mathvariant='bold'><mi>k</mi>
      </mstyle>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msubsup>
      <mrow>
       <mover>
        <mrow><mi>a</mi>
        </mrow><mo stretchy="true">&tilde;</mo>
       </mover>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo>
      <mstyle mathvariant='bold'><mi>k</mi>
      </mstyle>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd><mn>0</mn>
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-673' />Here, the noise is delta-correlated, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> &Delta; </mo><mi>V</mi>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> &Delta; </mo>
   <msub>
    <mrow><mi>V</mi>
    </mrow>
    <mrow><mi>k</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> are the cartesian space and momentum space lattice cell volumes respectively. Suppose that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>N</mi><mo>=</mo>
   <msub>
    <mrow><mi>N</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>N</mi>
    </mrow>
    <mrow><mi>y</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> is the total number of spatial points, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>V</mi><mo>=</mo>
   <msub>
    <mrow><mi>R</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>R</mi>
    </mrow>
    <mrow><mi>y</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, where there are <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>N</mi>
   </mrow>
   <mrow>
    <mrow><mi>x</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>y</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mrow>
  </msub>
 </mrow></math> points in the x(y)-direction, with a total range of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>R</mi>
   </mrow>
   <mrow>
    <mrow><mi>x</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>y</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mrow>
  </msub>
 </mrow></math>. Then, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> &Delta; </mo><mi>x</mi><mo>=</mo>
   <msub>
    <mrow><mi>R</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub><mo>/</mo>
   <msub>
    <mrow><mi>N</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> ,<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> &Delta; </mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub><mo>=</mo><mn>2</mn><mi> &pi; </mi><mo>/</mo>
   <msub>
    <mrow><mi>R</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> , so that: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> &Delta; </mo><mi>V</mi>
    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mo> &Delta; </mo><mi>x</mi><mo> &Delta; </mo><mi>y</mi><mo>=</mo>
     <mfrac>
      <mrow><mi>V</mi>
      </mrow>
      <mrow><mi>N</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mo> &Delta; </mo>
     <msub>
      <mrow><mi>V</mi>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mo> &Delta; </mo>
     <msub>
      <mrow><mi>k</mi>
      </mrow>
      <mrow><mi>x</mi>
      </mrow>
     </msub><mo> &Delta; </mo>
     <msub>
      <mrow><mi>k</mi>
      </mrow>
      <mrow><mi>y</mi>
      </mrow>
     </msub><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mo>(</mo><mn>2</mn><mi> &pi; </mi>
        <msup>
         <mrow><mo>)</mo>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mrow>
      <mrow><mi>V</mi>
      </mrow>
     </mfrac><mn>.</mn>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard"><a id='magicparlabel-674' />In the simulations, two planar noise fields are propagated, one using delta-correlated noise, the other with noise transformed to momentum space to allow filtering. This allows use of finite correlation lengths when needed, by including a frequency filter function that is used to multiply the noise in Fourier-space. The Fourier-space noise variance is the square of the filter function. </div>

<div class="standard"><a id='magicparlabel-675' />The first noise index, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, indicates how many noise fields are generated, while <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> indicates how many of these are spatially correlated, via Fourier transform, filter and inverse Fourier transform. These appear to the user as additional noises, so the total is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi>i</mi><mi>n</mi><mn>.</mn><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. The filtered noises have a finite correlation length. They are correlated with the first <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> x-space noises they are generated from, as this can be useful. </div>
<h3 class="subsection_"><a id='magicparlabel-676' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-677' /><li class="itemize_item"><b>Solve the planar noise growth equation</b></li>
</ul>
<div class="standard" style='text-align: center;'><a id='magicparlabel-678' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-682' /><span style='font-family:monospace;'>function [e] = Planar() </span></div>

<div class="plain_layout"><a id='magicparlabel-683' /><span style='font-family:monospace;'>in.name = 'Planar noise growth'; </span></div>

<div class="plain_layout"><a id='magicparlabel-684' /><span style='font-family:monospace;'>in.dimension = 3; </span></div>

<div class="plain_layout"><a id='magicparlabel-685' /><span style='font-family:monospace;'>in.fields = 2; </span></div>

<div class="plain_layout"><a id='magicparlabel-686' /><span style='font-family:monospace;'>in.ranges = [1,5,5]; </span></div>

<div class="plain_layout"><a id='magicparlabel-687' /><span style='font-family:monospace;'>in.steps = 2; </span></div>

<div class="plain_layout"><a id='magicparlabel-688' /><span style='font-family:monospace;'>in.noises = [4,2]; </span></div>

<div class="plain_layout"><a id='magicparlabel-689' /><span style='font-family:monospace;'>in.ensembles = [10,4,4]; </span></div>

<div class="plain_layout"><a id='magicparlabel-690' /><span style='font-family:monospace;'>in.initial = @Initial; </span></div>

<div class="plain_layout"><a id='magicparlabel-691' /><span style='font-family:monospace;'>in.da = @Da; </span></div>

<div class="plain_layout"><a id='magicparlabel-692' /><span style='font-family:monospace;'>in.linear = @Linear; </span></div>

<div class="plain_layout"><a id='magicparlabel-693' /><span style='font-family:monospace;'>in.observe = @(a,r) a(1,:).*conj(a(1,:));</span></div>

<div class="plain_layout"><a id='magicparlabel-694' /><span style='font-family:monospace;'>in.olabels= '&lt;|a_1(x)|^2&gt;';</span></div>

<div class="plain_layout"><a id='magicparlabel-695' /><span style='font-family:monospace;'>in.compare = @(t,in) [1+t]/in.dV;</span></div>

<div class="plain_layout"><a id='magicparlabel-696' /><span style='font-family:monospace;'>in.images = 4; </span></div>

<div class="plain_layout"><a id='magicparlabel-697' /><span style='font-family:monospace;'>e = xspde(in); </span></div>

<div class="plain_layout"><a id='magicparlabel-698' /><span style='font-family:monospace;'>end </span>
<br />

 <span style='font-family:monospace;'> </span></div>

<div class="plain_layout"><a id='magicparlabel-699' /><span style='font-family:monospace;'>function a0 = Initial(v,r) </span></div>

<div class="plain_layout"><a id='magicparlabel-700' /><span style='font-family:monospace;'>a0(1,:) = (v(5,:)+1i*v(6,:))/sqrt(2); </span></div>

<div class="plain_layout"><a id='magicparlabel-701' /><span style='font-family:monospace;'>a0(2,:) = (v(3,:)+1i*v(4,:))/sqrt(2); </span></div>

<div class="plain_layout"><a id='magicparlabel-702' /><span style='font-family:monospace;'>end </span>
<br />

<span style='font-family:monospace;'> </span></div>

<div class="plain_layout"><a id='magicparlabel-703' /><span style='font-family:monospace;'>function da = Da(a,z,r) </span></div>

<div class="plain_layout"><a id='magicparlabel-704' /><span style='font-family:monospace;'>da(1,:) = (z(5,:)+1i*z(6,:))/sqrt(2); </span></div>

<div class="plain_layout"><a id='magicparlabel-705' /><span style='font-family:monospace;'>da(2,:) = (z(3,:)+1i*z(4,:))/sqrt(2); </span></div>

<div class="plain_layout"><a id='magicparlabel-706' /><span style='font-family:monospace;'>end </span>
<br />

 <span style='font-family:monospace;'> </span></div>

<div class="plain_layout"><a id='magicparlabel-707' /><span style='font-family:monospace;'>function L = Linear(r) </span></div>

<div class="plain_layout"><a id='magicparlabel-708' /><span style='font-family:monospace;'>lap = r.Dx.^2+r.Dy.^2; </span></div>

<div class="plain_layout"><a id='magicparlabel-709' /><span style='font-family:monospace;'>L(1,:) = 1i*0.5*lap(:); </span></div>

<div class="plain_layout"><a id='magicparlabel-710' /><span style='font-family:monospace;'>L(2,:) = 1i*0.5*lap(:); </span></div>

<div class="plain_layout"><a id='magicparlabel-711' /><span style='font-family:monospace;'>end</span></div>
</div> </div>

<ul class="itemize"><a id='magicparlabel-712' /><li class="itemize_item"><b>Add a decay rate of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>-</mo><mi>a</mi>
  </mrow>
 </mrow></math> to the differential equation, then replot</b></li>
<li class="itemize_item"><b>Add growth and nonlinear saturation terms</b></li>
</ul>
<div class="standard"><a id='magicparlabel-714' /><br />
</div>
<h2 class="section"><a id='magicparlabel-715' /><span class="section_label">4.5</span> Characteristic equation</h2>
<div class="standard"><a id='magicparlabel-716' />The next example is the characteristic equation for a traveling wave at constant velocity. It is included to illustrate what happens at periodic boundaries, when Fourier-transform methods are used for propagation. There are a number of methods known to prevent this effect, including addition of absorbers - often called apodization - at the boundaries. The equation is: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow>
     <mrow><mi>d</mi><mi>a</mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi>d</mi><mi>t</mi>
     </mrow>
    </mrow>
   </mfrac><mo>+</mo>
   <mfrac>
    <mrow>
     <mrow><mi>d</mi><mi>a</mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi>d</mi><mi>x</mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-717' />Together with the initial condition that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0</mn><mo>,</mo><mi>x</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>s</mi><mi>e</mi><mi>c</mi><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>2</mn><mi>x</mi><mo>+</mo><mn>5</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, this has an exact solution that propagates at a constant velocity: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo><mi>x</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>2</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>x</mi><mo>-</mo><mi>t</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mn>5</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math>The time evolution at <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math> is simply: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>,</mo><mn>0</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>2</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>t</mi><mo>-</mo><mn>5</mn><mo>/</mo><mn>2</mn>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_"><a id='magicparlabel-718' />Exercises</h3>

<ul class="itemize"><a id='magicparlabel-719' /><li class="itemize_item"><b>Solve the characteristic equation given above, noting the effects of periodic boundaries.</b></li>
</ul>
<div class="standard" style='text-align: center;'><a id='magicparlabel-720' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-724' /><span style='font-family:monospace;'>function [e] = Characteristic() </span></div>

<div class="plain_layout"><a id='magicparlabel-725' /><span style='font-family:monospace;'>in.name = 'Characteristic'</span></div>

<div class="plain_layout"><a id='magicparlabel-726' /><span style='font-family:monospace;'>in.dimension = 2; </span></div>

<div class="plain_layout"><a id='magicparlabel-727' /><span style='font-family:monospace;'>in.initial = @(v,r) sech(2.*(r.x+2.5)); </span></div>

<div class="plain_layout"><a id='magicparlabel-728' /><span style='font-family:monospace;'>in.da = @(a,z,r) 0*a; </span></div>

<div class="plain_layout"><a id='magicparlabel-729' /><span style='font-family:monospace;'>in.linear = @(r) -r.Dx; </span></div>

<div class="plain_layout"><a id='magicparlabel-730' /><span style='font-family:monospace;'>in.olabels = 'a_1(x)'; </span></div>

<div class="plain_layout"><a id='magicparlabel-731' /><span style='font-family:monospace;'>in.compare = @(t,in) sech(2.*(t-2.5)); </span></div>

<div class="plain_layout"><a id='magicparlabel-732' /><span style='font-family:monospace;'>e = xspde(in); </span></div>

<div class="plain_layout"><a id='magicparlabel-733' /><span style='font-family:monospace;'>end </span></div>
</div> </div>

<ul class="itemize"><a id='magicparlabel-734' /><li class="itemize_item"><b>Recalculate with the opposite velocity, and a new exact solution.</b></li>
</ul>
<h2 class="section"><a id='magicparlabel-735' /><span class="section_label">4.6</span> Challenge problem #2</h2>
<div class="standard"><a id='magicparlabel-736' />Counter-intuitively, a random potential prevents normal wave-packet spreading in quantum-mechanics. This is Anderson localization: a famous property of quantum mechanics in a random potential. A typical experimental method is to confine an ultra-cold Bose-Einstein condensate (BEC) in a trap, then release the BEC in a random external potential produced by a laser. The expansion rate of the BEC is reduced by the Anderson localization due to the random potential. Physically, the observable quantity is the particle density <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mi> &psi; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>.</div>

<div class="standard"><a id='magicparlabel-737' />This can be treated either using a Schroedinger equation with a random potential, at low density, or using the Gross-Pitaevskii (GP) equation to include atom-atom interactions at the mean field level. In this example of a problem where strong localization occurs, the general equations are: </div>

<div class="standard"><a id='magicparlabel-738' /><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow>
     <mrow><mi> &part; </mi><mi> &psi; </mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi> &part; </mi><mi>t</mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mi> &planck; </mi>
     </mrow>
    </mrow>
   </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mo>-</mo>
    <mfrac>
     <mrow>
      <msup>
       <mrow><mi> &planck; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mrow>
      <mrow><mn>2</mn><mi>m</mi>
      </mrow>
     </mrow>
    </mfrac>
    <msup>
     <mrow><mi> &nabla; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>+</mo><mi>V</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mstyle mathvariant='bold'><mi>r</mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi>g</mi>
    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mi> &psi; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mi> &psi; </mi>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-739' />In calculations, it is best to use a dimensionless form by rescaling coordinates and fields. A simple way to simulate this with xSPDE is to treat <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &psi; </mi>
 </mrow></math> as a scaled field <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo>
  </mrow>
 </mrow></math> and to assume the random potential field <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>V</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mstyle mathvariant='bold'><mi>r</mi></mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> as caused by interactions with second random field <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

    <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msup>
 </mrow></math>. This has the advantage that it is similar to the actual experiment, and allows one to treat time-dependent potentials as well, if desired. </div>

<div class="standard"><a id='magicparlabel-740' />With the rescaling, this simplifies to:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow>
     <mrow><mi> &part; </mi>
      <msub>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi> &part; </mi><mi> &tau; </mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo><mi>i</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow>
    <msup>
     <mrow>
      <mfrac>
       <mrow><mi> &part; </mi>
       </mrow>
       <mrow>
        <mrow><mi> &part; </mi>
         <msup>
          <mrow><mi> &zeta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>-</mo>
    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

      <msub>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>-</mo>
    <msup>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

      <msub>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

   <msub>
    <mrow><mi>a</mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id='magicparlabel-741' />A convenient initial condition is to use: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msub>
     <mrow><mi>a</mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub>
   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>a</mi>
      </mrow>
      <mrow><mn>0</mn>
      </mrow>
     </msub><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <msup>
       <mrow><mi> &zeta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&lang;</mo>

    <mrow>
     <msub>
      <mrow><mi>a</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &zeta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msub>
      <mrow><mi>a</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &zeta; </mi><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&rang;</mo>

   </mtd>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow><mi>v</mi><mi> &delta; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &zeta; </mi><mo>-</mo><mi> &zeta; </mi><mo>'</mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_"><a id='magicparlabel-742' />Exercise</h3>

<ul class="itemize"><a id='magicparlabel-743' /><li class="itemize_item"><b>Solve Schroedinger's equation without a random potential, to observe expansion.</b></li>
<li class="itemize_item"><b>Include a random potential <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>v</mi>
 </mrow></math>, to observe localization.</b></li>
<li class="itemize_item"><b>Experiment with nonlinear terms and higher dimensions.</b></li>
</ul>
<div class="standard"><a id='magicparlabel-746' />Note that the GP equation is a mean field approximation; this is still not a full solution of the many-body problem! Also, the experiments are somewhat more complicated than this, and actually observe the momentum distribution.</div>
<h1 class="chapter"><a id='magicparlabel-747' /><span class="chapter_label">5</span> Logic and data<a id="chap_Logic_and_data" />
</h1>
<div class="standard"><a id='magicparlabel-748' />The simulation program logic is straightforward. It is a very compact function called <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>s</mi><mi>p</mi><mi>d</mi><mi>e</mi>
   </mrow>
  </mstyle>
 </mrow></math>. This calls <b><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>s</mi><mi>i</mi><mi>m</mi>
   </mrow>
  </mstyle>
 </mrow></math></b>, for the simulation, then <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>p</mi><mi>h</mi>
   </mrow>
  </mstyle>
 </mrow></math> for the graphics. Most of the work is done by other specialized functions. Input parameters come from an <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><!-- mathfontold -->
  <mi>[font bf [char i mathalpha][char n mathalpha][char p mathalpha][char u mathalpha][char t mathalpha]]
  </mi>
 </mrow></math> array, output is saved either in a <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><!-- mathfontold -->
  <mi>[font bf [char d mathalpha][char a mathalpha][char t mathalpha][char a mathalpha]]
  </mi>
 </mrow></math> array, or else in a specified file. During the simulation, global averages and error-bars are calculated for both time-step and sampling errors. When completed, timing and error results are printed. </div>
<h2 class="section"><a id='magicparlabel-749' /><span class="section_label">5.1</span> Simulation function, <em>xsim</em></h2>
<h3 class="subsection"><a id='magicparlabel-750' /><span class="subsection_label">5.1.1</span> Input and data structures</h3>
<div class="standard"><a id='magicparlabel-751' />To explain xSPDE in full detail, </div>

<ul class="itemize"><a id='magicparlabel-752' /><li class="itemize_item">Simulation inputs are stored in the <b>input</b> cell array. </li>
<li class="itemize_item">This describes a <em>sequence</em> of simulations, so that <b>input={in1,in2,...}</b>. </li>
<li class="itemize_item">Each structure <b>in</b> describes a simulation, whose output is the input of the next. </li>
<li class="itemize_item">The main simulation function is called using <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>s</mi><mi>i</mi><mi>m</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </mstyle>
 </mrow></math>. </li>
<li class="itemize_item">Averages are recorded sequentially in the <b>data</b> cell array. </li>
<li class="itemize_item">Raw trajectory data is stored in the <b>raw</b> cell array if required. </li>
</ul>
<div class="standard"><a id='magicparlabel-758' />The sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi>
   </mrow>
  </mstyle>
 </mrow></math> has a number of individual simulation objects <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>i</mi><mi>n</mi>
   </mrow>
  </mstyle>
 </mrow></math>. Each includes parameters that specify the simulation, with functions that give the equations and observables. If there is only one simulation, just one individual specification <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>i</mi><mi>n</mi>
   </mrow>
  </mstyle>
 </mrow></math> is needed. In addition, xSPDE generates graphs with its own graphics program.</div>
<h3 class="subsection"><a id='magicparlabel-759' /><span class="subsection_label">5.1.2</span> User definable simulation functions</h3>
<div class="standard"><a id='magicparlabel-760' />The most commonly used functions are indicated with an asterisk. Others have automatic defaults that are not usually changed, except in special cases.</div>

<dl class='description'><a id='magicparlabel-761' /><dt class="description_label">*initial</dt>
<dd class="description_item"> is used to initialize each integration in time. This is a user-defined function, which can involve random numbers if there is an initial probability distribution. This creates a stochastic field on the lattice, called <em><b>a.</b></em> The default is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>s</mi><mi>e</mi>
   </mrow>
  </mstyle>
 </mrow></math>, which sets fields to zero. The returned first dimension should be fields(1). </dd>
<dt class="description_label">*observe</dt>
<dd class="description_item"> is the initial observation function, whose output is averaged over the ensembles, called from <b>xpath</b>. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>o</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi>
   </mrow>
  </mstyle>
 </mrow></math>, returns the real part of the amplitudes. </dd>
<dt class="description_label">*function</dt>
<dd class="description_item"> is an optional function used to take arbitrary transforms of the initial observe outputs, after averaging over the <em>first</em> ensemble. The default returns the averages unchanged. </dd>
<dt class="description_label">*linear</dt>
<dd class="description_item"> is the linear response, including transverse derivatives in space. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi>
   </mrow>
  </mstyle>
 </mrow></math>, sets this to zero. </dd>
<dt class="description_label">*da</dt>
<dd class="description_item"> is called by <b>step</b> to calculate derivatives of the stochastic fields at every step in the process, including the stochastic terms. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi>
   </mrow>
  </mstyle>
 </mrow></math>, sets this to zero. The returned first dimension should be fields(1). All stochastic fields are accessible as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>n</mi><mo>,</mo><mo>:</mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo> &le; </mo><mi>f</mi><mi>i</mi><mi>e</mi><mi>l</mi><mi>d</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</dd>
<dt class="description_label">*define</dt>
<dd class="description_item"> is called by <b>step</b> to calculate any user-defined auxiliary fields. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>d</mi><mi>e</mi><mi>f</mi><mi>i</mi><mi>n</mi><mi>e</mi>
   </mrow>
  </mstyle>
 </mrow></math>, sets these to zero. The returned first dimension should be fields(2). If auxiliary fields are used they are accessible as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>n</mi><mo>,</mo><mo>:</mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo>&gt;</mo><mi>f</mi><mi>i</mi><mi>e</mi><mi>l</mi><mi>d</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</dd>
<dt class="description_label">transfer</dt>
<dd class="description_item"> is a function used to initialize sequential simulations,<b> </b>where previous or output stochastic field values are automatically included as input to the next stage ine the intergation sequence. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>e</mi><mi>r</mi>
   </mrow>
  </mstyle>
 </mrow></math>, uses the output of the previous simulation for the input to the next stage. This can be changed by the user.</dd>
<dt class="description_label">step</dt>
<dd class="description_item"> is the algorithm that computes each step in time. This also generates the random numbers at each time-step. Options include <b>xEuler</b>, <b>xRK2</b>, <b>xRK4, </b>for Euler and Runge-Kutta integration methods. This can be user-modified by initializing the handle in.step to add a new integration function. The default is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>R</mi><mi>K</mi><mn>4</mn>
   </mrow>
  </mstyle>
 </mrow></math>, which is widely applicable. Another good option is<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>M</mi><mi>P</mi>
   </mrow>
  </mstyle>
 </mrow></math>, which uses a midpoint or central-difference technique in the interaction picture.</dd>
<dt class="description_label">rfilter</dt>
<dd class="description_item"> returns a momentum filter for random initial fields generated in momentum space. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>r</mi><mi>f</mi><mi>i</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>r</mi>
   </mrow>
  </mstyle>
 </mrow></math>, sets this to unity.</dd>
<dt class="description_label">nfilter</dt>
<dd class="description_item"> returns a momentum filter for random noises generated in momentum space. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>n</mi><mi>f</mi><mi>i</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>r</mi>
   </mrow>
  </mstyle>
 </mrow></math>, sets this to unity.</dd>
<dt class="description_label">grid</dt>
<dd class="description_item"> calculates the spatial integration grid. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>g</mi><mi>r</mi><mi>i</mi><mi>d</mi>
   </mrow>
  </mstyle>
 </mrow></math>, returns a rectangular grid in ordinary and momentum space.</dd>
<dt class="description_label">prop</dt>
<dd class="description_item"> is the spatial propagation function. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi>
   </mrow>
  </mstyle>
 </mrow></math>, takes a Fourier transform of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mstyle mathvariant='bold'><mi>a</mi></mstyle>
 </mrow></math>, multiplies by propfactor to propagate in time, then takes an inverse Fourier transform. </dd>
<dt class="description_label">randomgen</dt>
<dd class="description_item"> generates the initial random fields. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>m</mi><mi>g</mi><mi>e</mi><mi>n</mi>
   </mrow>
  </mstyle>
 </mrow></math>, returns Gaussian real fields that are delta-correlated in space or momentum space.</dd>
<dt class="description_label">noisegen</dt>
<dd class="description_item"> generates the initial random fields. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>g</mi><mi>e</mi><mi>n</mi>
   </mrow>
  </mstyle>
 </mrow></math>, returns Gaussian real noises that are delta-correlated in time and also in space or momentum space.</dd>
<dt class="description_label">propfactor</dt>
<dd class="description_item"> returns the interaction picture propagation factors. The default, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi>
   </mrow>
  </mstyle>
 </mrow></math>, uses data from the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi>
   </mrow>
  </mstyle>
 </mrow></math> function to calculate this.</dd>
</dl>
<h2 class="section"><a id='magicparlabel-776' /><span class="section_label">5.2</span> Arrays and errors</h2>
<h3 class="subsection"><a id='magicparlabel-777' /><span class="subsection_label">5.2.1</span> Array indexing</h3>
<div class="standard"><a id='magicparlabel-778' />In xSPDE, the space-time dimension <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>d</mi>
 </mrow></math> is unlimited. All data, including fields and average results is stored in arrays of implicit or explicit rank <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>2</mn><mo>+</mo><mi>d</mi>
  </mrow>
 </mrow></math>. The index ordering is always <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>i</mi><mo>,</mo><mi>e</mi><mo>,</mo>
   <mstyle mathvariant='bold'><mi>j</mi>
   </mstyle>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math>. The first is a field index (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>). The second is an ensembles/checks index (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mo>/</mo><mi>c</mi>
  </mrow>
 </mrow></math>). The <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>d</mi>
 </mrow></math> indices <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>,</mo>
   <mi>&hellip;
   </mi>
   <msub>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msub><mo> &equiv; </mo><mstyle mathvariant='bold'><mi>j</mi></mstyle>
  </mrow>
 </mrow></math> are for time and space, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mstyle mathvariant='bold'><mi>j</mi></mstyle>
 </mrow></math> indicates a <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>d</mi>
 </mrow></math>-dimensional index, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mstyle mathvariant='bold'><mi>j</mi></mstyle><mo>'</mo><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mn>1</mn><mo>,</mo>
    <msub>
     <mrow><mi>j</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub><mo>,</mo>
    <mi>&hellip;
    </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math> indicates a <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>d</mi>
 </mrow></math> dimensional index with time index set to one. </div>

<div class="standard"><a id='magicparlabel-779' />When the fields, noises or coordinates are integrated by the xSIM integration functions, the field and data arrays are always flattened to a matrix for reasons of convenience in defining mathematical operations. The first index is the field or line index, and the combined second index covers all the rest. This is not done in externally stored data, nor in xGRAPH, which operates on the full data arrays.</div>

<div class="standard"><a id='magicparlabel-780' />Inside a sequence, data arrays are cell arrays with an additional graph index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math>. This distinguishes the different averages generated for output graphs and data. The following information is not required to use xSPDE, but it helps to give insight to how data is stored, and how to customize and extend the code. There are several different types of arrays used. These are as follows:</div>



<div class="standard" style='text-align: center;'><a id='magicparlabel-781' /><table><tbody><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-812' />Label </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-815' />Indices </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-818' />Description</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-821' /><em>a</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-824' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>i</mi><mo>,</mo><mi>e</mi><mo>,</mo><mstyle mathvariant='bold'><mi>j</mi></mstyle><mo>'</mo>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-827' />Stochastic fields</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-830' /><em>w</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-833' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>i</mi><mo>,</mo><mi>e</mi><mo>,</mo><mstyle mathvariant='bold'><mi>j</mi></mstyle><mo>'</mo>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-836' />Random and noise fields</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-839' /><em>x</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-842' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mn>1</mn><mo>,</mo><mi>e</mi><mo>,</mo><mstyle mathvariant='bold'><mi>j</mi></mstyle><mo>'</mo>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-845' />Space coordinates</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-848' />r</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-851' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{<mi>s</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>f</mi>}<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>i</mi><mo>,</mo><mi>e</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>j</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-854' />Raw data</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-857' />o</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-860' /> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{<mi>n</mi>}<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>o</mi><mo>,</mo><mi>c</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>j</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-863' />Observed average data</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-866' />g</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-869' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{<mi>s</mi>}{<mi>n</mi>}<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>o</mi><mo>,</mo><mi>c</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>j</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-872' />Graph data</div>
</td>
</tr></tbody>
</table>
</div>

<div class="standard"><a id='magicparlabel-873' />In detail, these are as follows:</div>

<ul class="itemize"><a id='magicparlabel-874' /><li class="itemize_item"><b>Field</b> arrays <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>i</mi><mo>,</mo><mi>e</mi><mo>,</mo><mstyle mathvariant='bold'><mi>j</mi></mstyle><mo>'</mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> - these have a field index, an ensemble index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mo>=</mo><mn>1</mn><mo>,</mo>
   <mi>&hellip;
   </mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, one time-point, and a full spatial lattice.</li>
<li class="itemize_item"><b>Random</b> and <b>noise</b> arrays <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>i</mi><mo>,</mo><mi>e</mi><mo>,</mo><mstyle mathvariant='bold'><mi>j</mi></mstyle><mo>'</mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> - these are like field arrays. They are initial random fields or noise fields for the stochastic equations. The first index can have a different range to the field index.</li>
<li class="itemize_item"><b>Coordinate</b> arrays <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1</mn><mo>,</mo><mi>e</mi><mo>,</mo><mstyle mathvariant='bold'><mi>j</mi></mstyle><mo>'</mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> - these arrays are the values of coordinates at grid-points, with labels <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
  </mrow>
 </mrow></math>. Numeric labels <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi>{<mi>l</mi>}
  </mrow>
 </mrow></math> are used with dimensions <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi><mo>&gt;</mo><mn>4</mn>
  </mrow>
 </mrow></math>, depending on the axis number, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>l</mi><mo>=</mo><mn>2</mn><mo>,</mo>
   <mi>&hellip;
   </mi><mi>d</mi>
  </mrow>
 </mrow></math>. The same sizes are used for: 

<ul class="itemize"><a id='magicparlabel-877' /><li class="itemize_item">momentum coordinates <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>k</mi><mi>x</mi><mo>,</mo><mi>k</mi><mi>y</mi><mo>,</mo><mi>k</mi><mi>z</mi>
  </mrow>
 </mrow></math> (alternatively labelled <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>k</mi>{<mn>2</mn>}<mo>,</mo><mi>k</mi>{<mn>3</mn>}<mo>,</mo>
   <mi>&hellip;
   </mi>
  </mrow>
 </mrow></math>) - </li>
<li class="itemize_item">spectral derivative arrays <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>D</mi><mi>x</mi><mo>,</mo><mi>D</mi><mi>y</mi><mo>,</mo><mi>D</mi><mi>z</mi>
  </mrow>
 </mrow></math> (alternatively labelled <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>D</mi>{<mn>2</mn>}<mo>,</mo><mi>D</mi>{<mn>3</mn>}<mo>,</mo>
   <mi>&hellip;
   </mi>
  </mrow>
 </mrow></math>) .</li>
</ul>
</li><li class="itemize_item"><b>Raw</b> arrays <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>r</mi>{<mi>s</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>f</mi>}<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>i</mi><mo>,</mo><mi>e</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>j</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> - like fields, except with all time points stored. These are used optionally, as they take up large amounts of memory. These are saved in cell arrays with indices <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>s</mi>
 </mrow></math> for the sequence, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>c</mi>
 </mrow></math> for the time-step check, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>f</mi>
 </mrow></math> for high-level ensemble index. 

<ul class="itemize"><a id='magicparlabel-880' /><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo>
   <mi>&hellip;
   </mi><mi>S</mi>
  </mrow>
 </mrow></math> for the sequence number, </li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn>
  </mrow>
 </mrow></math> for the error-checking time-step used, first coarse then fine, </li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo>=</mo><mn>1</mn><mo>,</mo>
   <mi>&hellip;
   </mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>*</mo><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>3</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for a high level combined parallel and serial ensemble index.</li>
</ul>
</li><li class="itemize_item"><b>Data</b> arrays <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi>{<mi>n</mi>}<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>o</mi><mo>,</mo><mi>c</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>j</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> - these store the generated average data at all time points, with an error-check index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn>
  </mrow>
 </mrow></math>. Check indices are <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> for the estimated average, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mo>=</mo><mn>2</mn>
  </mrow>
 </mrow></math> for the estimated time-step error, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mo>=</mo><mn>3</mn>
  </mrow>
 </mrow></math> for the estimated statistical error or standard deviation. Note that the cell index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> is the graph index, and the first array index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>o</mi>
 </mrow></math> is a user-generated graphics output index, which may not correspond to a field index.</li>
<li class="itemize_item"><b>Graphics</b> arrays <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>g</mi>{<mi>s</mi>}{<mi>n</mi>}<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>o</mi><mo>,</mo><mi>c</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>j</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> - these store the complete sequence of data that is plotted, and may have further functional transformations when processed in <b>xgraph</b>, if required.</li>
</ul>
<div class="standard"><a id='magicparlabel-885' />There may be quite different first dimensions between fields, noises and output data, and they are specified using different input parameters. The output line index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>o</mi>
 </mrow></math> in a graphics or data array describes different lines on a graph. Similarly, the local ensemble index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>e</mi>
 </mrow></math> in a field array has a different range to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>c</mi>
 </mrow></math>, the check index, in a data array.</div>

<div class="standard"><a id='magicparlabel-886' />Graphics cell data has high-level cell indices <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{<mi>s</mi>}
  </mrow>
 </mrow></math> for the sequence index, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{<mi>n</mi>}
  </mrow>
 </mrow></math> for the graph or function index, which corresponds to the index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{<mi>n</mi>}
  </mrow>
 </mrow></math> of the observe function used to generate averages. One can have several data arrays to make a number of distinct output graphs labelled <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math>, each with multiple averages. These are then combined into a sequence, each with different graphs, and therefore need more indices. </div>
<h3 class="subsection"><a id='magicparlabel-887' /><span class="subsection_label">5.2.2</span> Step-size errors</h3>
<div class="standard"><a id='magicparlabel-888' />Errors caused by the finite time-domain step-size, as well as those caused by the finite ensemble, are checked automatically. Those caused by the spatial lattice are not checked in the xSIM code. They must be checked by manually, by comparing results with different transverse lattice ranges and step-size.</div>

<div class="standard"><a id='magicparlabel-889' />Errors due to a finite step-size are estimated by comparing two simulations with different step-sizes and the same random sequence, to make sure the final results are accurate. The final 2D output graphs will have error-bars if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mi>h</mi><mi>e</mi><mi>c</mi><mi>k</mi><mi>s</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> was specified, which is also the default parameter setting. Error-bars below a minimum relative size compared to the vertical range of the plot, specified by the graphics variable <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>b</mi><mi>a</mi><mi>r</mi>
  </mrow>
 </mrow></math>, are not plotted. </div>

<div class="standard"><a id='magicparlabel-890' />There is a clear strategy if the errors are too large. Either increase the <em>points</em>, which gives more plotted points and lower errors, or increase the <em>steps, </em>which reduces the step size without changing the graphical resolution. The default algorithm and extrapolation order can also be changed, please read the full xSPDE manual when doing this. Error bars on the graphs can be removed by setting <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mi>h</mi><mi>e</mi><mi>c</mi><mi>k</mi><mi>s</mi><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math> or increasing <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>b</mi><mi>a</mi><mi>r</mi>
  </mrow>
 </mrow></math> in final graphs.</div>
<h3 class="subsection"><a id='magicparlabel-891' /><span class="subsection_label">5.2.3</span> Sampling errors</h3>
<div class="standard"><a id='magicparlabel-892' />Sampling error estimation in xSIM uses sub-ensemble averaging. This generally leads to more reliable sampling error estimates, and makes efficient use of the vector instruction sets that are used by Matlab. Ensembles are specified in three levels. The first, <em>ensemble(1)</em>, is called the number of samples for brevity. All computed quantities returned by the <b>observe</b> functions are first averaged over the samples, which are calculated efficiently using a parallel vector of trajectories. By the central limit theorem, these low-level sample averages are distributed as a normal distribution at large sample number.</div>

<div class="standard"><a id='magicparlabel-893' />Next, the sample averages are averaged <b>again</b> over the two higher level ensembles, if specified. This time, the variance is accumulated. The variance of these distributions is used to estimate a standard deviation in the mean, since each computed quantity is now a normally distributed result. This method is applied to all the <em>graphs </em>observables. The two lines generated represent <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>o</mi>
    </mrow><mo stretchy="true">&OverBar;</mo>
   </mover><mo> &plusmn; </mo><mi> &sigma; </mi>
  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>o</mi>
 </mrow></math> is the observe function output, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &sigma; </mi>
 </mrow></math> is the standard deviation in the mean.</div>

<div class="standard"><a id='magicparlabel-894' />The highest level ensemble, <em>ensemble(3), </em>is used for parallel simulations. This requires the Matlab parallel toolbox. Either type of high-level ensemble, or both together, can be used to calculate sampling errors.</div>

<div class="standard"><a id='magicparlabel-895' />Note that one standard deviation is not a strong bound; errors are expected to exceed this value in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>32</mn>%
  </mrow>
 </mrow></math> of observed measurements. Another point to remember is that stochastic errors are often correlated, so that a group of points may all have similar errors due to statistical sampling.</div>

<div class="standard"><a id='magicparlabel-896' />If <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>&gt;</mo><mn>1</mn>
  </mrow>
 </mrow></math> or <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>3</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>&gt;</mo><mn>1</mn>
  </mrow>
 </mrow></math>, which allows xSPDE to calculate sampling errors, it will plot upper and lower limits of one standard deviation. If the sampling errors are too large, try increasing <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>1</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math><em>, </em>which increases the trajectories in a single thread. An alternative is to increase <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>2</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. This is slower, but is only limited by the compute time, or else to increase <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>e</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>3</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, which gives higher level parallelization. Each is limited in different ways; the first by memory, and the second by time, the third by the number of available cores. Sampling error control helps ensures accuracy.</div>
<h2 class="section"><a id='magicparlabel-897' /><span class="section_label">5.3</span> Graphics function, <em>xgraph</em></h2>
<div class="standard"><a id='magicparlabel-898' />The main functions involved for graphics are: </div>

<dl class='description'><a id='magicparlabel-899' /><dt class="description_label">xgraph</dt>
<dd class="description_item"> is called by xSPDE when the ensemble loops finished. The results are graphed and output if required. </dd>
</dl>
<h3 class="subsection"><a id='magicparlabel-900' /><span class="subsection_label">5.3.1</span> xGRAPH inputs</h3>
<div class="standard"><a id='magicparlabel-901' />The input to xGRAPH can either come from a file, or it can be from data generated directly with xSIM. The data is a cell array, where each member of the cell array is a numerical graphics array, defining one independent set of averaged data. the observed data averages, stored in a cell array of size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi>{<mi>n</mi>}<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>o</mi><mo>,</mo><mi>c</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>j</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </div>
<h3 class="subsection"><a id='magicparlabel-902' /><span class="subsection_label">5.3.2</span> User definable graphics functions</h3>
<div class="standard"><a id='magicparlabel-903' />It is possible to simply run <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>x</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>p</mi><mi>h</mi>
   </mrow>
  </mstyle>
 </mrow></math> as is, without much intervention. However, there are many customization options, including two user defined functions which have useful applications. These are as follows:</div>

<dl class='description'><a id='magicparlabel-904' /><dt class="description_label">*gfunction(d,r)</dt>
<dd class="description_item"> is is a cell array of functions whose output is plotted. There is one graphics function for each multidimensional dataset that is plotted. The default value is just the average stored in the data array generated by the simulation observe function. 
<br />


<br />

An arbitrary number of functions of these observables can also be plotted, including vector observables. The input to graphics functions is the observed data averages or functions of averages, stored in a cell array of size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi>{<mi>n</mi>}<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>o</mi><mo>,</mo><mi>c</mi><mo>,</mo>
    <mstyle mathvariant='bold'><mi>j</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </dd>
<dt class="description_label">*compare(r)</dt>
<dd class="description_item"> is a cell array of functions used to obtain comparison results. These are calculated from the user-specified <b>in.compare</b> handle, giving a dashed line on the generated time-domain graphs, and an error summary which is printed. </dd>
</dl>
<div class="standard"><a id='magicparlabel-906' />The results from the two graphics functions plotted using the <b>xgraph</b> routines. </div>
<h3 class="subsection"><a id='magicparlabel-907' /><span class="subsection_label">5.3.3</span> xGRAPH outputs</h3>
<div class="standard"><a id='magicparlabel-908' />This routine is prewritten to cover a range of useful graphs, but can be modified to suit the user. </div>

<div class="standard"><a id='magicparlabel-909' />The code will cascade down from higher to lower dimensions, generating different types of user-defined graphs. Each type of graph is generated once for each specified graphics function. The graphics axes that are used for plotting, and the points plotted, are defined using the optional <em><b>axes </b></em>input parameters, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi>{<mi>n</mi>}
  </mrow>
 </mrow></math> indicates the n-th specified graphics function or set of generated graphical data.</div>

<div class="standard"><a id='magicparlabel-910' />If there are no <em><b>axes </b></em>inputs, or the inputs are zero - for example, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi>{<mn>1</mn>}<mo>=</mo>{<mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn>}
  </mrow>
 </mrow></math> - only the lowest dimensions are plotted, up to 3. If the <em><b>axes </b></em>inputs project out a single point in a given dimension, - for example, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi>{<mn>1</mn>}<mo>=</mo>{<mn>0</mn><mo>,</mo><mn>31</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>0</mn>}
  </mrow>
 </mrow></math>, these axes are suppressed in the plots. This reduces the effective dimension of the data - in this case to two dimensions. </div>

<div class="standard"><a id='magicparlabel-911' />Examples:</div>

<ul class="itemize"><a id='magicparlabel-912' /><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi>{<mn>1</mn>}<mo>=</mo>{<mn>0</mn>}
  </mrow>
 </mrow></math> - For function 1, plot all the time points; higher dimensions get defaults.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi>{<mn>2</mn>}<mo>=</mo>{<mo>-</mo><mn>1</mn><mo>,</mo><mn>0</mn>}
  </mrow>
 </mrow></math> - For function 2, plot the maximum time (the default), and all x-points.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi>{<mn>3</mn>}<mo>=</mo>{<mn>1</mn><mo>:</mo><mn>4</mn><mo>:</mo><mn>51</mn><mo>,</mo><mn>32</mn><mo>,</mo><mn>64</mn>}
  </mrow>
 </mrow></math> - For function 3, plot every 4-th time point at x point 32, y point 64</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi>{<mn>4</mn>}<mo>=</mo>{<mn>0</mn><mo>,</mo><mn>1</mn><mo>:</mo><mn>4</mn><mo>:</mo><mn>51</mn><mo>,</mo><mn>0</mn>}
  </mrow>
 </mrow></math> - For function 4, plot every time point, every 4-th x point, and al the y-points.</li>
</ul>
<div class="standard"><a id='magicparlabel-916' />Note that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>-</mo><mn>1</mn>
  </mrow>
 </mrow></math> indicates a default `typical' point, which is the last point on the time axis, and the midpoint on the other axes. </div>

<div class="standard"><a id='magicparlabel-917' />The <em>pdimension</em> input can also be used to reduce dimensionality, as this sets the maximum effective plotted dimension. For example, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>p</mi><mi>d</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi>{<mn>1</mn>}<mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> means that only plots vs time are output for the first function plotted. Note that in the following, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
  </mrow>
 </mrow></math> may be replaced by corresponding higher dimensions if there are axes that are suppressed. Slices can be taken at any desired point, not just the midpoint. Using the standard notation of, for example, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi>{<mn>1</mn>}<mo>=</mo>{<mn>6</mn><mo>:</mo><mn>3</mn><mo>:</mo><mn>81</mn>}
  </mrow>
 </mrow></math>, can be used to modify the starting, interval, and finishing points for complete control on the plot points.</div>

<div class="standard"><a id='magicparlabel-918' />The graphics results depend on the resulting <b>effective</b> dimension. Since the plot has to include a data axis, the plot will be typically one dimension higher than the underlying space-time lattice: </div>

<dl class='description'><a id='magicparlabel-919' /><dt class="description_label">dimension=4..</dt>
<dd class="description_item"> For higher lattice dimensions, only a slice through the chosen point, or the default midpoint, is available, reducing the lattice dimension to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>3</mn>
 </mrow></math>. </dd>
<dt class="description_label">dimension=3</dt>
<dd class="description_item"> For three lattice dimensions, if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>m</mi><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi><mo>&gt;</mo><mn>1</mn>
  </mrow>
 </mrow></math>, a movie of distinct 3D graphic images of observable<em> vs x,y</em> are plotted as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>m</mi><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi>
  </mrow>
 </mrow></math> slices - usually in time. Otherwise, only a slice through the chosen point, or the default midpoint, is available for the highest dimension, reducing the lattice dimension to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>2</mn>
 </mrow></math>. </dd>
<dt class="description_label">dimension=2</dt>
<dd class="description_item"> For two lattice dimensions, one 3D image of observable<em> vs x,t</em> is plotted. A movie of distinct 2D graphic plots is also possible. Otherwise, only a slice through <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math> is available, reducing the lattice dimension to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math>. </dd>
<dt class="description_label">dimension=1</dt>
<dd class="description_item"> For one lattice dimension, a 2D plot of observable<em> vs t</em> is plotted, with data at each lattice point in time. Exact results, error bars and sampling error bounds are included if available. </dd>
</dl>
<div class="standard"><a id='magicparlabel-923' />In addition to time-dependent graphs, the <b>xgraph</b> function can generate <em>images </em>(3D)<em> </em>and <em>transverse</em> (2D) plots at specified points in time, up to a maximum given by the number of time points specified. The number of these can be individually specified for each graphics output. The images available are specified in <em>imagetype</em>: 3D perspective plots, grey-scale colour plots and contour plots.</div>

<div class="standard"><a id='magicparlabel-924' />Note that error bars, sampling errors and multiple lines are only graphed for 2D plots, typically of results vs time. The error-bars are not plotted when they are below a user-specified size, to improve graphics quality. Higher dimensional graphs do not include this data, for visibility reasons, but they are still recorded in the data files. </div>
<h2 class="section"><a id='magicparlabel-925' /><span class="section_label">5.4</span> Object architecture</h2>
<h3 class="subsection"><a id='magicparlabel-926' /><span class="subsection_label">5.4.1</span> xSPDE data objects</h3>
<div class="standard"><a id='magicparlabel-927' />The xSPDE data objects include parameters and methods, but with a very open type of object-oriented architecture to allow extensibility. All xSPDE functions are modular and easily replaceable. In many cases this is as easy as just defining a new function handle to replace the default value. To define your own integration function, include in the xSPDE input the line:
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-928' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-932' /><span style='font-family:monospace;'>in.step=@Mystep;</span></div>
</div></div>

<div class="standard"><a id='magicparlabel-933' />Next, include anywhere on your Matlab path the function definition, for example:
<br />

</div>

<div class="standard" style='text-align: center;'><a id='magicparlabel-934' /><div class='Doublebox'><div class="plain_layout"><a id='magicparlabel-938' /><span style='font-family:monospace;'>function a = Mystep(a,w,r) </span></div>

<div class="plain_layout"><a id='magicparlabel-939' /><span style='font-family:monospace;'>% a = Mystep(a,w,r) propagates a step my way. </span></div>

<div class="plain_layout"><a id='magicparlabel-940' /><span style='font-family:monospace;'>..</span></div>

<div class="plain_layout"><a id='magicparlabel-941' /><span style='font-family:monospace;'>a = ...; </span></div>

<div class="plain_layout"><a id='magicparlabel-942' /><span style='font-family:monospace;'>end </span></div>
</div></div>
<h3 class="subsection"><a id='magicparlabel-943' /><span class="subsection_label">5.4.2</span> xSPDE hints</h3>

<ul class="itemize"><a id='magicparlabel-944' /><li class="itemize_item">When using xSPDE, it is a good idea to run the batch test script, Batchtest.m. </li>
<li class="itemize_item">Batchtest.m tests your parallel toolbox installation. If you have no license for this, omit the third ensemble setting.</li>
<li class="itemize_item">To create a project file, it is often easiest to start with an existing project function with a similar equation: see Examples folder.</li>
<li class="itemize_item">Graphics parameters can also be included in the structure <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='bold'>
   <mrow><mi>i</mi><mi>n</mi>
   </mrow>
  </mstyle>
 </mrow></math>, to modify graphs.</li>
<li class="itemize_item">Comparison functions can be included if you want to compare with analytic results.</li>
<li class="itemize_item">A full list of functionality is listed next.</li>
</ul>
<h1 class="chapter"><a id='magicparlabel-950' /><span class="chapter_label">6</span> xSPDE metadata<a id="chap_Table_of_xSPDE" />
 </h1>
<div class="standard"><a id='magicparlabel-951' />The input data, which we label <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi>
  </mrow>
 </mrow></math>, is a sequence of data structures that we label <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi>
  </mrow>
 </mrow></math>. All of the input data is later passed to the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>p</mi><mi>h</mi>
  </mrow>
 </mrow></math> function. The input data can be numbers, vectors, strings, functions and cell arrays, which just lists of data enclosed in curly brackets, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{}
  </mrow>
 </mrow></math>. All xSPDE metadata has preferred values, so only changes from the preferences need to be input. The resulting combined input including preferred values, is stored internally as a sequence of structures in a cell array to describe the simulation sequence.</div>

<div class="standard"><a id='magicparlabel-952' />Simulation metadata, including all preferred default values that were used in a particular simulation, is also stored in the xSPDE output files. This is done in both the Matlab <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>.</mn><mi>m</mi><mi>a</mi><mi>t</mi>
  </mrow>
 </mrow></math> and the HDF5 <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>.</mn><mi>h</mi><mn>5</mn>
  </mrow>
 </mrow></math> output files, so the entire simulation can be easily reconstructed or changed. Note that in the current version of xSPDE, one must use a Matlab formatted <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>.</mn><mi>m</mi><mi>a</mi><mi>t</mi>
  </mrow>
 </mrow></math> file to store raw data which includes all stochastic trajectories. Either the Matlab or the HDF5 files can be used to store both input and averaged output data.</div>

<div class="standard"><a id='magicparlabel-953' />Some conventions are used to simplify inputs, as follows: </div>

<ul class="itemize"><a id='magicparlabel-954' /><li class="itemize_item"><b>All input data has default values</b></li>
<li class="itemize_item"><b>Vector inputs of numbers are enclosed in square brackets, [...]. </b></li>
<li class="itemize_item"><b>Where multiple inputs of strings, functions or vectors are needed they should be enclosed in curly brackets, {...}, to create a cell array. </b></li>
<li class="itemize_item"><b>Vector or cell array inputs with only one member don't require brackets. </b></li>
<li class="itemize_item"><b>Incomplete or partial vector or cell array inputs are filled in with the last applicable default value. </b></li>
<li class="itemize_item"><b>New function definitions can be handles pointing elsewhere.</b></li>
</ul>
<h2 class="section"><a id='magicparlabel-960' /><span class="section_label">6.1</span> Simulation data</h2>
<div class="standard"><a id='magicparlabel-961' />The simulation data of the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi>
  </mrow>
 </mrow></math> structure is passed to the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mi>s</mi><mi>i</mi><mi>m</mi>
  </mrow>
 </mrow></math> program, to define the simulation details. User application constants can be included, but must not be reserved names. However, names starting with '<em>in.c</em>' or any capital letter like '<em>in.</em>A...' are always available to users of xSPDE. Note that use of globals is <b>not</b> recommended, as it is incompatible with the Matlab parallel toolbox. </div>
<h3 class="subsection"><a id='magicparlabel-962' /><span class="subsection_label">6.1.1</span> Simulation parameters</h3>
<div class="standard"><a id='magicparlabel-963' />All simulation data has default values as distributed, which are also user-modifiable through the<em> xpreferences</em> function. Any defaults can be checked by typing <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi><mn>.</mn><mi>p</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>t</mi><mo>=</mo><mn>2</mn>
  </mrow>
 </mrow></math>, then running <em>xsim(in)</em> or <em>xspde(in).</em> 
<br />

</div>



<div class="standard"><a id='magicparlabel-964' /><table><tbody><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1058' />Label </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1061' />Default value </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1064' />Description</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1067' /><em>version</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1070' /><em>'xSIM2.2'</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1073' />Current version number</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1076' /><em>name</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1079' /><em>''</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1082' />Simulation name</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1085' /><em>dimension</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1088' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1091' />Space-time dimension</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1094' /><em>fields</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1097' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

  <mrow><mn>1</mn><mo>,</mo><mn>0</mn>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1100' />Number of stochastic or auxiliary fields</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1103' /><em>ranges</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1106' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>10</mn>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1109' />Range of coordinates in [t,x,y,z,..]</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1112' /><em>origin</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1115' />0 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1118' />Origin of coordinates in [t,x,y,z,..]</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1121' /><em>points</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1124' />51 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1127' />Output lattice points in [t,x,y,z,..]</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1130' /><em>noises</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1133' /><em>[1 0]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1136' />Number of noise fields in [x,k]</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1139' /><em>randoms</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1142' /><em>[1 0]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1145' />Initial random fields in [x,k]</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1148' /><em>ensembles</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1151' /><em>[1 1 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1154' />Ensembles used for averaging</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1157' /><em>steps</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1160' /><em>1</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1163' />Integration steps per output point</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1166' /><em>iterations</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1169' /><em>4</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1172' />Maximum iterations</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1175' /><em>order</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1178' /><em>1</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1181' />Extrapolation order </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1184' /><em>checks</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1187' /><em>1</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1190' />Check time-step errors?</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1193' /><em>seed</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1196' /><em>0</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1199' />Seed for random number generator</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1202' /><em>file</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1205' /><em>''</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1208' />File-name: <em>'f.mat' </em>= Matlab<em>, 'f.h5' </em>= HDF5 </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1211' /><em>boundaries</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1214' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

  <mrow><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo>
   <mi>&hellip;
   </mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1217' />Boundary: '0,1,2'=periodic,Neum.,Dirich.</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1220' /><em>ipsteps</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1223' /><em>2</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1226' />IP transforms per time-step</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1229' /><em>graphs</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1232' /><em>1</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1235' />Maximum number of graphs</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1238' /><em>print</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1241' />1 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1244' />Print: 1 for medium, 2 for high output</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1247' />c </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1250' />- </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1253' />User specified static parameters</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1256' /><em>olabels</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1259' /><em>{'a_1',..}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1262' />Observable labels</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1265' /><em>averages</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1268' />1</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1271' />Maximum number of observables</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1274' /><em>transforms</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1277' /><em> {[0 0 0 0],..}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1280' />Fourier transforms in [t,x,y,z,..]</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1283' /><em>raw</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1286' />0 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1289' />Raw data switch: 1 for raw output</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1292' /><em>numberaxis</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1295' />0 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1298' />Numbered axis switch: 1 for numbered</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1301' /><em>octave</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1304' /><em>0</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1307' />Force octave syntax: 1 for octave</div>
</td>
</tr></tbody>
</table>
</div>
<h3 class="subsection"><a id='magicparlabel-1308' /><span class="subsection_label">6.1.2</span> Common functions</h3>
<div class="standard"><a id='magicparlabel-1309' />The most common functions, output field dimensions and calling arguments, with user-definable functions marked using an asterisk, are:
<br />

</div>



<div class="standard"><a id='magicparlabel-1310' /><table><tbody><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1386' />Label </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1389' />Arguments </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1392' />Purpose</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1395' /><em>*da</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1398' /><em>(a,z,r)</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1401' />Stochastic derivative</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1404' /><em>*initial</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1407' /><em>(v,r)</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1410' />Function to initialize fields</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1413' /><em>*linear</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1416' />(r)</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1419' />Linear derivative function</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1422' /><em>*rfilter</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1425' /><em> </em>(r)</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1428' />Random input filter in k-space</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1431' /><em>*nfilter</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1434' />(r)</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1437' />Noise filter function in k-space</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1440' /><em>*transfer</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1443' /><em>(v,r,a0,r0)</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1446' />Initialization in a sequence</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1449' /><em>*step</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1452' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>d</mi><mi>t</mi><mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1455' />Calculation of a time-step</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1458' /><em>*grid</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1461' /><em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>r</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1464' />Grid calculator for lattice</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1467' /><em>*prop</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1470' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1473' />Interaction picture propagator </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1476' /><em>*propfactor</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1479' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>n</mi><mi>c</mi><mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1482' />Propagator array calculation</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1485' /><em>*observe</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1488' /><em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1491' />Observable function cell array</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1494' /><em>*function</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1497' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mrow><mo>@</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>a</mi><mi>v</mi><mo>,</mo><mspace width="10px" />
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>a</mi><mi>v</mi>
    <mrow><mn>1</mn>
    </mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo>:</mo><mo>,</mo><mo>:</mo><mo>,</mo><mo>:</mo>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    <msup>
     <mrow><mn>.</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>,</mo><mn>..</mn>
   </mrow>
  </mrow>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1500' />Functions stored of averages</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1503' /><em>*compare</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1506' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>t</mi><mo>,</mo><mi>i</mi><mi>n</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1509' />Comparison function cell array</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1512' /><em>*define</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1515' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1518' />Defines an auxiliary field</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1521' /><em>randomgen</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1524' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>r</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1527' />Initial random generator</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1530' /><em>noisegen</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1533' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>r</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1536' />Noise generator</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1539' /><em>xint</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1542' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mi>d</mi><mi>x</mi><mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1545' />Integrates over a spatial lattice</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1548' /><em>xave</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1551' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mi>a</mi><mi>v</mi><mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1554' />Averages over a spatial lattice</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1557' /><em>xd</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1560' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mi>D</mi><mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1563' />Spectral spatial derivative</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1566' /><em>xd1</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1569' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>d</mi><mi>i</mi><mi>r</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1572' />1st derivative, finite diff.</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1575' /><em>xd2</em></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1578' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>a</mi><mo>,</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>d</mi><mi>i</mi><mi>r</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mi>r</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1581' />2nd derivative, finite diff.</div>
</td>
</tr></tbody>
</table>
</div>
<h2 class="section"><a id='magicparlabel-1582' /><span class="section_label">6.2</span> Internal data</h2>
<div class="standard"><a id='magicparlabel-1583' />Internally, xSPDE data is stored in a cell array, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>t</mi>
  </mrow>
 </mrow></math>, of the structures called <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>r</mi>
 </mrow></math> passed to functions. This includes the data given above from the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi>
  </mrow>
 </mrow></math> structures. In addition, it includes the computed parameters given below, which includes various internal array dimensions. The stochastic variable arrays like <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>v</mi>
  </mrow>
 </mrow></math> are internally flattened to become two-dimensional matrices where possible, to reduce dimensionality and simplify parallel operations. </div>

<div class="standard"><a id='magicparlabel-1584' />For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi><mo>&gt;</mo><mn>4</mn>
  </mrow>
 </mrow></math> total dimensions, the spatial grid, momentum grid and derivative grid notation of <em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &omega; </mi><mo>,</mo><mi>k</mi><mi>x</mi><mo>,</mo><mi>k</mi><mi>y</mi><mo>,</mo><mi>k</mi><mi>z</mi>
  </mrow>
 </mrow></math></em> and <em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>r</mi><mn>.</mn><mi>D</mi><mi>x</mi><mo>,</mo><mi>r</mi><mn>.</mn><mi>D</mi><mi>y</mi><mo>,</mo><mi>r</mi><mn>.</mn><mi>D</mi><mi>z</mi>
  </mrow>
 </mrow></math></em> is changed to use numerical labels that correspond to the dimension numbers, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi>{<mn>1</mn>}<mo>,</mo>
   <mi>&hellip;
   </mi><mi>x</mi>{<mi>d</mi>}
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>k</mi>{<mn>1</mn>}<mo>,</mo>
   <mi>&hellip;
   </mi><mi>k</mi>{<mi>d</mi>}
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>D</mi>{<mn>2</mn>}<mo>,</mo>
   <mi>&hellip;
   </mi><mi>D</mi>{<mi>d</mi>}
  </mrow>
 </mrow></math>. These are simpler to handle with large numbers of space dimensions. This numeric labeling preference can be used even if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>d</mi><mo>&lt;</mo><mn>5</mn>
  </mrow>
 </mrow></math>, by setting the input switch <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>x</mi><mi>i</mi><mi>s</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>. The graph labels will use this notation also, unless specified otherwise.
<br />

</div>



<div class="standard"><a id='magicparlabel-1585' /><table><tbody><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1740' />Label </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1743' />Type </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1746' />Typical value </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1749' />Description</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1752' />t </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1755' />real</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1758' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>5</mn>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1761' />Current value of time, t</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1764' />w </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1767' />real</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1770' /><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>0.6</mn>
 </mrow></math></div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1773' />Frequency passed to in.observe : <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &omega; </mi>
 </mrow></math></div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1776' /><em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
  </mrow>
 </mrow></math></em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1779' />array </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1782' /><em>-</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1785' />Space grid of<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
  </mrow>
 </mrow></math></div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1788' /><em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>k</mi><mi>x</mi><mo>,</mo><mi>k</mi><mi>y</mi><mo>,</mo><mi>k</mi><mi>z</mi>
  </mrow>
 </mrow></math></em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1791' />array </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1794' /><em>-</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1797' />Momentum grid of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>y</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>z</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math></div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1800' /><em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>D</mi><mi>x</mi><mo>,</mo><mi>D</mi><mi>y</mi><mo>,</mo><mi>D</mi><mi>z</mi>
  </mrow>
 </mrow></math></em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1803' />array </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1806' /><em>-</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1809' />Derivative grid of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>D</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi>D</mi>
    </mrow>
    <mrow><mi>y</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi>D</mi>
    </mrow>
    <mrow><mi>z</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math></div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1812' /><em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi>{<mn>1</mn>}<mo>,</mo>
   <mi>&hellip;
   </mi><mi>x</mi>{<mi>d</mi>}
  </mrow>
 </mrow></math></em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1815' />array </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1818' /><em>-</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1821' />Space grid of<em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>x</mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>,</mo>
   <mi>&hellip;
   </mi>
   <msub>
    <mrow><mi>x</mi>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math></em> </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1824' /><em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>k</mi>{<mn>1</mn>}<mo>,</mo>
   <mi>&hellip;
   </mi><mi>k</mi>{<mi>d</mi>}
  </mrow>
 </mrow></math></em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1827' />array </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1830' /><em>-</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1833' />Momentum grid of<em> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>,</mo>
   <mi>&hellip;
   </mi>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math></em> </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1836' /><em><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>D</mi>{<mn>2</mn>}<mo>,</mo>
   <mi>&hellip;
   </mi><mi>D</mi>{<mi>d</mi>}
  </mrow>
 </mrow></math></em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1839' />array </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1842' /><em>-</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1845' />Derivative grid of<em> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>D</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub><mo>,</mo>
   <mi>&hellip;
   </mi>
   <msub>
    <mrow><mi>D</mi>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math></em> </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1848' /><em>dx</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1851' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1854' /><em>0.2</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1857' />Steps in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

  <mrow><mi>t</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

 </mrow></math></div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1860' /><em>dk</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1863' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1866' /><em>0.6160</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1869' />Steps in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

  <mrow><mi> &omega; </mi><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>y</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>z</mi>
    </mrow>
   </msub>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

 </mrow></math></div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1872' /><em>dt</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1875' />double </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1878' /><em>0.2000</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1881' />Output time-step</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1884' /><em>dtr</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1887' />double </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1890' /><em>0.1000</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1893' />Reduced, internal time-step</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1896' /><em>V</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1899' />real </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1902' /><em>1</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1905' />Spatial lattice volume</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1908' /><em>K</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1911' />real </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1914' /><em>1</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1917' />Momentum lattice volume</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1920' /><em>dV</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1923' />real </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1926' /><em>1</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1929' />Spatial cell volume</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1932' /><em>dK</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1935' />real </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1938' /><em>1</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1941' />Momentum cell volume</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1944' /><em>xc</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1947' />vector cells </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1950' /><em>{[0,... 10]}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1953' />Space-time coordinate axes in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

  <mrow><mi>t</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

 </mrow></math></div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1956' /><em>kc</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1959' />vector cells </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1962' /><em>{[0,..15,-15...]}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1965' />Computational axes in<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

  <mrow><mi> &omega; </mi><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>x</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>y</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>z</mi>
    </mrow>
   </msub>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

 </mrow></math></div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1968' /><em>s.dx</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1971' />double </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1974' />1 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1977' />Initial stochastic normalization</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1980' /><em>s.dxt</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1983' />double </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1986' /><em>3.1623</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1989' />Propagating stochastic normalization</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1992' /><em>s.dk</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1995' />double </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-1998' />1 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2001' />Initial k stochastic normalization</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2004' /><em>s.dkt</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2007' />double </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2010' /><em>3.1623</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2013' />Propagating k stochastic normalization</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2016' /><em>nspace</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2019' />integer </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2022' />35 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2025' />Number of spatial lattice points</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2028' /><em>nlattice</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2031' />integer </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2034' />3500 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2037' />Total lattice: ensembles(1) x n.space </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2040' /><em>ncopies</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2043' />integer </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2046' />20 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2049' />ensembles(2) x ensembles(3)</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2052' /><em>randoms</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2055' />integer </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2058' />2 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2061' />Number of initial random fields</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2064' /><em>noises</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2067' />integer </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2070' />2 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2073' />Number of noise fields</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2076' /><em>d.int</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2079' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2082' /><em>[1 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2085' />Dimensions for lattice integration</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2088' /><em>d.a</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2091' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2094' /><em>[1 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2097' />Dimensions for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>a</mi>
 </mrow></math> field (flattened)</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2100' /><em>d.r</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2103' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2106' /><em> [1 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2109' />Dimensions for coordinates (flattened)</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2112' /><em>d.ft</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2115' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2118' /><em>[1 1 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2121' />Dimensions for field transforms</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2124' /><em>d.k</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2127' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2130' /><em>[0 1 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2133' />Dimensions for noise transforms</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2136' /><em>d.obs</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2139' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2142' /><em>[1 1 1 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2145' />Dimensions for observations</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2148' /><em>d.data</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2151' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2154' /><em>[1 3 51 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2157' />Dimensions for average data (flattened)</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2160' /><em>d.raw</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2163' />vector </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2166' /><em>[1 1 51 1]</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2169' />Dimensions for raw data (flattened)</div>
</td>
</tr></tbody>
</table>
</div>
<h2 class="section"><a id='magicparlabel-2170' /><span class="section_label">6.3</span> Graphics data</h2>
<div class="standard"><a id='magicparlabel-2171' />The simulation data of the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mi>n</mi>
  </mrow>
 </mrow></math> structure is also passed to the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>p</mi><mi>h</mi>
  </mrow>
 </mrow></math> program, along with optional graphics parameters for each observable, to create an extended graphics data structure. </div>

<div class="standard"><a id='magicparlabel-2172' />These are all cell arrays when there is more than one type of graph or observable, so that the graphics parameters can be individually set for each output that is plotted, using the cell index <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{<mi>n</mi>}
  </mrow>
 </mrow></math> in a curly bracket. The axis labels, axis points and axis transformations of each graph are also cell arrays, as there can be any number of axes: so these are all nested cell arrays. If only a single input is specified, the cell index is automatically supplied. Graphics defaults are also user-modifiable by editing the<em> xgpreferences</em> function. </div>

<div class="standard"><a id='magicparlabel-2173' />The plotted result can be an arbitrary function of the generated average data, by using the optional input<em> gfunctions. </em>If this is omitted, the<em> </em>generated average data from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mi>s</mi><mi>i</mi><mi>m</mi>
  </mrow>
 </mrow></math> is plotted.
<br />

</div>



<div class="standard"><a id='magicparlabel-2174' /><table><tbody><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2232' />Label </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2235' />Default value </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2238' />Description</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2241' /><em>gversion</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2244' /><em>'xGRAPH2.0'</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2247' />Current version number </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2250' /><em>xlabels</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2253' /><em> {'t' 'x' 'y' 'z'...}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2256' />Generic axis labels</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2259' /><em>klabels</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2262' /><em> {'\omega' 'k_x' 'k_y' 'k_z'...}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2265' />Transformed axis labels</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2268' /><em>minbar{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2271' /><em>0.01</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2274' />Minimum relative error-bar </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2277' /><em>*gfunction{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2280' />@(d,~)&nbsp;d{n} </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2283' />Functions plotted of averages</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2286' /><em>font{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2289' />18 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2292' />Font size for graph labels</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2295' /><em>headers{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2298' />'' </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2301' />Graph headers</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2304' /><em>images{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2307' />0 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2310' />Number of movie images </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2313' /><em>imagetype{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2316' />0 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2319' />Type of movie images </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2322' /><em>transverse{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2325' />0 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2328' />Number of transverse plots </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2331' /><em>pdimension{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2334' />3 </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2337' />Maximum plot dimensions </div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2340' /><em>*compare{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2343' />-</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2346' />Comparison functions</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2349' /><em>*xfunctions{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2352' />-</div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2355' />Axis transformations</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2358' /><em>axes{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2361' />{0,..} </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2364' />Points plotted for each axis</div>
</td>
</tr><tr><td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2367' /><em>glabels{n}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2370' /><em> {'t' 'x' 'y' 'z'}</em> </div>
</td>
<td align='center' valign='top'>
<div class="plain_layout"><a id='magicparlabel-2373' />Graph-specific axis labels</div>
</td>
</tr></tbody>
</table>
</div>
<h2 class='bibliography'>Bibliography</h2>

<div class='bibliography'><div class="bibliography"><a id='magicparlabel-2374' /><a id='LyXCite-Kiesewetter' />
<span class='bibitemlabel'>1</span>S. Kiesewetter, R. Polkinghorne, B. Opanchuk, and P. D. Drummond, <em>xSPDE: extensible software for stochastic equations</em>, SoftwareX, March (2016).</div>

<div class="bibliography"><a id='magicparlabel-2375' /><a id='LyXCite-Gardiner' />
<span class='bibitemlabel'>2</span>C. W. Gardiner, <em>Handbook of Stochastic Methods: for Physics, Chemistry and the Natural Sciences</em> (Springer 2004).</div>

<div class="bibliography"><a id='magicparlabel-2376' /><a id='LyXCite-Drummond' />
<span class='bibitemlabel'>3</span> P. D. Drummond and M. Hillery, <em>The Quantum Theory of Nonlinear Optics</em> (Cambridge University Press, Cambridge, 2014).</div>

<div class="bibliography"><a id='magicparlabel-2377' /><a id='LyXCite-DrummondMortimer' />
<span class='bibitemlabel'>4</span>P. D. Drummond and I. K. Mortimer, <em>Computer simulations of multiplicative stochastic differential equations.</em> J. Comp. Phys. <b>93</b>, 144-170 (1991).</div>

<div class="bibliography"><a id='magicparlabel-2378' /><a id='LyXCite-KP' />
<span class='bibitemlabel'>5</span>P.E. Kloeden and E. Platen, <em>Numerical Solution of Stochastic Differential Equations</em> (Springer, 1995).</div>

<div class="bibliography"><a id='magicparlabel-2379' /><a id='LyXCite-WernerDrummond' />
<span class='bibitemlabel'>6</span>M. J. Werner and P. D. Drummond, <em>Robust algorithms for solving stochastic partial differential equations.</em> J. Comp. Phys. <b>132</b>, 312-326 (1997).</div>

<div class="bibliography"><a id='magicparlabel-2380' /><a id='LyXCite-Caradoc_Davies' />
<span class='bibitemlabel'>7</span>B. M. Caradoc-Davies, <em>Vortex dynamics in Bose-Einstein condensates</em> (Doctoral dissertation, PhD thesis, University of Otago (NZ), 2000).</div>

<div class="bibliography"><a id='magicparlabel-2381' /><a id='LyXCite-xmds' />
<span class='bibitemlabel'>8</span> G. R. Collecutt, P. D. Drummond, <em>Xmds: eXtensible multi-dimensional simulator.</em> Comput. Phys. Commun. <b>142</b>, 219-223 (2001).</div>

<div class="bibliography"><a id='magicparlabel-2382' /><a id='LyXCite-xmds2' />
<span class='bibitemlabel'>9</span>Graham R. Dennis, Joseph J. Hope, Mattias T. Johnsson, <em>XMDS2: Fast, scalable simulation of coupled stochastic partial differential equations,</em> Computer Physics Communications <b>184</b>, 201208 (2013).</div>

<div class="bibliography"><a id='magicparlabel-2383' /><a id='LyXCite-xmds_source' />
<span class='bibitemlabel'>10</span>http://sourceforge.net/projects/xmds/</div>
</div></body>
</html>
