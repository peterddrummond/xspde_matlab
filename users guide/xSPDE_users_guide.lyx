#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrbook
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package none
\inputencoding iso8859-15
\fontencoding default
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 1
\output_sync_macro "\synctex=-1"
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref section
\pdf_pdfusetitle true
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 0
\use_package cancel 0
\use_package esint 2
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 1
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
xSPDE, The Stochastic Toolbox 
\end_layout

\begin_layout Title
User's Guide v2.4
\end_layout

\begin_layout Author
Peter D.
 Drummond, Rodney Polkinghorne, Simon Kiesewetter
\end_layout

\begin_layout Address

\series bold
Centre for Quantum and Optical Science, Swinburne University of Technology,
 Melbourne, Victoria, Australia.
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Chapter
Introduction
\begin_inset CommandInset label
LatexCommand label
name "chap:Introduction"

\end_inset


\end_layout

\begin_layout Standard
The xSPDE stochastic toolbox is an e
\series bold
x
\series default
tensible 
\series bold
S
\series default
tochastic 
\series bold
P
\series default
artial 
\series bold
D
\series default
ifferential 
\series bold
E
\series default
quation solver.
 It can solve any number of simultaneous equations in any number of space
 dimensions, with averaging and graphical output.
 This user's guide can be used as the basis for a 3-4 hour self-taught tutorial
 in solving practical stochastic problems.
 It includes exercises for the reader.
 A full-length manual is available online.
 Research use of this software is encouraged, and should be referenced to
 the corresponding paper
\begin_inset CommandInset citation
LatexCommand cite
key "Kiesewetter"

\end_inset

.
 See:
\emph on
 
\series bold
\emph default
www.github.com/peterddrummond/xspde_matlab.
\end_layout

\begin_layout Section
Stochastic equations
\end_layout

\begin_layout Standard
Stochastic equations are equations with random noise terms 
\begin_inset CommandInset citation
LatexCommand cite
key "Gardiner,Drummond"

\end_inset

.
 They occur in in many fields of biology, chemistry, engineering, economics,
 physics, meteorology and other disciplines.
 An ordinary stochastic equation for a real or complex vector 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\bm{a}}{\partial t}=\dot{\bm{a}}=\mathbf{A}\left(\bm{a}\right)+\underline{\mathbf{B}}\left(\bm{a}\right)\bm{w}(t).
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is a vector, 
\begin_inset Formula $\underline{\mathbf{B}}$
\end_inset

 a matrix, and 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is a real noise vector, delta-correlated in time: 
\begin_inset Formula 
\begin{eqnarray}
\left\langle w_{i}\left(t\right)w_{j}\left(t\right)\right\rangle  & = & \delta\left(t-t'\right)\delta_{ij}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Stochastic partial differential equations including space dependence are
 also numerically soluble 
\begin_inset CommandInset citation
LatexCommand cite
key "DrummondMortimer,KP"

\end_inset

 with xSPDE.
 These are described in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Stochastic-partial-differential"

\end_inset

.
\end_layout

\begin_layout Section
xSPDE
\end_layout

\begin_layout Standard
xSPDE is a Matlab based software toolbox.
 It has functions that can numerically solve both ordinary and partial different
ial stochastic equations, and graph results of correlations and averages.
 There are many equations of this type, and the xSPDE toolbox can treat
 a wide range.
 The extensible general structure permits drop-in replacements of the functions
 provided.
 Different simulations can be carried out sequentially, to simulate the
 various stages in an experiment or other process.
 It can even be used with no noise.
\end_layout

\begin_layout Standard
The code supports parallelism at both the vector instruction level and at
 the thread level, using Matlab matrix instructions and the parallel toolbox.
 It calculates averages of arbitrary functions of any number of complex
 or real fields, as well as Fourier transforms in time or space.
 It provides error estimates for both step-size and sampling error.
 
\end_layout

\begin_layout Standard

\emph on
xSPDE is distributed without any guarantee, under an open-source license.
 Contributions and bug reports always welcome.
\end_layout

\begin_layout Chapter
xSPDE simulations
\begin_inset CommandInset label
LatexCommand label
name "chap:Interactive-xSPDE"

\end_inset


\end_layout

\begin_layout Standard
The general purpose xSPDE toolbox function co is:
\end_layout

\begin_layout Itemize

\series bold
xspde(in)
\series default
, the combined simulation (xSIM) and graphics (xGRAPH) function.
\end_layout

\begin_layout Section
Running xSPDE interactively
\end_layout

\begin_layout Standard
To simulate a stochastic equation, first make sure that either the Matlab
 xSPDE toolbox is installed, or the Matlab path is pointing to the xSPDE
 folder and subfolders.
 If not, proceed as follows:
\end_layout

\begin_layout Itemize
Click on the Matlab HOME tab (top left), then Set Path
\end_layout

\begin_layout Itemize
Click on Add with Subfolders
\end_layout

\begin_layout Itemize
Find the xSPDE folder in the drop-down menu, and select it
\end_layout

\begin_layout Itemize
Click on close to save the path.
\end_layout

\begin_layout Standard
Next, type 
\begin_inset Formula $clear$
\end_inset

 to clear old data, and enter the xSPDE inputs and functions into the command
 window.
 For the simplest of examples, do this by cutting and pasting from an electronic
 file of this manual.
 You can also use the Matlab built-in editor.
\end_layout

\begin_layout Standard
A typical script is as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\mathtt{in.}[label1] & = & [parameter1]\\
\mathtt{in.}[label2] & = & \ldots\\
\mathtt{in.da} & = & \mathtt{@(a,w,r)}\,\,[derivative]\\
\mathtt{xspde(in)}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Note the following points to remember:
\end_layout

\begin_layout Itemize
The notation 
\begin_inset Formula $\mathtt{in.}[label1]=[parameter1]$
\end_inset

 inputs a value to the 
\begin_inset Formula $\mathtt{in}$
\end_inset

 data structure 
\end_layout

\begin_layout Itemize
There are many input possibilities, and they all have default values.
\end_layout

\begin_layout Itemize
You don't have to save the data if you just want an immediate plot 
\end_layout

\begin_layout Itemize
The notation 
\begin_inset Formula $\mathtt{in.da=}\mathtt{@(a,w,r)}\,\,[derivative]=..$
\end_inset

 defines an inline function, 
\begin_inset Formula $da/dt$
\end_inset

.
 
\end_layout

\begin_layout Itemize
In xSPDE, 
\begin_inset Formula $\mathtt{a}$
\end_inset

 is the stochastic variable, 
\begin_inset Formula $\mathtt{w}$
\end_inset

 the random noise, and 
\begin_inset Formula $\mathtt{r}$
\end_inset

 the parameters.
 
\end_layout

\begin_layout Itemize
For example, 
\begin_inset Formula $\mathtt{r.t}$
\end_inset

 is the current time, and 
\begin_inset Formula $\mathtt{r.x},$
\end_inset

 
\begin_inset Formula $\mathtt{r.y},$
\end_inset

 
\begin_inset Formula $\mathtt{r.z},$
\end_inset

 the grid of coordinates.
 
\end_layout

\begin_layout Section
Inputs
\end_layout

\begin_layout Standard
All xSPDE simulations use a structure 
\emph on
in
\emph default
 for input data.
 All functions use an internally generated structure 
\begin_inset Formula $r$
\end_inset

, combining 
\begin_inset Formula $in$
\end_inset

 with other generated parameters.
 Any name will do for either structure, as long as you are consistent.
 
\end_layout

\begin_layout Standard
All xSPDE inputs have default values, which can be changed by typing parameters
 into the 
\emph on
in
\emph default
 structure.
 If you only need the first value of a vector or array, just input the value
 that is required.
\end_layout

\begin_layout Subsection
Common xSPDE inputs
\end_layout

\begin_layout Standard
The most common xSPDE parameters are: 
\begin_inset Newline newline
\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="17" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.fields
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stochastic field variables
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.noises
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of noises
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.dimension
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space-time dimensions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.name
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
string 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
' ' 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simulation name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.olabels
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
string
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'a'
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.da
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The stochastic derivative
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.define
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defined field definition
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.initial
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function to initialize variables
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.ensembles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[1,1,1]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Numbers of stochastic trajectories
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.observe
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable function(s) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.linear
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Linear interaction picture response
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.ranges
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ranges in time and space
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.steps
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Time-steps per plot point
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.points
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
51 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output lattice points in [t,x,y,z]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.images
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer cell array
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{0,..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Movie images in time per 2D observable
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.transforms
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector cells 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {[0 0 0 0],..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fourier transforms in [t,x,y,z]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard

\series bold
A complete list of user inputs is given in Chapter (
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Table-of-xSPDE"

\end_inset

).
\end_layout

\begin_layout Subsection
Use the dot
\end_layout

\begin_layout Standard
Matlab formulae often require a 'dot' or a 'colon'.
 To multiply vectors element-wise, like 
\begin_inset Formula $a_{i}=b_{i}c_{i}$
\end_inset

, the notation 
\begin_inset Formula $a=b.*c$
\end_inset

 indicates all elements are multiplied.
 This is used in xspde to speed up calculations in parallel.
 
\end_layout

\begin_layout Standard
A formula for a stochastic field usually requires you to address the first
 index - which is the field component - and treat all the other elements
 in parallel.
 To do this, use the notation 
\begin_inset Formula $a(1,:)$
\end_inset

.
 
\end_layout

\begin_layout Standard
Whenever a formula combines operations over spatial lattices or ensembles,
 remember to 
\series bold
USE THE DOT
\series default
.
\end_layout

\begin_layout Section
The random walk
\end_layout

\begin_layout Standard
The first example is the simplest possible stochastic equation: 
\begin_inset Formula 
\begin{equation}
\dot{a}=w(t)\,,
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This is carried out numerically and graphed using 
\begin_inset Formula $N=points(1)$
\end_inset

 points.
 Since the first time point stored is always the initial value, there are
 
\begin_inset Formula $N-1$
\end_inset

 integration steps, each of length 
\begin_inset Formula $dt=ranges(1)/(N-1)$
\end_inset

.
 As a result, the graphs have discrete steps, and more detail is obtained
 if more time steps are used.
 The default value is 
\begin_inset Formula $N=51$
\end_inset

, which is in the 
\begin_inset Formula $xpreferences$
\end_inset

 file.
 This is adjustable by the user.
 It can also be changed for a simulation, by inputting a new value of 
\begin_inset Formula $points$
\end_inset

.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Standard
Remember that, unless you type 
\emph on
clear
\emph default
 first, any changes to the input structure are additive; so you will get
 the sum of all the previous inputs as well as your new input.
\end_layout

\begin_layout Itemize

\series bold
Run the complete xSPDE script given below in Matlab.
 
\end_layout

\begin_layout Standard
It is simplest to cut and paste from an electronic file into the Matlab
 command window.
 Be careful; pasting can cause subtle changes that may require correction.
 
\end_layout

\begin_layout Standard
You should get the output in Fig (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-simplest-case: Wiener"

\end_inset

).
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
in.da=@(a,w,r) w; xspde(in);
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
Here 
\begin_inset Formula $in.da$
\end_inset

 defines the derivative function, with 
\begin_inset Formula $w$
\end_inset

 the noise.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset


\begin_inset Graphics
	filename Figures/Wiener_1.pdf
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:The-simplest-case: Wiener"

\end_inset

The simplest case: a random walk.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
What do you see if you average over 
\begin_inset Formula $10000$
\end_inset

 trajectories ?
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
in.ensembles = 10000;
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(in);
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
What do you see if you plot the mean square distance? Note that variances
 should increase linearly with 
\begin_inset Formula $t$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
in.observe = @(a,r) a.^2;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = '<a^2>';
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(in);
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
What if you add a force that takes the particle back to the origin?
\series default
 
\begin_inset Formula 
\begin{equation}
\dot{a}=-a+w(t)\,,
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
in.da=@(a,w,r) -a+w
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(in);
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*

\series bold
Mathematical exercise:
\series default
 
\end_layout

\begin_layout Itemize
If you like mathematics, then as an offline exercise, try to solve the equivalen
t diffusion equation for the probability P to find the variance 
\begin_inset Formula $\left\langle a^{2}\right\rangle $
\end_inset

! The equation is:
\begin_inset Formula 
\[
\frac{\partial P\left(a\right)}{\partial t}=\left[\frac{\partial}{\partial a}+\frac{1}{2}\frac{\partial^{2}}{\partial a^{2}}\right]P\left(a\right)
\]

\end_inset


\end_layout

\begin_layout Section
Laser quantum noise
\end_layout

\begin_layout Standard
Next we treat a model for the quantum noise of a single mode laser as it
 turns on, near threshold:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{a}=ga+bw(t)
\end{equation}

\end_inset

where the noise is complex, 
\begin_inset Formula $w=\left(w_{1}+iw_{2}\right)$
\end_inset

, so that: 
\begin_inset Formula 
\begin{equation}
\left\langle w(t)w^{*}(t')\right\rangle =2\delta\left(t-t'\right)\,.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here the coefficient 
\begin_inset Formula $b$
\end_inset

 describes the quantum noise of the laser, and is inversely proportional
 to the equilibrium photon number.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Standard
You should type 
\emph on
clear 
\emph default
first when starting new simulations.
\end_layout

\begin_layout Itemize

\series bold
Solve for the case of 
\begin_inset Formula $g=0.1$
\end_inset

, 
\begin_inset Formula $b=0.01$
\end_inset


\end_layout

\begin_layout Standard
Most lasers have more than 
\begin_inset Formula $100$
\end_inset

 photons, and hence less noise! 
\end_layout

\begin_layout Standard
For this exercise, small error-bars will display on the graph.
 These are calculated from the difference between using steps of size 
\begin_inset Formula $dt$
\end_inset

 and steps of size 
\begin_inset Formula $dt/2$
\end_inset

.
 They only appear if greater than a minimum relative size, typically 
\begin_inset Formula $1\%$
\end_inset

 of the graph size, which can be set by the user.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
clear
\end_layout

\begin_layout Plain Layout

\family typewriter
in.noises=2;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.observe = @(a,r) abs(a)^2;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = '|a|^2';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da=@(a,w,r) a+0.01*(w(1)+i*w(2));
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(in);
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Consider the case where the laser saturates to a steady state:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{a}=\left(1-\left|a\right|^{2}\right)a+bw(t)
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Solve for the saturated laser case
\end_layout

\begin_layout Standard
You should get the output graph in Fig (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-laser"

\end_inset

).
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
in.da=@(a,w,r) (1-abs(a)^2)*a+0.01*(w(1)+i*w(2));
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(in);
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset


\begin_inset Graphics
	filename Figures/Laser.pdf
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:The-laser"

\end_inset

Simulation of the stochastic equation describing a laser turning on.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Spectra
\end_layout

\begin_layout Standard
Frequency spectra have many uses, especially for understanding the steady-state
 fluctuations of any physical system.
 The xSPDE spectral definition is:
\begin_inset Formula 
\[
\tilde{a}(\omega)=\frac{1}{\sqrt{2\pi}}\int e^{-i\omega t}a(t)dt\,
\]

\end_inset


\end_layout

\begin_layout Standard
To get an output from a temporally Fourier transformed field, just set 
\begin_inset Formula $in.transforms\{n\}=1$
\end_inset

, for the particular observable (
\begin_inset Formula $n$
\end_inset

) you need to calculate in transform space.
 This parameter is a cell array.
 It can have a different value for every observable and for every dimension
 in space-time if you have space dimensions as well.
\end_layout

\begin_layout Standard
As an example, take the random walk equation in a complex space, 
\begin_inset Formula 
\[
\frac{da}{dt}=-a+\zeta(t)
\]

\end_inset

where 
\begin_inset Formula $\zeta(t)=w_{1}(t)+iw_{2}(t)$
\end_inset

.
 Use an initial condition of 
\begin_inset Formula $a=(v_{1}+iv_{2})/\sqrt{2}$
\end_inset

, with 
\begin_inset Formula $\left\langle v_{i}^{2}\right\rangle =1$
\end_inset

, to start near the steady state.
 
\end_layout

\begin_layout Standard
For sufficiently long time-intervals, the solution in frequency space -
 where 
\begin_inset Formula $\omega=2\pi f$
\end_inset

 is the angular frequency - is given by: 
\begin_inset Formula 
\[
\tilde{a}\left(\omega\right)=\frac{\tilde{\zeta}(\omega)}{1+i\omega}
\]

\end_inset

The expectation value of the noise spectrum, in the long time-intervals
 limit, is therefore: 
\begin_inset Formula 
\begin{eqnarray*}
\left\langle \left|\tilde{a}(\omega)\right|^{2}\right\rangle  & = & \frac{1}{2\pi\left(1+\omega^{2}\right)}\int\int e^{-i\omega(t-t')}\left\langle \zeta(t)\zeta^{*}(t')\right\rangle dtdt'\,.\\
 & = & \frac{T_{eff}}{\pi\left(1+\omega^{2}\right)}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
The final result is obtained from the fact that the first integral vanishes
 unless 
\begin_inset Formula $t=t'$
\end_inset

, since for small steps, 
\begin_inset Formula $\left\langle \zeta(t)\zeta^{*}(t')\right\rangle \rightarrow2\delta\left(t-t'\right)$
\end_inset

.
 Next, the second time integral is carried out numerically as a sum which
 has 
\begin_inset Formula $N$
\end_inset

 points of interval 
\begin_inset Formula $dt$
\end_inset

.
 Owing to definition of 
\begin_inset Formula $dt$
\end_inset

, the `effective' time duration for the Fourier tranform time integrals
 is 
\begin_inset Formula $T_{eff}=Ndt=ranges(1)\times N/(N-1)$
\end_inset

.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Plot the spectrum over a range of 
\begin_inset Formula $t=100$
\end_inset

, with 
\begin_inset Formula $640$
\end_inset

 points and a random initial equation near the equilibrium value.
\end_layout

\begin_layout Standard
The input parameters are given below.
 There are parallel operations here, for ensemble averaging, so 
\series bold
USE THE DOT
\series default
.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
clear
\end_layout

\begin_layout Plain Layout

\family typewriter
in.points = 640;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.ranges = 100;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.noises = 2; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.ensembles = 10000; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.initial = @(v,r) (v(1,:)+1i*v(2,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da = @(a,w,r) -a + w(1,:)+1i*w(2,:); 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.observe =@(a,r) a.*conj(a);
\end_layout

\begin_layout Plain Layout

\family typewriter
in.transforms =1;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = '|a(
\backslash
omega)|^2'; 
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(in); 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
Note that 
\family typewriter
in.transforms =1
\family default
 tells xSPDE to Fourier transform the field over the time coordinate before
 averaging, to give a spectrum.
 The first argument 
\begin_inset Formula $v$
\end_inset

 of the 
\emph on
initial
\emph default
 function is a random field, used optionally to initialize the stochastic
 variable.
 You can transform any field in any dimension, for any number of resulting
 averages.
 See Chapter 6 for details.
 
\end_layout

\begin_layout Standard
To define as many observables as you like, use a Matlab cell array; 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
in.observe{1} = ..;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.observe{2} = ..;
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Simulate over a range of 
\begin_inset Formula $t=200$
\end_inset

.
 What changes do you see? Why?
\end_layout

\begin_layout Itemize

\series bold
Change the equation to the laser noise equations.
 Why is the spectrum much narrower?
\end_layout

\begin_layout Section
Ito and Stratonovich
\end_layout

\begin_layout Standard
The xSPDE toolbox is mainly designed to treat Stratonovich equations 
\begin_inset CommandInset citation
LatexCommand cite
key "Gardiner"

\end_inset

, which are the broad-band limit of a finite band-width random noise equation.
 Another type of of stochastic equation is the Ito form, which is a limit
 where derivatives are evaluated at the start of each step.
 If you have an Ito equation, you can either use the Euler integration option,
 and set 
\begin_inset Formula $in.step=xEuler$
\end_inset

, or else apply the Stratonovich correction to the drift, as outlined below.
 
\end_layout

\begin_layout Standard
To emphasize the difference, an Ito equation is often written as a difference
 equation:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
d\mathbf{a}=\mathbf{A}^{I}\left[\mathbf{a}\right]+\underline{\mathbf{B}}\left[\mathbf{a}\right]\cdot d\bm{w}(t).
\end{equation}

\end_inset

Here 
\begin_inset Formula $\left\langle dw_{i}\left(\bm{x}\right)dw_{j}\left(\bm{x}'\right)\right\rangle =\delta_{ij}dt$
\end_inset

.
 
\end_layout

\begin_layout Standard
When 
\begin_inset Formula $\bm{\mathsf{B}}$
\end_inset

 is constant, the two methods are identical.
 If 
\begin_inset Formula $\bm{\mathsf{B}}$
\end_inset

 is not constant, the Ito drift term 
\begin_inset Formula $\mathbf{A}^{I}$
\end_inset

 is different to the corresponding Stratonovich one.
 The relationship is: 
\begin_inset Formula 
\begin{eqnarray}
A_{i} & = & A_{i}^{I}-\frac{1}{2}\sum_{j,m}\frac{\partial B_{ij}}{\partial a_{m}}B_{mj}\,.
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Section
Financial calculus
\end_layout

\begin_layout Standard
A well-known Ito stochastic equation is the Black-Scholes equation, used
 to price financial options.
 It describes the fluctuations in a stock value: 
\begin_inset Formula 
\begin{equation}
da=\mu a\,dt+a\sigma\,dw,
\end{equation}

\end_inset

where 
\begin_inset Formula $\left\langle dw^{2}\right\rangle =dt$
\end_inset

.
 Since the noise is multiplicative, the equation is different in Ito and
 Stratonovich forms of stochastic calculus.
 
\end_layout

\begin_layout Standard
The corresponding Stratonovich equation, as used in xSPDE for the standard
 default integration routine is: 
\begin_inset Formula 
\begin{equation}
\dot{a}=\left(\mu-\sigma^{2}/2\right)a+a\sigma w(t).
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve for a startup with a volatile stock having 
\begin_inset Formula $\mu=0.1,\,\sigma=1$
\end_inset

.
\end_layout

\begin_layout Standard
An interactive xSPDE script in Matlab is given below with an output graph
 in Fig (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-Black-Scholes"

\end_inset

), Note the spiky behaviour, typical of multiplicative noise, and also of
 the risky stocks in the small capitalization portions of the stock market.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
clear
\end_layout

\begin_layout Plain Layout

\family typewriter
in.initial=@(v,r) 1
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da=@(a,w,r) -0.4*a+a*w
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(in)
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset


\begin_inset Graphics
	filename Figures/Black-Scholes.pdf
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:The-Black-Scholes"

\end_inset

Simulation of the Black-Scholes equation describing stock prices.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $in.initial$
\end_inset

 describes the initialization function.
 The first argument of 
\begin_inset Formula $@(v,r)$
\end_inset

 is 
\begin_inset Formula $v$
\end_inset

, an initial random variable with unit variance.
 The error-bars are estimates of step-size error.
 Errors can be reduced by using more time-steps.
\end_layout

\begin_layout Itemize

\series bold
Solve for a more mature stock having 
\begin_inset Formula $\mu=0.1,\,\sigma=0.1$
\end_inset

.
\end_layout

\begin_layout Chapter
xSPDE Projects 
\begin_inset CommandInset label
LatexCommand label
name "chap:Projects-xSPDE"

\end_inset


\end_layout

\begin_layout Standard
Projects are larger scale investigations, where files are used to record
 inputs and data.
 This requires a new input parameter:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.file
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
string 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
''
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Matlab or HDF5 data file
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Section
Ensembles and sampling errors
\end_layout

\begin_layout Standard
Averages over stochastic ensembles are the specialty of xSPDE, which requires
 specification of the ensemble size.
 A sophisticated hierarchy of ensemble specifications in three levels is
 possible, to allow maximum resource utilization, so that:
\begin_inset Formula 
\[
in.ensembles=[ensembles(1),ensembles(2),ensembles(3)]\,.
\]

\end_inset

The local ensemble, 
\begin_inset Formula $ensembles\left(1\right)$
\end_inset

, gives within-thread parallelism, allowing vector instruction use for single-co
re efficiency.
 The serial ensemble, 
\begin_inset Formula $ensembles\left(2\right)$
\end_inset

, gives a number of independent trajectories calculated serially.
 
\end_layout

\begin_layout Standard
The parallel ensemble, 
\begin_inset Formula $ensembles\left(3\right)$
\end_inset

, gives multi-core parallelism, and requires the Matlab parallel toolbox.
 This improves speed when there are multiple cores.
 One should optimally put 
\begin_inset Formula $ensembles\left(3\right)$
\end_inset

 equal to the available number of CPU cores.
\end_layout

\begin_layout Standard
The 
\emph on
total 
\emph default
number of stochastic trajectories or samples is 
\begin_inset Formula 
\[
ensembles(1)\times ensembles(2)\times ensembles(3)\,.
\]

\end_inset


\end_layout

\begin_layout Standard
Either 
\begin_inset Formula $ensembles(2)$
\end_inset

 or 
\begin_inset Formula $ensembles(3)$
\end_inset

 are required if sampling error-bars are to be calculated, owing to the
 sub-ensemble averaging method used in xSPDE to calculate sampling errors
 accurately.
 
\end_layout

\begin_layout Section
xSIM and xGRAPH
\end_layout

\begin_layout Standard
An XPDE session can either run simulations interactively, described in Chapter
 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Interactive-xSPDE"

\end_inset

, or else using a function file called a project file.
 This allows xSPDE to run in a batch mode, as needed for longer projects
 which involve large ensembles.
 In either case, the Matlab path must include the xSPDE folder.
 For generating graphs automatically, the script input or project function
 should end with the combined function 
\series bold
xspde(in)
\series default
.
 
\end_layout

\begin_layout Standard
With batch jobs it is often useful to divide xSPDE into its simulation function,
 xSIM, and its graphics function, xGRAPH, to allow graphs to be made at
 a later time from the simulation.
 In this case the function
\series bold
 
\begin_inset Formula $xsim$
\end_inset


\series default
 runs the simulation, and 
\begin_inset Formula $xgraph$
\end_inset

 makes the graphs.
 The two-stage option is better for running batch jobs, which you can graph
 at a later time.
\end_layout

\begin_layout Standard
To create a data file, you must enter the filename when running the simulation,
 using the 
\begin_inset Formula $in.file=filename$
\end_inset

 input.
 A typical xSPDE project function of this type is as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\mathtt{function}\,[e,ec] & = & project.m\\
\mathtt{in.}[label1] & = & [parameter1]\\
\mathtt{in.}[label2] & = & \ldots\\
\mathtt{in.file} & = & [my\,file].\mathtt{mat}\\
\mathtt{[e,in]} & = & \mathtt{xsim(in)}\\
\mathtt{ec} & = & \mathtt{xgraph(in.file)}\\
\mathtt{end}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
After preparing a project file using the editor, click on the Run arrow
 above the editor window.
 
\end_layout

\begin_layout Standard
In summary, a simple batch job workflow is as follows:
\end_layout

\begin_layout Itemize
Create the metadata 
\begin_inset Formula $in$
\end_inset

, and include a file name
\end_layout

\begin_layout Itemize
Change the Matlab directory path to home using 
\begin_inset Formula $cd\,\sim$
\end_inset

.
\end_layout

\begin_layout Itemize
Run the simulation with
\series bold
 [e,in]=xsim(in)
\series default
.
\end_layout

\begin_layout Itemize
Note that xSIM changes the file-name if it already exists, and returns the
 new name for plotting.
\end_layout

\begin_layout Itemize
Run 
\series bold
xgraph(in.file)
\series default
, and the data will be accessed and graphed.
 
\end_layout

\begin_layout Itemize
You can use either Matlab (.mat) or standard HDF5 (.h5) file-types.
\end_layout

\begin_layout Section
Kubo project
\end_layout

\begin_layout Standard
To get started on more complex programs, we next simulate the Kubo oscillator,
 which is an oscillator with a random frequency: 
\begin_inset Formula 
\begin{equation}
\dot{a}=iaw
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Simulate the Kubo oscillator using a file, 
\begin_inset Formula $Kubo.m$
\end_inset

, with two ensembles to allow sampling error estimates.
 The error vector 
\begin_inset Formula $error$
\end_inset

 gives the time-step error plus the sampling error.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [error] = Kubo() 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.name = 'Kubo oscillator';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.ensembles = [400,16]; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.initial = @(v,r) 1+0*v;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da = @(a,w,r) i*a.*w;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = '<a_1>';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.file = 'kubo.mat';
\end_layout

\begin_layout Plain Layout

\family typewriter
[error,in]=xsim(in); 
\end_layout

\begin_layout Plain Layout

\family typewriter
xgraph(in.file);
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The initial value of 1 is modified by adding 
\begin_inset Formula $0*v$
\end_inset

.
 This is necessary, so that it returns an array whose first dimension equals
 the ensemble size.
 
\end_layout

\begin_layout Standard
This function is designed to generate a data file, 
\family typewriter
kubo.mat
\family default
.
 If you run this more than once without deleting the earlier file, you will
 get a warning and a new file-name, 
\family typewriter
kubo1.mat
\family default
, which is stored in the in structure.
 Under these circumstance, xgraph will graph the data in the most recent
 file saved, with the new file-name.
 This occurs because xSPDE will 
\series bold
not
\series default
 overwrite old files, to protect your previous data.
 
\end_layout

\begin_layout Standard
You can also include modified graphics parameters as a second input when
 running 
\family typewriter
xgraph, 
\family default
just in case the first graphs you generate need changes.
\end_layout

\begin_layout Section
Open system
\end_layout

\begin_layout Standard
We next simulate the driven quantum oscillator with a vacuum noise input
 and output
\begin_inset Formula 
\begin{equation}
\dot{a}=iaw
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Simulate the Kubo oscillator using a file, 
\begin_inset Formula $Kubo.m$
\end_inset

, with two ensembles to allow sampling error estimates.
 The error vector 
\begin_inset Formula $error$
\end_inset

 gives the time-step error plus the sampling error.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [error] = Kubo() 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.name = 'Kubo oscillator';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.ensembles = [400,16]; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.initial = @(v,r) 1+0*v;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da = @(a,w,r) i*a.*w;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = '<a_1>';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.file = 'kubo.mat';
\end_layout

\begin_layout Plain Layout

\family typewriter
[error,in]=xsim(in); 
\end_layout

\begin_layout Plain Layout

\family typewriter
xgraph(in.file);
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The initial value of 1 is modified by adding 
\begin_inset Formula $0*v$
\end_inset

.
 This is necessary, so that it returns an array whose first dimension equals
 the ensemble size.
 
\end_layout

\begin_layout Standard
This function is designed to generate a data file, 
\family typewriter
kubo.mat
\family default
.
 If you run this more than once without deleting the earlier file, you will
 get a warning and a new file-name, 
\family typewriter
kubo1.mat
\family default
, which is stored in the in structure.
 Under these circumstance, xgraph will graph the data in the most recent
 file saved, with the new file-name.
 This occurs because xSPDE will 
\series bold
not
\series default
 overwrite old files, to protect your previous data.
 
\end_layout

\begin_layout Standard
You can also include modified graphics parameters as a second input when
 running 
\family typewriter
xgraph, 
\family default
just in case the first graphs you generate need changes.
\end_layout

\begin_layout Section
Challenge problem #1
\end_layout

\begin_layout Standard
This is a much harder example, involving a full nonlinear quantum phase-space
 simulation.
 The method can also be used to investigate quantum non-equilibrium phase
 transitions, tunneling in open systems, quantum entanglement, Einstein-Podolsky
-Rosen paradoxes, Bell violations, and many other problems treated in the
 literature
\begin_inset CommandInset citation
LatexCommand cite
key "Gardiner,Drummond"

\end_inset

.
\end_layout

\begin_layout Standard
The following new ideas are introduced: 
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{in.ranges}$
\end_inset

 is the space-time integration range.

\series default
 
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{in.steps}$
\end_inset

 gives integration steps per plot-point, for accuracy.

\series default
 
\end_layout

\begin_layout Standard
A simple case is the nonlinear driven quantum oscillator - for example,
 an optomechanical, atomic or nonlinear optical medium in a driven cavity.
 
\end_layout

\begin_layout Standard
The phase-space Fokker-Planck equation is equivalent to an SDE with the
 following form 
\begin_inset Formula 
\begin{eqnarray}
\frac{d\alpha}{dt} & = & -\tilde{\gamma}\alpha-i\kappa\alpha^{2}\beta+\mathcal{E}+i\sqrt{i\kappa}\alpha w_{1}(t),\nonumber \\
\frac{d\beta}{dt} & = & -\tilde{\gamma}^{\ast}\beta+i\kappa\beta^{2}\alpha+\mathcal{E}^{\ast}+\sqrt{i\kappa}\beta w_{2}(t),
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\xi_{i}(t)$
\end_inset

 are independent Gaussian noise terms with zero means and the following
 nonzero correlations 
\begin_inset Formula 
\begin{equation}
\left\langle w_{i}(t)w_{j}(t^{\prime})\right\rangle =\delta_{ij}\delta(t-t^{\prime}).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Note that these equations require that 
\begin_inset Formula $\kappa\ll\gamma$
\end_inset

, which is typical experimentally, otherwise one must use additional stochastic
 gauge stabilization to improve sampling error.
 
\end_layout

\begin_layout Standard
Defining the dimensionless parameters 
\begin_inset Formula $\varepsilon$
\end_inset

 and 
\begin_inset Formula $\lambda$
\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\varepsilon=\frac{2\mathcal{E}}{\kappa}\,,\;\lambda=\frac{2\tilde{\gamma}}{\kappa}\,\,.\label{parameters}
\end{equation}

\end_inset

Provided 
\begin_inset Formula $\gamma+\Delta\omega<0$
\end_inset

 and 
\begin_inset Formula $($
\end_inset

Re
\begin_inset Formula $\lambda)^{2}>3|\lambda|^{2}$
\end_inset

 there is a bistable region.
 This means that for 
\begin_inset Formula $|\varepsilon|^{2}$
\end_inset

 in a certain range, there are two physically possible values of 
\begin_inset Formula $n_{0}$
\end_inset

.
 For 
\begin_inset Formula $\tilde{\gamma}=2.5-10i$
\end_inset

, 
\begin_inset Formula $\kappa=1$
\end_inset

, the bistable region is around 
\begin_inset Formula $\mathcal{E}=8$
\end_inset

.
 The observed quantity is the particle number, 
\begin_inset Formula $\left\langle \hat{a}^{\dagger}\hat{a}\right\rangle =\left\langle \alpha\beta\right\rangle $
\end_inset

, with stable values of 
\begin_inset Formula $n\approx1$
\end_inset

 and 
\begin_inset Formula $n\approx6$
\end_inset

.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Simulate the nonlinear oscillator by creating a file, 
\begin_inset Formula $Nonlinear.m$
\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
Can you observe quantum tunneling of 
\begin_inset Formula $n=\alpha\beta$
\end_inset

 in the bistable regime?
\end_layout

\begin_layout Itemize

\series bold
Do you see transient Schroedinger `cat states' with a negative n value?
\end_layout

\begin_layout Standard
Since tunneling is random, for real experimental comparisons, one would
 have to measure correlation functions and spectra.
 However, a tunneling event in a simulation indicates that it is likely
 in experiment too.
 These calculations require long time scales, 
\begin_inset Formula $\mathtt{in.ranges}$
\end_inset

, to observe tunneling, and a large number of time steps per plotted point,
 
\begin_inset Formula $\mathtt{in.steps}$
\end_inset

, to maintain accuracy in the quantum simulations.
\end_layout

\begin_layout Chapter
Stochastic PDEs
\begin_inset CommandInset label
LatexCommand label
name "chap:Stochastic-partial-differential"

\end_inset


\end_layout

\begin_layout Standard
A stochastic partial differential equation or 
\begin_inset Formula $SPDE$
\end_inset

 for a complex vector field is defined in both time 
\begin_inset Formula $t$
\end_inset

 and space dimensions
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\bm{x}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
.
 The total dimension 
\begin_inset Formula $d$
\end_inset

 in xSPDE is unlimited, and includes time and space.
 Large 
\begin_inset Formula $d$
\end_inset

 is memory-intensive and slow! The general equation solved can be written
 in differential form as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\mathbf{a}}{\partial t}=\mathbf{A}\left[\mathbf{a}\right]+\underline{\mathbf{B}}\left[\mathbf{a}\right]\cdot\bm{w}(t)+\underline{\mathbf{L}}\left[\bm{\nabla}\right]\cdot\mathbf{a}\,.
\end{equation}

\end_inset

Here 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is a real or complex vector or vector field.
 The initial conditions are arbitrary functions.
 
\begin_inset Formula $\mathbf{A}\left[\mathbf{a}\right]$
\end_inset

 and 
\begin_inset Formula $\underline{\mathbf{B}}\left[\mathbf{a}\right]$
\end_inset

 are vector and matrix functions of 
\begin_inset Formula $\mathbf{a}$
\end_inset

, 
\begin_inset Formula $\underline{\mathbf{L}}\left[\bm{\nabla}\right]$
\end_inset

 is a matrix of linear terms and derivatives, diagonal in the vector indices,
 and 
\begin_inset Formula $\mathbf{w}=\left[\bm{w}^{x},\bm{w}^{k}\right]$
\end_inset

 are real delta-correlated noise fields such that: 
\begin_inset Formula 
\begin{eqnarray}
\left\langle w_{i}^{x}\left(t,\bm{x}\right)w_{j}^{x}\left(t,\bm{x}'\right)\right\rangle  & = & \delta\left(\bm{x}-\bm{x}'\right)\delta\left(t-t'\right)\delta_{ij}\nonumber \\
\left\langle w_{i}^{k}\left(t,\bm{k}\right)w_{j}^{k}\left(t,\bm{k}'\right)\right\rangle  & = & f(\mathbf{k})\delta\left(\bm{k}-\bm{k}'\right)\delta\left(t-t'\right)\delta_{ij}.
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Transverse boundary conditions are assumed periodic.
 The term 
\begin_inset Formula $\underline{\mathbf{L}}\left[\bm{\nabla}\right]$
\end_inset

 may be omitted if 
\begin_inset Formula $d=1$
\end_inset

, as there are no space dimensions.
 Here 
\begin_inset Formula $f(\mathbf{k})$
\end_inset

 is an arbitrary momentum filter, for correlated noise.
 The linear function 
\begin_inset Formula $L$
\end_inset

 is input as a separate function in xSPDE, to allow for greatest efficiency
 and use of an interaction picture.
 Note that it depends on momentum space coordinates, and this involves Fourier
 transforms.
\end_layout

\begin_layout Section
Stochastic Ginzburg-Landau equation
\end_layout

\begin_layout Standard
Including space-time dimensions with 
\begin_inset Formula $d=3$
\end_inset

, an example of a SPDE is the stochastic Ginzburg-Landau equation.
 This describes symmetry breaking: the system develops a spontaneous phase
 which can vary spatially as well.
 The model is widely used to describe lasers, magnetism, superconductivity,
 superfluidity and even particle physics: 
\begin_inset Formula 
\begin{equation}
\dot{a}=\left(1-\left|a\right|^{2}\right)a+bw(t)+c\nabla^{2}a
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\left\langle w(x)w^{*}(x')\right\rangle =2\delta\left(t-t'\right)\delta\left(x-x'\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The following new ideas are introduced for this problem: 
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{in.dimension}$
\end_inset

 is the space-time dimension.

\series default
 
\end_layout

\begin_layout Enumerate

\series bold
The
\series default
 'dot' 
\series bold
notation used for parallel operations over lattices
\series default
.
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{in.linear}$
\end_inset

 is the linear operator - a laplacian in these cases.
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{in.images}$
\end_inset

 produces movie-style images at discrete time slices.
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{r.Dx}$
\end_inset

 indicates a derivative operation, 
\begin_inset Formula $\partial/\partial x$
\end_inset

.

\series default
 
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $-5<x<5$
\end_inset

 is the default xSPDE coordinate range in space.

\series default
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the stochastic G-L equation for 
\begin_inset Formula $b=0.001$
\end_inset

 and 
\begin_inset Formula $c=0.01i$
\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
Change to a real diffusion so that 
\begin_inset Formula $c=0.1$
\end_inset

.
\end_layout

\begin_layout Standard
In the first case, you should get the output graphed in Fig (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Symmetry-breaking"

\end_inset

) .
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
in.noises=2;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.dimension=3;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.steps=10;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.linear = @(r) i*0.01*(r.Dx.^2+r.Dy.^2);
\end_layout

\begin_layout Plain Layout

\family typewriter
in.observe = @(a,~) abs(a).^2;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.images =6;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = '|a|^2';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da=@(a,w,~) (1-abs(a(1,:)).^2).*a+0.001*(w(1,:)+i*w(2,:));
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(in)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here the notation 
\begin_inset Formula $z(1,:)$
\end_inset

 is like the dot: the colon means that the operation is repeated over all
 values of the second index, which is the spatial lattice index.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset


\begin_inset Graphics
	filename Figures/GinzLand.pdf
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Symmetry-breaking"

\end_inset

Simulation of the stochastic equation describing symmetry breaking in two
 dimensions.
 Spatial fluctuations are caused by the different phase-domains that interfere.
 The graph obtained here is projected onto the 
\begin_inset Formula $y=0$
\end_inset

 plane.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Soliton
\end_layout

\begin_layout Standard
The famous nonlinear Schrdinger equation (NLSE) is: 
\begin_inset Formula 
\[
\frac{da}{dt}=\frac{i}{2}\left[\nabla^{2}a-a\right]+ia\left|a\right|^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
Together with the initial condition that 
\begin_inset Formula $a(0,x)=sech(x)$
\end_inset

, this has a soliton, an exact solution that doesn't change in time: 
\begin_inset Formula 
\begin{eqnarray*}
a(t,x) & = & sech(x)
\end{eqnarray*}

\end_inset

The Fourier transform at 
\begin_inset Formula $k=0$
\end_inset

 is simply: 
\begin_inset Formula 
\begin{eqnarray*}
\tilde{a}(t,0) & = & \frac{1}{\sqrt{2\pi}}\int sech(x)dx=\sqrt{\frac{\pi}{2}}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the NLSE for a soliton
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
f
\family typewriter
unction [e] = Soliton() 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.name = 'NLS soliton';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.dimension = 2; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.initial = @(v,r) sech(r.x); 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da = @(a,~,r) i*a.*(conj(a).*a);
\end_layout

\begin_layout Plain Layout

\family typewriter
in.linear = @(r) 0.5*i*(r.Dx.^2-1.0);
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = {'a_1(x)'}; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.compare{1}= @(t,~) 1; 
\end_layout

\begin_layout Plain Layout

\family typewriter
e = xspde(in); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
Add an additive complex noise of 
\begin_inset Formula $0.01(w_{1}+iw_{2}$
\end_inset

) to the differential equation, then replot with an average over 
\begin_inset Formula $1000$
\end_inset

 samples.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Gaussian diffraction 
\end_layout

\begin_layout Standard
Free diffraction of a Gaussian wave-function in three dimensions, is given
 by 
\begin_inset Formula 
\[
\frac{da}{dt}=\frac{i}{2}\nabla^{2}a
\]

\end_inset


\end_layout

\begin_layout Standard
The xSPDE spectral definition in space-time is:
\begin_inset Formula 
\[
\tilde{a}(\omega,\bm{k})=\frac{1}{\left[2\pi\right]^{D/2}}\int e^{i(\bm{k}\cdot\bm{x}-\omega t)}a(t,\bm{x})dtd\bm{x}\,
\]

\end_inset


\end_layout

\begin_layout Standard
Together with the initial condition that 
\begin_inset Formula $a(0,x)=exp(-\left|\mathbf{x}\right|^{2}/2)$
\end_inset

, this has an exact solution for the diffracted intensity in either ordinary
 space or momentum space is therefore: 
\begin_inset Formula 
\begin{eqnarray*}
\left|a\left(t,\mathbf{x}\right)\right|^{2} & = & \frac{1}{\left(1+t^{2}\right)^{3/2}}exp(-\left|\mathbf{x}\right|^{2}/\left(1+t^{2}\right))\\
\left|\tilde{a}\left(t,\mathbf{k}\right)\right|^{2} & = & exp(-\left|\mathbf{k}\right|^{2})
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
To get an output from a spatially Fourier transformed field, just set 
\begin_inset Formula $in.transforms=[0,1,1,1]$
\end_inset

, for the particular observable you need to calculate in transform space.
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the diffraction equation without noise
\end_layout

\begin_layout Itemize
Note that the example below stores data in a standardized HDF5 file.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [e] = Gaussian() 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.dimension = 4; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.initial = @(v,r) exp(-0.5*(r.x.^2+r.y.^2+r.z.^2));
\end_layout

\begin_layout Plain Layout

\family typewriter
in.linear = @(r) 1i*0.05*(r.Dx.^2+r.Dy.^2+r.Dz.^2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.observe = @(a,r) a.*conj(a); 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = '|a(x)|^2'; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.file = 'Gaussian.h5';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.images = 4;
\end_layout

\begin_layout Plain Layout

\family typewriter
[e,in] = xsim(in); 
\end_layout

\begin_layout Plain Layout

\family typewriter
e = xgraph(in.file); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\family default
 
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Add an additive complex noise of 
\begin_inset Formula $0.01(w_{1}+iw_{2}$
\end_inset

) to the Gaussian differential equation, then replot with an average over
 
\begin_inset Formula $10$
\end_inset

 samples.
\end_layout

\begin_layout Standard
Note that for this, you'll need to define 
\begin_inset Formula $in.da=@(a,w,r)0.01*(w(1,:)+i*w(2,:))$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Planar noise
\end_layout

\begin_layout Standard
The next example is growth of thermal noise of a two-component complex field
 in a plane, given by the equation 
\begin_inset Formula 
\[
\frac{d\bm{a}}{dt}=\frac{i}{2}\nabla^{2}\bm{a}+\bm{w}(t,x)
\]

\end_inset

where 
\begin_inset Formula $\bm{\zeta}$
\end_inset

 is a delta-correlated complex noise vector field: 
\begin_inset Formula 
\[
w_{j}(t,\mathbf{x})=\left[w_{j}^{re}(t,\mathbf{x})+i\zeta_{j}^{im}(t,\mathbf{x})\right]/\sqrt{2},
\]

\end_inset

with the initial condition that the initial noise is delta-correlated in
 position space 
\begin_inset Formula 
\[
a(0,\mathbf{x})=\bm{\zeta}^{(in)}(\bm{x})
\]

\end_inset

where: 
\begin_inset Formula 
\[
\bm{\zeta}^{(in)}(\bm{x})=\left[\bm{\zeta}^{re(in)}(\mathbf{x})+i\bm{\zeta}^{im(in)}(\mathbf{x})\right]/\sqrt{2}
\]

\end_inset


\end_layout

\begin_layout Standard
This has an exact solution for the noise intensity in either ordinary space
 or momentum space: 
\begin_inset Formula 
\begin{eqnarray*}
\left\langle \left|a_{j}\left(t,\mathbf{x}\right)\right|^{2}\right\rangle  & = & (1+t)/\Delta V\\
\left\langle \left|\tilde{a}_{j}\left(t,\mathbf{k}\right)\right|^{2}\right\rangle  & = & (1+t)/\Delta V_{k}\\
\left\langle \tilde{a}_{1}\left(t,\mathbf{k}\right)\tilde{a}_{2}^{*}\left(t,\mathbf{k}\right)\right\rangle  & = & 0
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Here, the noise is delta-correlated, and 
\begin_inset Formula $\Delta V$
\end_inset

, 
\begin_inset Formula $\Delta V_{k}$
\end_inset

 are the cartesian space and momentum space lattice cell volumes respectively.
 Suppose that 
\begin_inset Formula $N=N_{x}N_{y}$
\end_inset

 is the total number of spatial points, and 
\begin_inset Formula $V=R_{x}R_{y}$
\end_inset

, where there are 
\begin_inset Formula $N_{x(y)}$
\end_inset

 points in the x(y)-direction, with a total range of 
\begin_inset Formula $R_{x(y)}$
\end_inset

.
 Then, 
\begin_inset Formula $\Delta x=R_{x}/N_{x}$
\end_inset

 ,
\begin_inset Formula $\Delta k_{x}=2\pi/R_{x}$
\end_inset

 , so that: 
\begin_inset Formula 
\begin{eqnarray*}
\Delta V & = & \Delta x\Delta y=\frac{V}{N}\\
\Delta V_{k} & = & \Delta k_{x}\Delta k_{y}=\frac{(2\pi)^{2}}{V}.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
In the simulations, two planar noise fields are propagated, one using delta-corr
elated noise, the other with noise transformed to momentum space to allow
 filtering.
 This allows use of finite correlation lengths when needed, by including
 a frequency filter function that is used to multiply the noise in Fourier-space.
 The Fourier-space noise variance is the square of the filter function.
 
\end_layout

\begin_layout Standard
The first noise index, 
\begin_inset Formula $in.noises(1)$
\end_inset

, indicates how many noise fields are generated, while 
\begin_inset Formula $in.noises(2)$
\end_inset

 indicates how many of these are spatially correlated, via Fourier transform,
 filter and inverse Fourier transform.
 These appear to the user as additional noises, so the total is 
\begin_inset Formula $in.noises(1)+in.noises(2)$
\end_inset

.
 The filtered noises have a finite correlation length.
 They are correlated with the first 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $in.noises(1)$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 x-space noises they are generated from, as this can be useful.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the planar noise growth equation
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [e] = Planar() 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.name = 'Planar noise growth'; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.dimension = 3; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.fields = 2; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.ranges = [1,5,5]; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.steps = 2; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.noises = [4,2]; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.ensembles = [10,4,4]; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.initial = @Initial; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da = @Da; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.linear = @Linear; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.observe = @(a,r) a(1,:).*conj(a(1,:));
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels= '<|a_1(x)|^2>';
\end_layout

\begin_layout Plain Layout

\family typewriter
in.compare = @(t,in) [1+t]/in.dV;
\end_layout

\begin_layout Plain Layout

\family typewriter
in.images = 4; 
\end_layout

\begin_layout Plain Layout

\family typewriter
e = xspde(in); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\family default

\begin_inset Newline newline
\end_inset

 
\family typewriter
 
\end_layout

\begin_layout Plain Layout

\family typewriter
function a0 = Initial(v,r) 
\end_layout

\begin_layout Plain Layout

\family typewriter
a0(1,:) = (v(5,:)+1i*v(6,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
a0(2,:) = (v(3,:)+1i*v(4,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\family default

\begin_inset Newline newline
\end_inset


\family typewriter
 
\end_layout

\begin_layout Plain Layout

\family typewriter
function da = Da(a,z,r) 
\end_layout

\begin_layout Plain Layout

\family typewriter
da(1,:) = (z(5,:)+1i*z(6,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
da(2,:) = (z(3,:)+1i*z(4,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\family default

\begin_inset Newline newline
\end_inset

 
\family typewriter
 
\end_layout

\begin_layout Plain Layout

\family typewriter
function L = Linear(r) 
\end_layout

\begin_layout Plain Layout

\family typewriter
lap = r.Dx.^2+r.Dy.^2; 
\end_layout

\begin_layout Plain Layout

\family typewriter
L(1,:) = 1i*0.5*lap(:); 
\end_layout

\begin_layout Plain Layout

\family typewriter
L(2,:) = 1i*0.5*lap(:); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
Add a decay rate of 
\begin_inset Formula $-a$
\end_inset

 to the differential equation, then replot
\end_layout

\begin_layout Itemize

\series bold
Add growth and nonlinear saturation terms
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Characteristic equation
\end_layout

\begin_layout Standard
The next example is the characteristic equation for a traveling wave at
 constant velocity.
 It is included to illustrate what happens at periodic boundaries, when
 Fourier-transform methods are used for propagation.
 There are a number of methods known to prevent this effect, including addition
 of absorbers - often called apodization - at the boundaries.
 The equation is: 
\begin_inset Formula 
\[
\frac{da}{dt}+\frac{da}{dx}=0
\]

\end_inset


\end_layout

\begin_layout Standard
Together with the initial condition that 
\begin_inset Formula $a(0,x)=sech(2x+5)$
\end_inset

, this has an exact solution that propagates at a constant velocity: 
\begin_inset Formula 
\begin{eqnarray*}
a(t,x) & = & sech(2(x-t)+5)
\end{eqnarray*}

\end_inset

The time evolution at 
\begin_inset Formula $x=0$
\end_inset

 is simply: 
\begin_inset Formula 
\begin{eqnarray*}
a(t,0) & = & sech(2(t-5/2))
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the characteristic equation given above, noting the effects of periodic
 boundaries.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [e] = Characteristic() 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.name = 'Characteristic'
\end_layout

\begin_layout Plain Layout

\family typewriter
in.dimension = 2; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.initial = @(v,r) sech(2.*(r.x+2.5)); 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.da = @(a,z,r) 0*a; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.linear = @(r) -r.Dx; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.olabels = 'a_1(x)'; 
\end_layout

\begin_layout Plain Layout

\family typewriter
in.compare = @(t,in) sech(2.*(t-2.5)); 
\end_layout

\begin_layout Plain Layout

\family typewriter
e = xspde(in); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
Recalculate with the opposite velocity, and a new exact solution.
\end_layout

\begin_layout Section
Challenge problem #2
\end_layout

\begin_layout Standard
Counter-intuitively, a random potential 
\emph on
prevents
\emph default
 normal wave-packet spreading in quantum-mechanics.
 This is Anderson localization: a famous property of quantum mechanics in
 a random potential.
 A typical experimental method is to confine an ultra-cold Bose-Einstein
 condensate (BEC) in a trap, then release the BEC in a random external potential
 produced by a laser.
 The expansion rate of the BEC is reduced by the Anderson localization due
 to the random potential.
 Physically, the observable quantity is the particle density 
\begin_inset Formula $n=\left|\psi\right|^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
This can be treated either using a Schroedinger equation with a random potential
, at low density, or using the Gross-Pitaevskii (GP) equation to include
 atom-atom interactions at the mean field level.
 In this example of a problem where strong localization occurs, the general
 equations are: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial\psi}{\partial t}=\frac{1}{i\hbar}\left[-\frac{\hbar^{2}}{2m}\nabla^{2}+V\left(\bm{r}\right)+g\left|\psi\right|^{2}\right]\psi
\]

\end_inset


\end_layout

\begin_layout Standard
In calculations, it is best to use a dimensionless form by rescaling coordinates
 and fields.
 A simple way to simulate this with xSPDE is to treat 
\begin_inset Formula $\psi$
\end_inset

 as a scaled field 
\begin_inset Formula $a(1),$
\end_inset

 and to assume the random potential field 
\begin_inset Formula $V\left(\bm{r}\right)$
\end_inset

 as caused by interactions with second random field 
\begin_inset Formula $\left|a(2)\right|^{2}$
\end_inset

.
 This has the advantage that it is similar to the actual experiment, and
 allows one to treat time-dependent potentials as well, if desired.
 
\end_layout

\begin_layout Standard
With the rescaling, this simplifies to:
\begin_inset Formula 
\[
\frac{\partial a_{1}}{\partial\tau}=i\left[\frac{\partial}{\partial\zeta^{2}}^{2}-\left|a_{2}\right|^{2}-\left|a_{1}\right|^{2}\right]a_{1}
\]

\end_inset


\end_layout

\begin_layout Standard
A convenient initial condition is to use: 
\begin_inset Formula 
\begin{eqnarray*}
a_{1} & = & a_{0}\exp(-\zeta^{2})\\
\left\langle a_{2}(\zeta)a_{2}(\zeta')\right\rangle  & = & v\delta\left(\zeta-\zeta'\right)
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection*
Exercise
\end_layout

\begin_layout Itemize

\series bold
Solve Schroedinger's equation without a random potential, to observe expansion.
\end_layout

\begin_layout Itemize

\series bold
Include a random potential 
\begin_inset Formula $v$
\end_inset

, to observe localization.
\end_layout

\begin_layout Itemize

\series bold
Experiment with nonlinear terms and higher dimensions.
\end_layout

\begin_layout Standard
Note that the GP equation is a mean field approximation; this is still not
 a full solution of the many-body problem! Also, the experiments are somewhat
 more complicated than this, and actually observe the momentum distribution.
\end_layout

\begin_layout Chapter
Logic and data
\begin_inset CommandInset label
LatexCommand label
name "chap:Logic-and-data"

\end_inset


\end_layout

\begin_layout Standard
The simulation program logic is straightforward.
 It is a very compact function called 
\begin_inset Formula $\mathbf{xspde}$
\end_inset

.
 This calls 
\series bold

\begin_inset Formula $\mathbf{xsim}$
\end_inset


\series default
, for the simulation, then 
\begin_inset Formula $\mathbf{xgraph}$
\end_inset

 for the graphics.
 Most of the work is done by other specialized functions.
 Input parameters come from an 
\begin_inset Formula ${\bf input}$
\end_inset

 array, output is saved either in a 
\begin_inset Formula ${\bf data}$
\end_inset

 array, or else in a specified file.
 During the simulation, global averages and error-bars are calculated for
 both time-step and sampling errors.
 When completed, timing and error results are printed.
 
\end_layout

\begin_layout Section
Simulation function, 
\emph on
xsim
\end_layout

\begin_layout Subsection
Input and data structures
\end_layout

\begin_layout Standard
To explain xSPDE in full detail, 
\end_layout

\begin_layout Itemize
Simulation inputs are stored in the 
\series bold
input
\series default
 cell array.
 
\end_layout

\begin_layout Itemize
This describes a 
\emph on
sequence
\emph default
 of simulations, so that 
\series bold
input={in1,in2,...}
\series default
.
 
\end_layout

\begin_layout Itemize
Each structure 
\series bold
in
\series default
 describes a simulation, whose output is the input of the next.
 
\end_layout

\begin_layout Itemize
The main simulation function is called using 
\begin_inset Formula $\mathbf{xsim(input)}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Averages are recorded sequentially in the 
\series bold
data
\series default
 cell array.
 
\end_layout

\begin_layout Itemize
Raw trajectory data is stored in the 
\series bold
raw
\series default
 cell array if required.
 
\end_layout

\begin_layout Standard
The sequence 
\begin_inset Formula $\mathbf{input}$
\end_inset

 has a number of individual simulation objects 
\begin_inset Formula $\mathbf{in}$
\end_inset

.
 Each includes parameters that specify the simulation, with functions that
 give the equations and observables.
 If there is only one simulation, just one individual specification 
\begin_inset Formula $\mathbf{in}$
\end_inset

 is needed.
 In addition, xSPDE generates graphs with its own graphics program.
\end_layout

\begin_layout Subsection
User definable simulation functions
\end_layout

\begin_layout Standard
The most commonly used functions are indicated with an asterisk.
 Others have automatic defaults that are not usually changed, except in
 special cases.
\end_layout

\begin_layout Description
*initial is used to initialize each integration in time.
 This is a user-defined function, which can involve random numbers if there
 is an initial probability distribution.
 This creates a stochastic field on the lattice, called 
\series bold
\emph on
a.

\series default
\emph default
 The default is 
\begin_inset Formula $\mathbf{xinitial}$
\end_inset

, which sets fields to zero.
 The returned first dimension should be fields(1).
 
\end_layout

\begin_layout Description
*observe is the initial observation function, whose output is averaged over
 the ensembles, called from 
\series bold
xpath
\series default
.
 The default, 
\begin_inset Formula $\mathbf{xobserve}$
\end_inset

, returns the real part of the amplitudes.
 
\end_layout

\begin_layout Description
*function is an optional function used to take arbitrary transforms of the
 initial observe outputs, after averaging over the 
\emph on
first
\emph default
 ensemble.
 The default returns the averages unchanged.
 
\end_layout

\begin_layout Description
*linear is the linear response, including transverse derivatives in space.
 The default, 
\begin_inset Formula $\mathbf{xlinear}$
\end_inset

, sets this to zero.
 
\end_layout

\begin_layout Description
*da is called by 
\series bold
step
\series default
 to calculate derivatives of the stochastic fields at every step in the
 process, including the stochastic terms.
 The default, 
\begin_inset Formula $\mathbf{xstep}$
\end_inset

, sets this to zero.
 The returned first dimension should be fields(1).
 All stochastic fields are accessible as 
\begin_inset Formula $a(n,:)$
\end_inset

, where 
\begin_inset Formula $n\leq fields(1)$
\end_inset

.
\end_layout

\begin_layout Description
*define is called by 
\series bold
step
\series default
 to calculate any user-defined auxiliary fields.
 The default, 
\begin_inset Formula $\mathbf{xdefine}$
\end_inset

, sets these to zero.
 The returned first dimension should be fields(2).
 If auxiliary fields are used they are accessible as 
\begin_inset Formula $a(n,:)$
\end_inset

, where 
\begin_inset Formula $n>fields(1)$
\end_inset

.
\end_layout

\begin_layout Description

\series bold
transfer
\series default
 is a function used to initialize sequential simulations,
\series bold
 
\series default
where previous or output stochastic field values are automatically included
 as input to the next stage ine the intergation sequence.
 The default, 
\begin_inset Formula $\mathbf{xtransfer}$
\end_inset

, uses the output of the previous simulation for the input to the next stage.
 This can be changed by the user.
\end_layout

\begin_layout Description
step is the algorithm that computes each step in time.
 This also generates the random numbers at each time-step.
 Options include 
\series bold
xEuler
\series default
, 
\series bold
xRK2
\series default
, 
\series bold
xRK4, 
\series default
for Euler and Runge-Kutta integration methods.
 This can be user-modified by initializing the handle in.step to add a new
 integration function.
 The default is 
\begin_inset Formula $\mathbf{xRK4}$
\end_inset

, which is widely applicable.
 Another good option is
\begin_inset Formula $\mathbf{xMP}$
\end_inset

, which uses a midpoint or central-difference technique in the interaction
 picture.
\end_layout

\begin_layout Description
rfilter returns a momentum filter for random initial fields generated in
 momentum space.
 The default, 
\begin_inset Formula $\mathbf{xrfilter}$
\end_inset

, sets this to unity.
\end_layout

\begin_layout Description
nfilter returns a momentum filter for random noises generated in momentum
 space.
 The default, 
\begin_inset Formula $\mathbf{xnfilter}$
\end_inset

, sets this to unity.
\end_layout

\begin_layout Description

\series bold
grid
\series default
 calculates the spatial integration grid.
 The default, 
\begin_inset Formula $\mathbf{xgrid}$
\end_inset

, returns a rectangular grid in ordinary and momentum space.
\end_layout

\begin_layout Description

\series bold
prop
\series default
 is the spatial propagation function.
 The default, 
\begin_inset Formula $\mathbf{xprop}$
\end_inset

, takes a Fourier transform of 
\begin_inset Formula $\bm{a}$
\end_inset

, multiplies by propfactor to propagate in time, then takes an inverse Fourier
 transform.
 
\end_layout

\begin_layout Description

\series bold
randomgen
\series default
 generates the initial random fields.
 The default, 
\begin_inset Formula $\mathbf{xrandomgen}$
\end_inset

, returns Gaussian real fields that are delta-correlated in space or momentum
 space.
\end_layout

\begin_layout Description

\series bold
noisegen
\series default
 generates the initial random fields.
 The default, 
\begin_inset Formula $\mathbf{xnoisegen}$
\end_inset

, returns Gaussian real noises that are delta-correlated in time and also
 in space or momentum space.
\end_layout

\begin_layout Description
propfactor returns the interaction picture propagation factors.
 The default, 
\begin_inset Formula $\mathbf{xpropfactor}$
\end_inset

, uses data from the 
\begin_inset Formula $\mathbf{linear}$
\end_inset

 function to calculate this.
\end_layout

\begin_layout Section
Arrays and errors
\end_layout

\begin_layout Standard
Knowing the details of array indexing inside xSPDE isn't usually necessary.
 Yet it becomes important if you want to write your own functions to extend
 xSPDE, interface xSPDE with other functions, or read and write xSPDE data
 files with external programs.
 It also helps to understand how the program works.
\end_layout

\begin_layout Subsection
Array indexing
\end_layout

\begin_layout Standard
In xSPDE, the space-time dimension 
\begin_inset Formula $d$
\end_inset

 is unlimited.
 All data, including grid coordinates, fields and average results is stored
 in real or complex numerical arrays of implicit or explicit rank 
\begin_inset Formula $2+d$
\end_inset

.
 The index ordering is always 
\begin_inset Formula $(i,e,\mathbf{j})$
\end_inset

, where: 
\end_layout

\begin_layout Itemize
The first index is a field index (
\begin_inset Formula $i$
\end_inset

).
 In some cases - like coordinates - the first index is always 
\begin_inset Formula $i=1$
\end_inset

.
 
\end_layout

\begin_layout Itemize
The second index is an ensembles/checks index (
\begin_inset Formula $e/c$
\end_inset

).
 For fields, this is used to store field trajectories.
 For output data, it is used to store means and error estimates.
\end_layout

\begin_layout Itemize
The remaining 
\begin_inset Formula $d$
\end_inset

 indices 
\begin_inset Formula $j_{1},\ldots j_{d}\equiv\bm{j}$
\end_inset

 are for time and space, where 
\begin_inset Formula $\bm{j}$
\end_inset

 indicates a 
\begin_inset Formula $d$
\end_inset

-dimensional index
\end_layout

\begin_layout Itemize
To conserve memory, transient arrays during calculations use 
\begin_inset Formula $\bm{j}=[1,j_{2},\ldots]$
\end_inset

 , which indicates a 
\begin_inset Formula $d$
\end_inset

 dimensional index with time index set to one.
 
\end_layout

\begin_layout Standard
When the fields, noises or coordinates are integrated by the xSIM integration
 functions, the field and data arrays are always flattened to a matrix.
 This is for reasons of convenience in defining mathematical operations.
 The first index is the field or line index, and the combined second index
 covers all the rest.
 This is only done internally, but not in externally stored data, nor in
 xGRAPH, which operates on the full data arrays.
\end_layout

\begin_layout Standard
Stored data uses heterogenous cell arrays to package numerical arrays with
 additional high level indices.
 The first is always the sequence index, 
\begin_inset Formula $s$
\end_inset

.
 Raw data also requires indices for checks and hih level ensembles.
 Inside a sequence, data cell arrays have an additional graph index 
\begin_inset Formula $n$
\end_inset

.
 This distinguishes the different averages generated for output graphs and
 data.
 
\end_layout

\begin_layout Standard
The following detailed information is not required to use xSPDE, but it
 helps to give insight to how data is stored, and how to customize and extend
 the code.
 There are several different types of arrays used.
 These are as follows:
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Indices 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
a
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(i,e,\bm{j})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stochastic fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
w
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(i,e,\bm{j})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random and noise fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
x
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(1,e,\bm{j})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space coordinates
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\{s,c,f\}(i,e,\mathbf{j})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Raw data
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
o
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 
\begin_inset Formula $\{n\}(o,c,\mathbf{j})$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed average data
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
g
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\{s\}\{n\}(o,c,\mathbf{j})$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graph data
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
In summary, the xSPDE arrays are as follows:
\end_layout

\begin_layout Itemize

\series bold
Field
\series default
 arrays 
\begin_inset Formula $a(i,e,\bm{j})$
\end_inset

 - these have a field index, an ensemble index 
\begin_inset Formula $e=1,\ldots ensembles(1)$
\end_inset

, one time-point, and a full spatial lattice.
\end_layout

\begin_layout Itemize

\series bold
Random
\series default
 and 
\series bold
noise
\series default
 arrays 
\begin_inset Formula $w(i,e,\bm{j})$
\end_inset

 - these are like field arrays.
 They are initial random fields or noise fields for the stochastic equations.
 The first index can have a different range to the field index.
\end_layout

\begin_layout Itemize

\series bold
Coordinate
\series default
 arrays 
\begin_inset Formula $x(1,e,\bm{j})$
\end_inset

 - these arrays are the values of coordinates at grid-points, with labels
 
\begin_inset Formula $x,y,z$
\end_inset

.
 Numeric labels 
\begin_inset Formula $x\{l\}$
\end_inset

 are used with dimensions 
\begin_inset Formula $d>4$
\end_inset

, depending on the axis number, 
\begin_inset Formula $l=2,\ldots d$
\end_inset

.
 The same sizes are used for: 
\end_layout

\begin_deeper
\begin_layout Itemize
momentum coordinates 
\begin_inset Formula $kx,ky,kz$
\end_inset

 (alternatively labelled 
\begin_inset Formula $k\{2\},k\{3\},\ldots$
\end_inset

) - 
\end_layout

\begin_layout Itemize
spectral derivative arrays 
\begin_inset Formula $Dx,Dy,Dz$
\end_inset

 (alternatively labelled 
\begin_inset Formula $D\{2\},D\{3\},\ldots$
\end_inset

) .
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Raw
\series default
 arrays 
\begin_inset Formula $r\{s,c,f\}(i,e,\mathbf{j})$
\end_inset

 - like fields, except with all time points stored.
 These are used optionally, as they take up large amounts of memory.
 These are saved in cell arrays with indices 
\begin_inset Formula $s$
\end_inset

 for the sequence, 
\begin_inset Formula $c$
\end_inset

 for the time-step check, 
\begin_inset Formula $f$
\end_inset

 for high-level ensemble index.
 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $s=1,\ldots S$
\end_inset

 for the sequence number, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $c=1,2$
\end_inset

 for the error-checking time-step used, first coarse then fine, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $f=1,\ldots ensemble(2)*ensemble(3)$
\end_inset

 for a high level combined parallel and serial ensemble index.
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Data
\series default
 arrays 
\begin_inset Formula $d\{n\}(o,c,\mathbf{j})$
\end_inset

 - these store the generated average data at all time points, with an error-chec
k index 
\begin_inset Formula $c=1,2,3$
\end_inset

.
 Check indices are 
\begin_inset Formula $c=1$
\end_inset

 for the estimated average, 
\begin_inset Formula $c=2$
\end_inset

 for the estimated time-step error, and 
\begin_inset Formula $c=3$
\end_inset

 for the estimated statistical error or standard deviation.
 Note that the cell index 
\begin_inset Formula $n$
\end_inset

 is the graph index, and the first array index 
\begin_inset Formula $o$
\end_inset

 is a user-generated graphics line index.
 This may or may not correspond to a field index: it is a user option.
\end_layout

\begin_layout Itemize

\series bold
Graphics
\series default
 data arrays 
\begin_inset Formula $g\{s\}\{n\}(o,c,\mathbf{j})$
\end_inset

 - these store the complete sequence of 
\emph on
data
\emph default
 that is plotted, and may have further functional transformations when processed
 in 
\series bold
xgraph
\series default
, if required.
 Graphics cell data requires high-level cell indices 
\begin_inset Formula $\{s\}$
\end_inset

 for the sequence index, and 
\begin_inset Formula $\{n\}$
\end_inset

 for the graph or function index, which corresponds to the index 
\begin_inset Formula $\{n\}$
\end_inset

 of the observe function used to generate averages.
 One can have several data arrays to make a number of distinct output graphs
 labelled 
\begin_inset Formula $n$
\end_inset

.
 Each graph may have multiple averages, giving different liines for comparisons.
 These are then combined into a sequence, each with different graphs, and
 therefore need more indices.
 
\end_layout

\begin_layout Standard
Although the indices always occur in the same order, the fields, noises
 and output data can have different first dimensions.
 They are specified using different input parameters.
 The output line index 
\begin_inset Formula $o$
\end_inset

 in a graphics or data array describes different lines on a graph.
 Similarly, the local ensemble index 
\begin_inset Formula $e$
\end_inset

 in a field array has a different range to 
\begin_inset Formula $c$
\end_inset

, the check index, in a data array.
\end_layout

\begin_layout Subsection
Step-size errors
\end_layout

\begin_layout Standard
Errors caused by the finite time-domain step-size, as well as those caused
 by the finite ensemble, are checked automatically.
 Those caused by the spatial lattice are not checked in the xSIM code.
 They must be checked by manually, by comparing results with different transvers
e lattice ranges and step-size.
\end_layout

\begin_layout Standard
Errors due to a finite step-size are estimated by comparing two simulations
 with different step-sizes and the same random sequence, to make sure the
 final results are accurate.
 The final 2D output graphs will have error-bars if 
\begin_inset Formula $checks=1$
\end_inset

 was specified, which is also the default parameter setting.
 Error-bars below a minimum relative size compared to the vertical range
 of the plot, specified by the graphics variable 
\begin_inset Formula $minbar$
\end_inset

, are not plotted.
 
\end_layout

\begin_layout Standard
There is a clear strategy if the errors are too large.
 Either increase the 
\emph on
points
\emph default
, which gives more plotted points and lower errors, or increase the 
\emph on
steps, 
\emph default
which reduces the step size without changing the graphical resolution.
 The default algorithm and extrapolation order can also be changed, please
 read the full xSPDE manual when doing this.
 Error bars on the graphs can be removed by setting 
\begin_inset Formula $checks=0$
\end_inset

 or increasing 
\begin_inset Formula $minbar$
\end_inset

 in final graphs.
\end_layout

\begin_layout Subsection
Sampling errors
\end_layout

\begin_layout Standard
Sampling error estimation in xSIM uses sub-ensemble averaging.
 This generally leads to more reliable sampling error estimates, and makes
 efficient use of the vector instruction sets that are used by Matlab.
 Ensembles are specified in three levels.
 The first, 
\emph on
ensemble(1)
\emph default
, is called the number of samples for brevity.
 All computed quantities returned by the 
\series bold
observe
\series default
 functions are first averaged over the samples, which are calculated efficiently
 using a parallel vector of trajectories.
 By the central limit theorem, these low-level sample averages are distributed
 as a normal distribution at large sample number.
\end_layout

\begin_layout Standard
Next, the sample averages are averaged 
\series bold
again
\series default
 over the two higher level ensembles, if specified.
 This time, the variance is accumulated.
 The variance of these distributions is used to estimate a standard deviation
 in the mean, since each computed quantity is now a normally distributed
 result.
 This method is applied to all the 
\emph on
graphs 
\emph default
observables.
 The two lines generated represent 
\begin_inset Formula $\bar{o}\pm\sigma$
\end_inset

, where 
\begin_inset Formula $o$
\end_inset

 is the observe function output, and 
\begin_inset Formula $\sigma$
\end_inset

 is the standard deviation in the mean.
\end_layout

\begin_layout Standard
The highest level ensemble, 
\emph on
ensemble(3), 
\emph default
is used for parallel simulations.
 This requires the Matlab parallel toolbox.
 Either type of high-level ensemble, or both together, can be used to calculate
 sampling errors.
\end_layout

\begin_layout Standard
Note that one standard deviation is not a strong bound; errors are expected
 to exceed this value in 
\begin_inset Formula $32\%$
\end_inset

 of observed measurements.
 Another point to remember is that stochastic errors are often correlated,
 so that a group of points may all have similar errors due to statistical
 sampling.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $ensembles(2)>1$
\end_inset

 or 
\begin_inset Formula $ensembles(3)>1$
\end_inset

, which allows xSPDE to calculate sampling errors, it will plot upper and
 lower limits of one standard deviation.
 If the sampling errors are too large, try increasing 
\begin_inset Formula $ensembles(1)$
\end_inset


\emph on
, 
\emph default
which increases the trajectories in a single thread.
 An alternative is to increase 
\begin_inset Formula $ensembles(2)$
\end_inset

.
 This is slower, but is only limited by the compute time, or else to increase
 
\begin_inset Formula $ensembles(3)$
\end_inset

, which gives higher level parallelization.
 Each is limited in different ways; the first by memory, and the second
 by time, the third by the number of available cores.
 Sampling error control helps ensures accuracy.
\end_layout

\begin_layout Section
Graphics function, 
\emph on
xgraph
\end_layout

\begin_layout Standard
The main functions involved for graphics are: 
\end_layout

\begin_layout Description
xgraph is called by xSPDE when the ensemble loops finished.
 The results are graphed and output if required.
 
\end_layout

\begin_layout Subsection
xGRAPH inputs
\end_layout

\begin_layout Standard
The input to xGRAPH can either come from a file, or it can be from data
 generated directly with xSIM.
 The data is a cell array, where each member of the cell array is a numerical
 graphics array, defining one independent set of averaged data.
 the observed data averages, stored in a cell array of size 
\begin_inset Formula $d\{n\}(o,c,\mathbf{j})$
\end_inset

.
 
\end_layout

\begin_layout Subsection
User definable graphics functions
\end_layout

\begin_layout Standard
It is possible to simply run 
\begin_inset Formula $\mathbf{xgraph}$
\end_inset

 as is, without much intervention.
 However, there are many customization options, including two user defined
 functions which have useful applications.
 These are as follows:
\end_layout

\begin_layout Description
*gfunction(d,r) is is a cell array of functions whose output is plotted.
 There is one graphics function for each multidimensional dataset that is
 plotted.
 The default value is just the average stored in the data array generated
 by the simulation observe function.
 
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

An arbitrary number of functions of these observables can also be plotted,
 including vector observables.
 The input to graphics functions is the observed data averages or functions
 of averages, stored in a cell array of size 
\begin_inset Formula $d\{n\}(o,c,\mathbf{j})$
\end_inset

.
 
\end_layout

\begin_layout Description
*compare(r) is a cell array of functions used to obtain comparison results.
 These are calculated from the user-specified 
\series bold
in.compare
\series default
 handle, giving a dashed line on the generated time-domain graphs, and an
 error summary which is printed.
 
\end_layout

\begin_layout Standard
The results from the two graphics functions plotted using the 
\series bold
xgraph
\series default
 routines.
 
\end_layout

\begin_layout Subsection
xGRAPH outputs
\end_layout

\begin_layout Standard
This routine is prewritten to cover a range of useful graphs, but can be
 modified to suit the user.
 
\end_layout

\begin_layout Standard
The code will cascade down from higher to lower dimensions, generating different
 types of user-defined graphs.
 Each type of graph is generated once for each specified graphics function.
 The graphics axes that are used for plotting, and the points plotted, are
 defined using the optional 
\series bold
\emph on
axes 
\series default
\emph default
input parameters, where 
\begin_inset Formula $axes\{n\}$
\end_inset

 indicates the n-th specified graphics function or set of generated graphical
 data.
\end_layout

\begin_layout Standard
If there are no 
\series bold
\emph on
axes 
\series default
\emph default
inputs, or the inputs are zero - for example, 
\begin_inset Formula $axes\{1\}=\{0,0,0\}$
\end_inset

 - only the lowest dimensions are plotted, up to 3.
 If the 
\series bold
\emph on
axes 
\series default
\emph default
inputs project out a single point in a given dimension, - for example, 
\begin_inset Formula $axes\{1\}=\{0,31,-1,0\}$
\end_inset

, these axes are suppressed in the plots.
 This reduces the effective dimension of the data - in this case to two
 dimensions.
 
\end_layout

\begin_layout Standard
Examples:
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{1\}=\{0\}$
\end_inset

 - For function 1, plot all the time points; higher dimensions get defaults.
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{2\}=\{-1,0\}$
\end_inset

 - For function 2, plot the maximum time (the default), and all x-points.
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{3\}=\{1:4:51,32,64\}$
\end_inset

 - For function 3, plot every 4-th time point at x point 32, y point 64
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{4\}=\{0,1:4:51,0\}$
\end_inset

 - For function 4, plot every time point, every 4-th x point, and al the
 y-points.
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $-1$
\end_inset

 indicates a default `typical' point, which is the last point on the time
 axis, and the midpoint on the other axes.
 
\end_layout

\begin_layout Standard
The 
\emph on
pdimension
\emph default
 input can also be used to reduce dimensionality, as this sets the maximum
 effective plotted dimension.
 For example, 
\begin_inset Formula $pdimension\{1\}=1$
\end_inset

 means that only plots vs time are output for the first function plotted.
 Note that in the following, 
\begin_inset Formula $t,x,y,z$
\end_inset

 may be replaced by corresponding higher dimensions if there are axes that
 are suppressed.
 Slices can be taken at any desired point, not just the midpoint.
 Using the standard notation of, for example, 
\begin_inset Formula $axes\{1\}=\{6:3:81\}$
\end_inset

, can be used to modify the starting, interval, and finishing points for
 complete control on the plot points.
\end_layout

\begin_layout Standard
The graphics results depend on the resulting 
\series bold
effective
\series default
 dimension.
 Since the plot has to include a data axis, the plot will be typically one
 dimension higher than the underlying space-time lattice: 
\end_layout

\begin_layout Description

\emph on
dimension=4..

\emph default
 For higher lattice dimensions, only a slice through the chosen point, or
 the default midpoint, is available, reducing the lattice dimension to 
\begin_inset Formula $3$
\end_inset

.
 
\end_layout

\begin_layout Description

\emph on
dimension=3
\emph default
 For three lattice dimensions, if 
\begin_inset Formula $images>1$
\end_inset

, a movie of distinct 3D graphic images of observable
\emph on
 vs x,y
\emph default
 are plotted as 
\begin_inset Formula $images$
\end_inset

 slices - usually in time.
 Otherwise, only a slice through the chosen point, or the default midpoint,
 is available for the highest dimension, reducing the lattice dimension
 to 
\begin_inset Formula $2$
\end_inset

.
 
\end_layout

\begin_layout Description

\emph on
dimension=2
\emph default
 For two lattice dimensions, one 3D image of observable
\emph on
 vs x,t
\emph default
 is plotted.
 A movie of distinct 2D graphic plots is also possible.
 Otherwise, only a slice through 
\begin_inset Formula $x=0$
\end_inset

 is available, reducing the lattice dimension to 
\begin_inset Formula $1$
\end_inset

.
 
\end_layout

\begin_layout Description

\emph on
dimension=1
\emph default
 For one lattice dimension, a 2D plot of observable
\emph on
 vs t
\emph default
 is plotted, with data at each lattice point in time.
 Exact results, error bars and sampling error bounds are included if available.
 
\end_layout

\begin_layout Standard
In addition to time-dependent graphs, the 
\series bold
xgraph
\series default
 function can generate 
\emph on
images 
\emph default
(3D)
\emph on
 
\emph default
and 
\emph on
transverse
\emph default
 (2D) plots at specified points in time, up to a maximum given by the number
 of time points specified.
 The number of these can be individually specified for each graphics output.
 The images available are specified in 
\emph on
imagetype
\emph default
: 3D perspective plots, grey-scale colour plots and contour plots.
\end_layout

\begin_layout Standard
Note that error bars, sampling errors and multiple lines are only graphed
 for 2D plots, typically of results vs time.
 The error-bars are not plotted when they are below a user-specified size,
 to improve graphics quality.
 Higher dimensional graphs do not include this data, for visibility reasons,
 but they are still recorded in the data files.
 
\end_layout

\begin_layout Section
Object architecture
\end_layout

\begin_layout Subsection
xSPDE data objects
\end_layout

\begin_layout Standard
The xSPDE data objects include parameters and methods, but with a very open
 type of object-oriented architecture to allow extensibility.
 All xSPDE functions are modular and easily replaceable.
 In many cases this is as easy as just defining a new function handle to
 replace the default value.
 To define your own integration function, include in the xSPDE input the
 line:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
in.step=@Mystep;
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Next, include anywhere on your Matlab path the function definition, for
 example:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function a = Mystep(a,w,r) 
\end_layout

\begin_layout Plain Layout

\family typewriter
% a = Mystep(a,w,r) propagates a step my way.
 
\end_layout

\begin_layout Plain Layout

\family typewriter
..
\end_layout

\begin_layout Plain Layout

\family typewriter
a = ...; 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
xSPDE hints
\end_layout

\begin_layout Itemize
When using xSPDE, it is a good idea to run the batch test script, Batchtest.m.
 
\end_layout

\begin_layout Itemize
Batchtest.m tests your parallel toolbox installation.
 If you have no license for this, omit the third ensemble setting.
\end_layout

\begin_layout Itemize
To create a project file, it is often easiest to start with an existing
 project function with a similar equation: see Examples folder.
\end_layout

\begin_layout Itemize
Graphics parameters can also be included in the structure 
\begin_inset Formula $\mathbf{in}$
\end_inset

, to modify graphs.
\end_layout

\begin_layout Itemize
Comparison functions can be included if you want to compare with analytic
 results.
\end_layout

\begin_layout Itemize
A full list of functionality is listed next.
\end_layout

\begin_layout Chapter
xSPDE metadata
\begin_inset CommandInset label
LatexCommand label
name "chap:Table-of-xSPDE"

\end_inset

 
\end_layout

\begin_layout Standard
The input data, which we label 
\begin_inset Formula $input$
\end_inset

, is a sequence of data structures that we label 
\begin_inset Formula $in$
\end_inset

.
 All of the input data is later passed to the 
\begin_inset Formula $xgraph$
\end_inset

 function.
 The input data can be numbers, vectors, strings, functions and cell arrays,
 which just lists of data enclosed in curly brackets, 
\begin_inset Formula $\{\}$
\end_inset

.
 All xSPDE metadata has preferred values, so only changes from the preferences
 need to be input.
 The resulting combined input including preferred values, is stored internally
 as a sequence of structures in a cell array to describe the simulation
 sequence.
\end_layout

\begin_layout Standard
Simulation metadata, including all preferred default values that were used
 in a particular simulation, is also stored in the xSPDE output files.
 This is done in both the Matlab 
\begin_inset Formula $.mat$
\end_inset

 and the HDF5 
\begin_inset Formula $.h5$
\end_inset

 output files, so the entire simulation can be easily reconstructed or changed.
 Note that in the current version of xSPDE, one must use a Matlab formatted
 
\begin_inset Formula $.mat$
\end_inset

 file to store raw data which includes all stochastic trajectories.
 Either the Matlab or the HDF5 files can be used to store both input and
 averaged output data.
\end_layout

\begin_layout Standard
Some conventions are used to simplify inputs, as follows: 
\end_layout

\begin_layout Itemize

\series bold
All input data has default values
\end_layout

\begin_layout Itemize

\series bold
Vector inputs of numbers are enclosed in square brackets, [...].
 
\end_layout

\begin_layout Itemize

\series bold
Where multiple inputs of strings, functions or vectors are needed they should
 be enclosed in curly brackets, {...}, to create a cell array.
 
\end_layout

\begin_layout Itemize

\series bold
Vector or cell array inputs with only one member don't require brackets.
 
\end_layout

\begin_layout Itemize

\series bold
Incomplete or partial vector or cell array inputs are filled in with the
 last applicable default value.
 
\end_layout

\begin_layout Itemize

\series bold
New function definitions can be handles pointing elsewhere.
\end_layout

\begin_layout Section
Simulation data
\end_layout

\begin_layout Standard
The simulation data of the 
\begin_inset Formula $in$
\end_inset

 structure is passed to the 
\begin_inset Formula $xsim$
\end_inset

 program, to define the simulation details.
 User application constants can be included, but must not be reserved names.
 However, names starting with '
\emph on
in.c
\emph default
' or any capital letter like '
\emph on
in.
\emph default
A...' - except the reserved '
\emph on
D
\emph default
' for derivatives - are always available to users.
 Use of globals is 
\series bold
not
\series default
 recommended.
 It is incompatible with the Matlab parallel toolbox.
 Graphics data can be included, but it is simply stored for the graphics
 program to use.
\end_layout

\begin_layout Subsection
Simulation parameters
\end_layout

\begin_layout Standard
All simulation data has default values as distributed, which are also user-modif
iable through the
\emph on
 xpreferences
\emph default
 function.
 Any defaults can be checked by typing 
\begin_inset Formula $in.print=2$
\end_inset

, then running 
\emph on
xsim(in)
\emph default
 or 
\emph on
xspde(in).

\emph default
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="28" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
version
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'xSIM2.3'
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Current version number
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
name
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
''
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simulation name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dimension
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space-time dimension
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
fields
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[1,0]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of stochastic or auxiliary fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ranges
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Range of coordinates in [t,x,y,z,..]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
origin
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Origin of coordinates in [t,x,y,z,..]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
points
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
51 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output lattice points in [t,x,y,z,..]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
noises
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 0]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of noise fields in [x,k]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
randoms
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 0]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial random fields in [x,k]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ensembles
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ensembles used for averaging
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
steps
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Integration steps per output point
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
iterations
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
4
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum iterations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
order
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Extrapolation order 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
checks
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Check time-step errors?
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
seed
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Seed for random number generator
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
file
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
''
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
File-name: 
\emph on
'f.mat' 
\emph default
= Matlab
\emph on
, 'f.h5' 
\emph default
= HDF5 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
boundaries
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[0,0,0,\dots]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Boundary: '0,1,2'=periodic,Neum.,Dirich.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ipsteps
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
2
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IP transforms per time-step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
numberaxis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Forces use of numerical axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
print
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print: 1 for medium, 2 for high output
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
- 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
User specified static parameters
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
olabels
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{'a_1',..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
averages
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of observables
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transforms
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {[0 0 0 0],..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fourier transforms in [t,x,y,z,..]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
raw
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Raw data switch: 1 for raw output
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
numberaxis
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Numbered axis switch: 1 for numbered
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
octave
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Force octave syntax: 1 for octave
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Common functions
\end_layout

\begin_layout Standard
The most common functions, output field dimensions and calling arguments,
 with user-definable functions marked using an asterisk, are:
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="21" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arguments 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Purpose
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*da
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
(a,z,r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stochastic derivative
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*initial
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
(v,r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function to initialize fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*linear
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Linear derivative function
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*rfilter
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 
\emph default
(r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random input filter in k-space
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*nfilter
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Noise filter function in k-space
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*transfer
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
(v,r,a0,r0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initialization in a sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*step
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,z,dt,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Calculation of a time-step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*grid
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $(r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Grid calculator for lattice
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*prop
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interaction picture propagator 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*propfactor
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(nc,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Propagator array calculation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*observe
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $(a,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable function cell array
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*function
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${@(av,~)av{1}(:,:,:).^{2},..}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Functions stored of averages
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*define
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,z,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defines an auxiliary field
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
randomgen
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial random generator
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
noisegen
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Noise generator
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,dx,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Integrates over a spatial lattice
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xave
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,av,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Averages over a spatial lattice
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xd
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,D,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spectral spatial derivative
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xd1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,(dir),r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1st derivative, finite diff.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xd2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,(dir),r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2nd derivative, finite diff.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Section
Internal data
\end_layout

\begin_layout Standard
Internally, xSPDE data is stored in a cell array, 
\begin_inset Formula $latt$
\end_inset

, of the structures called 
\begin_inset Formula $r$
\end_inset

 passed to functions.
 This includes the data given above from the 
\begin_inset Formula $in$
\end_inset

 structures.
 In addition, it includes the computed parameters given below, which includes
 various internal array dimensions.
 The stochastic variable arrays like 
\begin_inset Formula $a,w,v$
\end_inset

 are internally flattened to become two-dimensional matrices where possible,
 to reduce dimensionality and simplify parallel operations.
 
\end_layout

\begin_layout Standard
For 
\begin_inset Formula $d>4$
\end_inset

 total dimensions, the spatial grid, momentum grid and derivative grid notation
 of 
\emph on

\begin_inset Formula $t,x,y,z$
\end_inset

, 
\begin_inset Formula $\omega,kx,ky,kz$
\end_inset


\emph default
 and 
\emph on

\begin_inset Formula $r.Dx,r.Dy,r.Dz$
\end_inset


\emph default
 is changed to use numerical labels that correspond to the dimension numbers,
 i.e., 
\begin_inset Formula $x\{1\},\dots x\{d\}$
\end_inset

, 
\begin_inset Formula $k\{1\},\dots k\{d\}$
\end_inset

, 
\begin_inset Formula $D\{2\},\dots D\{d\}$
\end_inset

.
 These are simpler to handle with large numbers of space dimensions.
 This numeric labeling preference can be used even if 
\begin_inset Formula $d<5$
\end_inset

, by setting the input switch 
\begin_inset Formula $numberaxis=1$
\end_inset

.
 The graph labels will use this notation also, unless specified otherwise.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="36" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Typical value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
t 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Current value of time, t
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
w 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.6$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Frequency passed to in.observe : 
\begin_inset Formula $\omega$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $x,y,z$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space grid of
\begin_inset Formula $x,y,z$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $kx,ky,kz$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Momentum grid of 
\begin_inset Formula $k_{x},k_{y},k_{z}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $Dx,Dy,Dz$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Derivative grid of 
\begin_inset Formula $D_{x},D_{y},D_{z}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $x\{1\},\ldots x\{d\}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space grid of
\emph on

\begin_inset Formula $x_{1},\ldots x_{d}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $k\{1\},\ldots k\{d\}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Momentum grid of
\emph on
 
\begin_inset Formula $k_{1},\ldots k_{d}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $D\{2\},\ldots D\{d\}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Derivative grid of
\emph on
 
\begin_inset Formula $D_{2},\ldots D_{d}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dx
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.2
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Steps in 
\begin_inset Formula $[t,x,y,z]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dk
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.6160
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Steps in 
\begin_inset Formula $[\omega,k_{x},k_{y},k_{z}]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dt
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.2000
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output time-step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dtr
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.1000
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Reduced, internal time-step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
v
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spatial lattice volume
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
kv
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Momentum lattice volume
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dv
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spatial cell volume
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dkv
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Momentum cell volume
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xc
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector cells 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{[0,...
 10]}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space-time coordinate axes in 
\begin_inset Formula $[t,x,y,z]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
kc
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector cells 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{[0,..15,-15...]}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Computational axes in
\begin_inset Formula $[\omega,k_{x},k_{y},k_{z}]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
s.dx
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial stochastic normalization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
s.dxt
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
3.1623
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Propagating stochastic normalization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
s.dk
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial k stochastic normalization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
s.dkt
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
3.1623
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Propagating k stochastic normalization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
nspace
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
35 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of spatial lattice points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
nlattice
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3500 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total lattice: ensembles(1) x n.space 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ncopies
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ensembles(2) x ensembles(3)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
randoms
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of initial random fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
noises
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of noise fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.int
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for lattice integration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.a
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for 
\begin_inset Formula $a$
\end_inset

 field (flattened)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.r
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 [1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for coordinates (flattened)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.aplus
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for integrated plus defined fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.k
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[0 1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for noise transforms
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.obs
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1 1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for observations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.data
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 3 51 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for average data (flattened)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.raw
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1 51 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for raw data (flattened)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Section
Graphics data
\end_layout

\begin_layout Standard
The simulation data of the 
\begin_inset Formula $in$
\end_inset

 structure is also passed to the 
\begin_inset Formula $xgraph$
\end_inset

 program, along with optional graphics parameters for each observable, to
 create an extended graphics data structure.
 
\end_layout

\begin_layout Standard
These are all cell arrays when there is more than one type of graph or observabl
e, so that the graphics parameters can be individually set for each output
 that is plotted, using the cell index 
\begin_inset Formula $\{n\}$
\end_inset

 in a curly bracket.
 The axis labels, axis points and axis transformations of each graph are
 also cell arrays, as there can be any number of axes: so these are all
 nested cell arrays.
 If only a single input is specified, the cell index is automatically supplied.
 Graphics defaults are also user-modifiable by editing the
\emph on
 xgpreferences
\emph default
 function.
 
\end_layout

\begin_layout Standard
The plotted result can be an arbitrary function of the generated average
 data, by using the optional input
\emph on
 gfunctions.
 
\emph default
If this is omitted, the
\emph on
 
\emph default
generated average data from 
\begin_inset Formula $xsim$
\end_inset

 is plotted.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="18" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
gversion
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'xGRAPH2.3'
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Current version number 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.olabels{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'a'
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cell array of function labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xlabels
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {'t' 'x' 'y' 'z'...}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Generic axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
klabels
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {'
\backslash
omega' 'k_x' 'k_y' 'k_z'...}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Transformed axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
minbar{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.01
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimum relative error-bar 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*gfunction{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
@(d,~)
\begin_inset space ~
\end_inset

d{n} 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Functions plotted of averages
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
font{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Font size for graph labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
headers{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
'' 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graph headers
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
images{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of movie images 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
imagetype{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type of movie images 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transverse{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of transverse plots 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
pdimension{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum plot dimensions 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*compare{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Comparison functions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*xfunctions{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Axis transformations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
axes{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
{0,..} 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Points plotted for each axis
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
glabels{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {'t' 'x' 'y' 'z'}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graph-specific axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
graphs
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of graphs
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Kiesewetter"

\end_inset

S.
 Kiesewetter, R.
 Polkinghorne, B.
 Opanchuk, and P.
 D.
 Drummond, 
\emph on
xSPDE: extensible software for stochastic equations
\emph default
, SoftwareX, March (2016).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Gardiner"

\end_inset

C.
 W.
 Gardiner, 
\emph on
Handbook of Stochastic Methods: for Physics, Chemistry and the Natural Sciences
\emph default
 (Springer 2004).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Drummond"

\end_inset

 P.
 D.
 Drummond and M.
 Hillery, 
\emph on
The Quantum Theory of Nonlinear Optics
\emph default
 (Cambridge University Press, Cambridge, 2014).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "DrummondMortimer"

\end_inset

P.
 D.
 Drummond and I.
 K.
 Mortimer, 
\emph on
Computer simulations of multiplicative stochastic differential equations.

\emph default
 J.
 Comp.
 Phys.
 
\series bold
93
\series default
, 144-170 (1991).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "KP"

\end_inset

P.E.
 Kloeden and E.
 Platen, 
\emph on
Numerical Solution of Stochastic Differential Equations
\emph default
 (Springer, 1995).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "WernerDrummond"

\end_inset

M.
 J.
 Werner and P.
 D.
 Drummond, 
\emph on
Robust algorithms for solving stochastic partial differential equations.

\emph default
 J.
 Comp.
 Phys.
 
\series bold
132
\series default
, 312-326 (1997).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Caradoc-Davies"

\end_inset

B.
 M.
 Caradoc-Davies, 
\emph on
Vortex dynamics in Bose-Einstein condensates
\emph default
 (Doctoral dissertation, PhD thesis, University of Otago (NZ), 2000).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "xmds"

\end_inset

 G.
 R.
 Collecutt, P.
 D.
 Drummond, 
\emph on
Xmds: eXtensible multi-dimensional simulator.

\emph default
 Comput.
 Phys.
 Commun.
 
\series bold
142
\series default
, 219-223 (2001).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "xmds2"

\end_inset

Graham R.
 Dennis, Joseph J.
 Hope, Mattias T.
 Johnsson, 
\emph on
XMDS2: Fast, scalable simulation of coupled stochastic partial differential
 equations,
\emph default
 Computer Physics Communications 
\series bold
184
\series default
, 201208 (2013).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "xmds-source"

\end_inset

http://sourceforge.net/projects/xmds/
\end_layout

\end_body
\end_document
